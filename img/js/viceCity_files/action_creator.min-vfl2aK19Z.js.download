define(["require","exports","tslib","lodash","redux-actions","rondo/invariant/index","rondo/metadata/index","rondo/actions/types","rondo/behavior/handle","rondo/behavior/action_watcher","rondo/behavior/saga_handler","redux-saga/effects"],(function(e,t,n,r,i,a,o,c,s,u,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importStar(r),t.pathAction=function(e,t){return e.concat(t).join("/")};var h=(function(){function e(r){var o=this;this.deferredCallbacks=[],this.subscribedActions=[],this.isReady=function(){return o.baseAction?o.baseAction.isReady():!!o.actionProps.actionType},this.runOrDefer=function(e){return o.isReady()?e():o.deferredCallbacks.push(e)},this.runAllDeferred=function(){for(;o.deferredCallbacks.length;)o.deferredCallbacks.shift()()},this.getActionType=function(){return a.invariant(!!o.actionProps.actionType,"Action type must be defined before accessing it, make sure you are in @behavior instance and not accessing it before initialization"),o.actionProps.actionType},this.getBehavior=function(e){return a.invariant(!!o.behavior,"Trying to get behavior before binding, make sure you are in @behavior instance"),e||o.defaultAffectedBehavior||o.behavior},this.action=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o,r=n.actionProps,a=r.payloadCreator,c=r.metaCreator,s=n.type,u=function(e,t){return i.createAction(s(),a,e)(t)},d=function(e){return i.createAction(s(),a)(e)},f=e.length>0?e[0]:void 0;return c?u(c,f):d(f)},this.type=function(){return t.pathAction(o.behavior.path,o.getActionType())},this.finalize=function(e,t){o.behavior=e,o.actionProps=n.__assign(n.__assign({},o.actionProps),t),o.runAllDeferred(),o.baseAction=void 0,o.subscribedActions.splice(0).forEach((function(e){return e.finalize(o.behavior,o.actionProps)}))},this.getInitFn=function(e){return function(t,n){o.baseAction||o.finalize(t,{actionType:e||n})}},this.rawHandle=function(e,t,n,r){return o.runOrDefer((function(){var e=o.getBehavior(r);s.addHandleAction(o.getActionType(),t.bind(e),"throw"===n,o.behavior,e)})),e},this.rawWatch=function(e,t,n){return o.runOrDefer((function(){var e=o.getBehavior(n);u.addActionWatcher(o.getActionType(),t,o.behavior,e)})),e},this.createAction=function(e){var t=function(e){return a.invariant(o.getBehavior().dispatch,"called before store.dispatch is accessible"),o.getBehavior().dispatch(o.action(e)),t};return t.dispatch=t,t},this.useIn=function(n){a.invariant(!!n,"Behavior to be used in must be defined");var r=new e(o);return r.defaultAffectedBehavior=n,o.isReady()?(r.behavior=o.behavior,r.actionProps=o.actionProps):o.subscribedActions.push(r),t.RondoActionFactory.create(r)},this.takeFn=function(e,t,n){o.runOrDefer((function(){var r=o.getBehavior(n);d.addSagaHandler(e,t,[{actionType:o.getActionType(),behavior:o.behavior}],r)}))},this.takeLatest=function(e,t,n){return o.takeFn(t,f.takeLatest,n),e},this.takeLeading=function(e,t,n){return o.takeFn(t,f.takeLeading,n),e},this.takeEvery=function(e,t,n){return o.takeFn(t,f.takeEvery,n),e},r instanceof e?this.baseAction=r:this.actionProps=r}return e.prototype.reduce=function(e,t,r,i){return this.rawHandle(e,(function(e,r){return n.__assign(n.__assign({},e),t(e,r.payload,!!r.error,r.meta))}),r,i)},e})();t.RondoActionCreator=h,t.RondoActionFactory={create:function(e){var t,n;if(e instanceof h)t=e;else{var i=e.metaCreator,a=e.payloadCreator,s=void 0===a?r.identity:a;n=e.actionType,t=new h({payloadCreator:s,metaCreator:i})}var u=t.createAction(n);return u.type=t.type,u.action=t.action,u.init=r.once(t.getInitFn(n)),u[o.ENTRY_FIELD_TYPE]=c.ACTION_FIELD_TYPE,u.watch=function(e,n){return t.rawWatch(u,(function(t,n,r){return e(r(),t.payload)}),n)},u.rawWatch=function(e,n){return t.rawWatch(u,e,n)},u.rawHandle=function(e,n){return t.rawHandle(u,e,"next",n)},u.handle=function(e,n){return t.reduce(u,e,"next",n)},u.rawHandleError=function(e,n){return t.rawHandle(u,e,"throw",n)},u.handleError=function(e,n){return t.reduce(u,e,"throw",n)},u.takeLatest=function(e,n){return t.takeLatest(u,e,n)},u.takeLeading=function(e,n){return t.takeLeading(u,e,n)},u.takeEvery=function(e,n){return t.takeEvery(u,e,n)},u.useIn=t.useIn,u}}}));
//# sourceMappingURL=action_creator.min.js-vflK7Ij_7.map