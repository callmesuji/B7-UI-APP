define(["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/modals/action_utility_modal","modules/clean/components/modals/show_modal","modules/clean/teams/admin/modals/modal_ajax","modules/core/browser","spectrum/button","modules/clean/rondo/forms/index","modules/clean/react/css"],(function(e,t,a,s,i,n,o,r,d,l,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showTeamAssumeUserModal=t.TeamAssumeUserModalApp=t.ASSUME_TEAM_USER_URL=t.TeamAssumeUserModal=t._getNotificationModeInitState=t.NOTIFICATION_MODE_ALL_TEAM_ADMINS=t.NOTIFICATION_MODE_ASSUMED_MEMBER=void 0,s=a.__importDefault(s),d=a.__importStar(d);t.NOTIFICATION_MODE_ASSUMED_MEMBER="member",t.NOTIFICATION_MODE_ALL_TEAM_ADMINS="admins",t._getNotificationModeInitState=function(e){return e?t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:t.NOTIFICATION_MODE_ASSUMED_MEMBER};var c=(function(e){function o(n){var o=e.call(this,n)||this;return o._getAssumeModalBody=function(){return s.default.createElement("div",{className:"team-assume-user-modal"},o.props.customMessage&&s.default.createElement("div",{className:"team-assume-user-modal__custom-message"},o.props.customMessage),o._getNotificationOptionText()," ",i.intl.formatMessage({id:"k8YyVZ",defaultMessage:"All actions you perform while signed in as {name} will be recorded in the activity log."},{name:o.props.displayName})+" ",o._shouldShowSettingsModalLink()&&s.default.createElement("button",{className:"button-as-href",id:"assume_change_settings",onClick:o._goToSettings},i.intl.formatMessage({id:"XthdPa",defaultMessage:"Change notification settings"})),s.default.createElement("div",{className:"member-page-settings-notification"},i.intl.formatMessage({id:"5ujupL",defaultMessage:"<b>Note:</b> {firstname}’s settings can only be changed in the <a>members page.</a>"},{a:function(e){return s.default.createElement("a",{href:"/team/admin/members/member?id="+o.props.userId},e)},b:function(e){return s.default.createElement("span",{className:"bold-text"},e)},firstname:o.props.firstName})))},o._goToSettings=function(){o.setState({isSettingsPage:!0,currNotificationMode:o.props.notificationMode.fieldValue})},o._goToAssumeUser=function(){o.setState({isSettingsPage:!1,currNotificationMode:o.props.notificationMode.fieldValue})},o._clearSettingsAndGoToAssumeUser=function(){o.props.notificationMode.fieldValue=o.state.currNotificationMode,o._goToAssumeUser()},o._getNotificationOptionText=function(){return o._isSingleAdminWithNoMemberNotification()?i.intl.formatMessage({id:"CIiM/g",defaultMessage:"A record will be made in the activity log that you have signed in to {name}’s account."},{name:o.props.displayName}):s.default.createElement("span",null,o._getWillBeNotifiedText(o._getNotificantDisplayName()))},o._isSingleAdminWithNoMemberNotification=function(){return!o._hasAdditionalAdmins()&&o.props.notificationMode.fieldValue!==t.NOTIFICATION_MODE_ASSUMED_MEMBER},o._hasAdditionalAdmins=function(){return o.props.shouldNotifyAdmins},o._getNotificantDisplayName=function(){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return o.props.displayName+" ";case t.NOTIFICATION_MODE_ALL_TEAM_ADMINS:return"All team admins ";default:return"Nobody "}},o._getWillBeNotifiedText=function(e){switch(o.props.notificationMode.fieldValue){case t.NOTIFICATION_MODE_ASSUMED_MEMBER:return i.intl.formatMessage({id:"Bzjp8Q",defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to their account."},{b:function(e){return s.default.createElement("span",{className:"bold-text"},e)},name:e});default:return i.intl.formatMessage({id:"OTHFTR",defaultMessage:"<b>{name}</b> will be notified that you’ve signed in to {assume_name}’s account."},{b:function(e){return s.default.createElement("span",{className:"bold-text"},e)},name:e,assume_name:o.props.displayName})}},o._shouldShowSettingsModalLink=function(){return!o.props.isUserSuspended||o._hasAdditionalAdmins()},o._getSettingsModalBody=function(){return s.default.createElement("div",{className:"team-assume-user-modal"},o._renderSettingPhrase(),o._renderSettingsOptions())},o._renderSettingsOptions=function(){return s.default.createElement("div",{className:"settings-selection"},s.default.createElement("div",null,s.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ASSUMED_MEMBER,name:"notificationMode",disabled:o.props.isUserSuspended},o.props.notificationMode),o._radioButtonTextNotificationAssumedMembmer())),s.default.createElement("div",null,s.default.createElement(u.RadioButton,a.__assign({value:t.NOTIFICATION_MODE_ALL_TEAM_ADMINS,name:"notificationMode"},o.props.notificationMode),o._radioButtonTextNotificationAllTeamAdmins())))},o._renderSettingPhrase=function(){return s.default.createElement("div",null,o._hasAdditionalAdmins()?i.intl.formatMessage({id:"WZHfy+",defaultMessage:"Who should be notified when you sign in to this member’s account? They will receive an email stating that you signed in as {display_name}."},{display_name:o.props.displayName}):i.intl.formatMessage({id:"iNPp9N",defaultMessage:"Where should a record be made when you sign in to this member’s account? If your choice is the member, they will receive an email stating that you signed into their account."}),s.default.createElement("a",{className:"textual-button",id:"assume_learn_more",href:"/help/9185",target:"blank",rel:"noreferrer"},i.intl.formatMessage({id:"gk12sS",defaultMessage:"Learn more"})))},o.state={isSettingsPage:!1,currNotificationMode:t._getNotificationModeInitState(o.props.isUserSuspended)},o}return a.__extends(o,e),o.prototype._radioButtonTextNotificationAssumedMembmer=function(){return i.intl.formatMessage({id:"uciNR2",defaultMessage:"The member and activity log (recommended)"})},o.prototype._radioButtonTextNotificationAllTeamAdmins=function(){return this._hasAdditionalAdmins()?i.intl.formatMessage({id:"FhbDUp",defaultMessage:"All team admins and activity log"}):i.intl.formatMessage({id:"QVvFym",defaultMessage:"Team activity log only"})},o.prototype._settingsActionButton=function(){return s.default.createElement(l.Button,{onClick:this._goToAssumeUser},i.intl.formatMessage({id:"kTq6n5",defaultMessage:"Save settings"}))},o.prototype._settingsCancelButton=function(){return s.default.createElement(l.Button,{variant:"secondary",onClick:this._clearSettingsAndGoToAssumeUser},i.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}))},o.prototype.render=function(){var e=this,t=this.props,a=t.onPrimaryAction,o=t.onSecondaryAction,r=t.onRequestClose,d=this.state.isSettingsPage,l=d?i.intl.formatMessage({id:"pWpyyE",defaultMessage:"Sign in as member settings"}):i.intl.formatMessage({id:"sfSmtg",defaultMessage:"Sign in as member?"}),u=d?this._getSettingsModalBody():this._getAssumeModalBody(),m=d?function(){return e._settingsActionButton()}:i.intl.formatMessage({id:"raLp6W",defaultMessage:"Sign in"}),c=d?function(){return e._settingsCancelButton()}:i.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"});return s.default.createElement(n.ActionUtilityModal,{title:l,id:"team-assume-user-modal",primaryAction:m,secondaryAction:c,onPrimaryAction:a,onSecondaryAction:o,onRequestClose:r},u)},o})(s.default.Component);t.TeamAssumeUserModal=m.requireCssWithComponent(c,["/static/css/team_assume_user_modal-vflF8AdkY.css"]),t.ASSUME_TEAM_USER_URL="/team/admin/assume_user",t.TeamAssumeUserModalApp=function(e){var s=e.displayName,i=e.firstName,n=e.userId,o=e.isUserSuspended,l=e.shouldNotifyAdmins,u=e.customMessage,m=a.__rest(e,["displayName","firstName","userId","isUserSuspended","shouldNotifyAdmins","customMessage"]);return r.modalAjax({modal:t.TeamAssumeUserModal,ajax:{url:t.ASSUME_TEAM_USER_URL,data:function(e){var t=e.notificationMode;return{user_id:n,notification_mode:t,return_url:d.get_href()}}},fields:{notificationMode:{fieldValue:t._getNotificationModeInitState(o)}}})(a.__assign({displayName:s,firstName:i,userId:n,isUserSuspended:o,shouldNotifyAdmins:l,customMessage:u},m))},t.showTeamAssumeUserModal=function(e){return o.showModal(s.default.createElement(t.TeamAssumeUserModalApp,a.__assign({},e)))}}));
//# sourceMappingURL=team_assume_user_modal.min.js-vflMT2vWT.map