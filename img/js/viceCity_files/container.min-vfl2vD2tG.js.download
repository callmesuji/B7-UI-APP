define(["require","exports","tslib","prop-types","react","spectrum-sharing/utils/sharing_constants","modules/clean/auth/login_or_register/types","modules/clean/cloud_docs/types","modules/clean/react/file_viewer/file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/async_file_viewer","modules/clean/react/file_viewer/sdk_file_viewer/utils","modules/clean/open_in_app/actions","modules/clean/sharing/async_share_modal_util","modules/clean/viewer","modules/clean/react/file_viewer/data/store","modules/clean/web_timing_logger","modules/clean/react/extensions/data/store","modules/clean/integrations/zoom_share_dialog/async_modal","modules/constants/file_viewer","file-viewer/public/support","modules/clean/previews/util","modules/core/browser"],(function(e,i,t,n,r,o,s,a,l,d,u,p,c,h,_,m,f,g,w,v,I,y){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FileViewerContainer=void 0,n=t.__importDefault(n),r=t.__importDefault(r),y=t.__importStar(y);var S=(function(i){function S(e){var t=i.call(this,e)||this,n=h.Viewer.get_viewer(),r=e.userId?n.get_user_by_id(e.userId):n.work_user||n.personal_user;t.state={user:r,isCapture:!1},m.log_js_modules_application_code_start();var o=e.file,s=_.getStoreForFileViewer();return _.hydrateFileViewerNamespace(s,{file:o},r),r&&f.initializeStore(r,[o]),t}return t.__extends(S,i),S.prototype.componentDidMount=function(){var i,n=this,o=this.props,l=o.shareEmail,d=o.shareModalVariant,u=o.sharedLinkInfo,h=o.file;if(new URLSearchParams(y.get_uri()).get("capture")&&this.setState({isCapture:!0}),l||d&&d!==a.ShareModalVariant.closed&&this.state.user)new Promise((function(i,t){e(["modules/clean/react/browse/models"],i,t)})).then(t.__importStar).then((function(e){var i=e.File,t=l?l.split(","):[];c.asyncShowPrefilledShareModal({user:n.state.user,sharePrefillEmails:t,content:new i(n.props.file)})}));else if(this.props.authModalKind!==s.LoginOrRegisterKind.IMMEDIATE||this.state.user||this.state.isCapture)this.props.presentInZoom&&this.state.user&&g.asyncShowModal(this.state.user.id,h.file_id,"file-viewer-modal-overlay","desktop");else{i=this.props.encryptionOptions,t.__awaiter(n,void 0,void 0,(function(){var n,o,a;return t.__generator(this,(function(l){switch(l.label){case 0:return[4,Promise.all([new Promise((function(i,t){e(["modules/clean/react/modal"],i,t)})).then(t.__importStar),new Promise((function(i,t){e(["modules/clean/auth/login_or_register/modal"],i,t)})).then(t.__importStar)])];case 1:return n=l.sent(),o=n[0].Modal,a=n[1].LoginOrRegisterModal,o.showInstance(r.default.createElement(a,{downloadAction:null,id:"shared-link-immediate-signup-modal",initialMode:s.Mode.REGISTER,kind:s.LoginOrRegisterKind.IMMEDIATE,onCancel:function(){},signup_tag:"shmodel_modal_register",showGoogleRegistration:!0,googleRegisterProps:u?{signupContinuationUrl:u.url}:void 0,encryptionOptions:i})),[2]}}))}))}if(this.props.openImmediatelyInApp){var _=this.props.file;p.openImmediately(_.open_in_app_data)}},S.prototype.shouldUseSDKToRender=function(e,i){var t=this.props.sharedLinkInfo,n=t&&!t.hasPublicAudienceOrVisibility&&i.linkType===o.SharedLinkType.Content;return Boolean(n&&v.isPreviewTypeSupported(e.preview,u.INBAND_SUPPORTED_TYPES)&&!I.isCloudDocPreview(e))},S.prototype.isInbandExperimentEnabled=function(){return w.INBAND_FVSDK_LINKS},S.prototype.isBrandingInfoDefined=function(){var e=this.props.brandingInfo;return e&&Object.keys(e).some((function(i){return!!e[i]}))},S.prototype.render=function(){var e=this.props,i=e.file,n=e.fileViewerProps,o=e.onCloseUrl,s=e.isEmbedded,a=e.brandingInfo,u=e.encryptionOptions,p=e.openInHelloSign,c=e.openInHelloSignSrc,h=e.sharedLinkInfo,_=e.shareToken,m=e.sharePermission,f=e.LoggedOutUXGoogleVariant,g=e.authModalKind,w=e.expGrowthActSmbWorkflowsBaton,v=this.state.user,I=v&&h&&_&&!this.isBrandingInfoDefined()&&this.shouldUseSDKToRender(i,_),y=I&&this.isInbandExperimentEnabled()&&_&&h&&v?r.default.createElement(d.AsyncFileViewer,{file:i,sharedLinkInfo:h,sharePermission:m,shareToken:_,user:v}):r.default.createElement(l.FileViewer,t.__assign({},n,{fileCount:1,fileIndex:0,titleBarCloseUrl:o,sharedLinkInfo:h,brandingInfo:a,openInHelloSign:p,openInHelloSignSrc:c,shareToken:_,sharePermission:m,user:v,transparentBackground:!1,LoggedOutUXGoogleVariant:f,encryptionOptions:u,authModalKind:g,isInbandExperiment:!!I,expGrowthActSmbWorkflowsBaton:w,isCapture:this.state.isCapture}));return s?r.default.createElement("div",{className:"embedded"},y):y},S.prototype.getChildContext=function(){return{authModalKind:this.props.authModalKind}},S.childContextTypes={authModalKind:n.default.oneOf(["download","immediate",null])},S})(r.default.Component);i.FileViewerContainer=S}));
//# sourceMappingURL=container.min.js-vflbZr4AN.map