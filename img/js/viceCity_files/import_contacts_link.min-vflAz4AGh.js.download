define(["require","exports","tslib","react","modules/clean/analytics","dig-components/typography","modules/core/i18n","modules/clean/profile_services/profile_services_link","modules/clean/profile_services/profile_services_constants","modules/clean/viewer","modules/clean/api_v2/user_client","modules/clean/static_urls"],(function(e,t,i,o,r,n,s,a,c,l,u,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImportContactsLink=t.googleIconAltName=t.sharingDisclosureMessage=t.importLinkText=t.searchLinkText=void 0,o=i.__importStar(o),c=i.__importDefault(c),t.searchLinkText=s.intl.formatMessage({id:"H9rZ+V",defaultMessage:"Search Google contacts"}),t.importLinkText=s.intl.formatMessage({id:"qrH/PP",defaultMessage:"Import Google contacts"}),t.sharingDisclosureMessage=s.intl.formatMessage({id:"LPpAbn",defaultMessage:"We'll import your organization contacts for you and other admins to use"});var d=c.default.to_api_service_type(c.default.GOOGLE),g=c.default.from_api_to_img(d);t.googleIconAltName=c.default.from_api_to_name(d),t.ImportContactsLink=function(e){var s=e.launchImportModal,d=o.useState({".tag":"other"}),m=d[0],f=d[1],v="disabled"===m[".tag"],p=["not_connected","failed"];o.useEffect((function(){k()}),[]);var h=o.useMemo((function(){return function(e){return i.__awaiter(void 0,void 0,void 0,(function(){var t,o,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e.preventDefault(),e.stopPropagation(),p.includes(m[".tag"])?(t=new a.ProfileServicesLinkingHandler,o=l.Viewer.get_viewer().work_user,r.TeamsWebActionsLogger.log("google_directory_oauth_start"),[4,t.auth_service_with_user_promise(c.default.GOOGLE,o.id,"invite_members_modal","link_directory_members",a.AuthWindowOption.POP_UP)]):(s(v),[2]);case 1:return n=i.sent(),a.ProfileServicesLinkingHandler.show_import_notifications(n),n.success?(r.TeamsWebActionsLogger.log("google_directory_oauth_success"),s(v)):r.TeamsWebActionsLogger.log("google_directory_oauth_fail",{failure_reason:n.err_msg?n.err_msg:"unspecified"}),[2]}}))}))}}),[s,m,v]),k=function(){return i.__awaiter(void 0,void 0,void 0,(function(){var e,t,o,n;return i.__generator(this,(function(i){switch(i.label){case 0:return e=l.Viewer.get_viewer(),[4,(new u.UserApiV2Client).ns("domain_contacts").rpc("check_status",void 0,{subjectUserId:e.work_user.id})];case 1:return t=i.sent(),o={".tag":"not_connected"},-1!==(n=t.import_statuses.findIndex((function(e){return"google"===e.service[".tag"]})))&&(o=t.import_statuses[n].status),r.TeamsWebActionsLogger.log("google_directory_import_link_shown",{domain_contacts_connected:"not_connected"!==o[".tag"]}),f(o),[2]}}))}))};if(!("other"!==m[".tag"]))return null;var w=p.includes(m[".tag"]);return o.default.createElement("div",{className:"invite-modal__invite-from-gsuite-wrapper"},o.default.createElement("div",{className:"invite-modal__invite-from-gsuite-link"},o.default.createElement(n.Link,{href:"",hasNoUnderline:!0,onClick:h},o.default.createElement("img",{className:"invite-modal__invite-from-gsuite-icon",src:_.static_url(g),alt:t.googleIconAltName}),w?t.importLinkText:t.searchLinkText)),w&&o.default.createElement(n.Text,{className:"invite-modal__invite-from-gsuite-disclosure",color:"faint",size:"small",tagName:"div"},t.sharingDisclosureMessage))}}));
//# sourceMappingURL=import_contacts_link.min.js-vfleztDgV.map