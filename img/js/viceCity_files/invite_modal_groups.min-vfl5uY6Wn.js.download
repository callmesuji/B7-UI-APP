define(["require","exports","tslib","react","modules/core/i18n","dig-components/buttons","dig-components/tooltips","dig-components/icons/src","dig-components/modal","dig-components/typography","dig-components/icons","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/css","modules/clean/teams/admin/widgets/groups/groups_typeahead","modules/clean/teams/admin/widgets/invite_modal/email_tokenizer","modules/clean/teams/admin/widgets/groups/create_group_modal","modules/clean/validators/email_validator"],(function(e,t,a,n,o,s,l,i,r,u,d,m,c,g,f,p,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GroupsInviteModal=void 0,n=a.__importStar(n),v=a.__importDefault(v);var M={email:{title:n.default.createElement(u.Text,{isBold:!0},o.intl.formatMessage({id:"W3tNbf",defaultMessage:"Add email addresses"})),valid:function(e){return e.every((function(e){return v.default.validate(e).every((function(e){return e.valid}))}))},error:o.intl.formatMessage({id:"FXfq01",defaultMessage:"Enter a valid email address"})},groups:{title:n.default.createElement("div",null,o.intl.formatMessage({id:"cxuwqy",defaultMessage:"<text>Add members to groups</text> <faint>(Optional)</faint>"},{text:function(e){return n.default.createElement(u.Text,{isBold:!0},e)},faint:function(e){return n.default.createElement(u.Text,{color:"faint"},e)}})),valid:function(e,t){return!t&&!e.some((function(e){return e.variant&&"default"!==e.variant}))},error:o.intl.formatMessage({id:"zPKMtc",defaultMessage:"Group name incomplete"}),tooltip:n.default.createElement(l.Tooltip,{className:"group-row-tooltip",title:o.intl.formatMessage({id:"ugUr8k",defaultMessage:"Create groups to quickly give the right people access to files."})},n.default.createElement("div",{className:"group-row-tooltip__content",onMouseOver:function(){return m.TeamsWebActionsLogger.log("invite_member_about_groups_hover")}},n.default.createElement(d.UIIcon,{className:"middle-align",src:i.HelpFill})))}},E=function(e){var t=e.title,a=e.submitted,o=e.valid,s=e.values,l=e.error,i=e.children,r=e.input,d=e.tooltip;return n.default.createElement(n.default.Fragment,null,t,n.default.createElement("div",{className:"tooltip-container"},i,d),a&&!o(s,r)?n.default.createElement(u.Text,{className:"validation-msg",color:"error"},l):null)};t.GroupsInviteModal=g.requireCssWithComponent((function(e){var t,l=e.open,i=e.isSubmitting,d=void 0!==i&&i,g=e.memberList,v=e.handleOnClose,y=e.sendInvites,h=e.handleCSVImport,C="invite-modal-groups",b=n.useState({emails:[],groups:[]}),S=b[0],I=b[1],x=n.useState(),N=x[0],T=x[1],w=n.useState([]),k=w[0],B=w[1],A=n.useState(!1),G=A[0],L=A[1],q=n.useState(!1),O=q[0],F=q[1],z=n.useState(!1),U=z[0],W=z[1];n.useEffect((function(){l||I({emails:[],groups:[]}),l&&!G&&f.fetchGroups().then(B)}),[l,G]),n.useEffect((function(){F(M.email.valid(S.emails)&&M.groups.valid(S.groups,N)),0===S.emails.length&&W(!1)}),[S]);var P=function(e){m.TeamsWebActionsLogger.log("invite_member_group_added",{group_name:e.group_name}),B((function(t){return a.__spreadArrays(t,[e])})),I(a.__assign(a.__assign({},S),{groups:a.__spreadArrays(S.groups,[e])}))};return G?n.default.createElement(_.CreateGroupModal,{open:G,handleOnClose:function(e){L(!1),e&&!f.groupExists(S.groups,e.group_name)&&P(e)}}):n.default.createElement(r.Modal,{open:l,className:C,overlayClassName:C+"__overlay",withCloseButton:o.intl.formatMessage({id:"lNU//O",defaultMessage:"Close Modal"}),onRequestClose:function(){return v()}},n.default.createElement(r.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(u.Title,null,o.intl.formatMessage({id:"nvkATX",defaultMessage:"Invite members to your team"}))),n.default.createElement(r.Modal.Body,{className:C+"__body"},n.default.createElement(E,a.__assign({},M.email,{values:S.emails,submitted:U}),n.default.createElement(p.EmailTokenizer,{placeholder:S.emails.length?void 0:o.intl.formatMessage({id:"yU0xda",defaultMessage:"Email address"}),emails:S.emails,memberList:g,onChange:function(e){return I(a.__assign(a.__assign({},S),{emails:e}))}})),n.default.createElement(E,a.__assign({},M.groups,{input:N,values:S.groups,submitted:U}),n.default.createElement(f.GroupsTypeahead,{selected:S.groups,groups:k,onCreate:P,onChange:function(e){return I(a.__assign(a.__assign({},S),{groups:e}))},onInputChange:function(e){return T(e)},handleCreateModal:function(e){return L(e)}}))),n.default.createElement(r.Modal.Footer,null,h&&n.default.createElement(s.Button,{variant:"transparent",onClick:function(){return h()}},o.intl.formatMessage({id:"7uyY2y",defaultMessage:"Import CSV"})),n.default.createElement(s.Button,{variant:"outline",onClick:function(){return v()}},o.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),n.default.createElement(s.Button,{variant:"primary",onClick:function(){W(!0),O&&y(S.emails,S.groups.map((function(e){return e.group_id})))},disabled:d||(U?!O:!(null===(t=S.emails)||void 0===t?void 0:t.length))},d?n.default.createElement(c.LoadingIndicator,{style:c.LoadingIndicator.LoadingIndicatorStyle.SPINNER}):o.intl.formatMessage({id:"yzFoXG",defaultMessage:"Send invites"}))))}),["/static/css/dig-components/index.web-vflGIJpmK.css","/static/css/teams/admin/widgets/invite_modal/invite_modal_groups-vfl-t8WkW.css"])}));
//# sourceMappingURL=invite_modal_groups.min.js-vflerQnDN.map