define(["require","exports","tslib","react","react-intl","spectrum/modal","modules/clean/deprecated_ajax/ajax_jquery","modules/core/browser_detection","modules/core/i18n","modules/clean/ux_analytics_modal_tracking","modules/constants/page_load","modules/clean/react/css","modules/clean/react/growth/first_task/first_task","modules/clean/react/admin/teams/onboarding/web/constants","modules/clean/growth/smb_funnel/smb_funnel_logger","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_data","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_invite_content","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_member_list","modules/clean/teams/admin/widgets/invite_modal/invite_modal_first_task/invite_modal_sidebar","modules/clean/react/table","modules/clean/viewer"],(function(e,t,a,i,s,n,o,l,r,m,d,c,u,_,b,f,v,p,g,h,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstTaskInviteModal=t.FirstTaskInviteModalWithoutCss=void 0,i=a.__importDefault(i),o=a.__importStar(o),l=a.__importStar(l);var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={memberActionsData:void 0},t.focusRef=i.default.createRef(),t}return a.__extends(t,e),t.prototype.loadMemberActionsData=function(e){var t=this.props,i=t.evhMaxDays,s=t.memberList,n=t.relaunchModal,l=t.updateMemberList,r={is_current:!0,limit:s.length,offset:0,sort_column:"user_type",sort_direction:h.TableSortDir.ASC};o.WebRequest({url:"/team/admin/members/list_v2",data:r,subject_user:M.Viewer.get_viewer().work_user,success:function(t){var o={},r=new Date((new Date).setDate(i||0)).toLocaleDateString();JSON.parse(t).members.forEach((function(e){var t=e.user_id;o[t]=a.__assign(a.__assign({},f.getMemberInviteActionsProperties(e,r)),{onClose:function(){n(s)},deleteCallback:function(){for(var e=0;e<s.length&&s[e].user_id!==t;e++);s.splice(e,1),n(s)},roleUpdateCallback:function(e){for(var i=0;i<s.length;i++)if(s[i].user_id===t){var n=a.__assign({},s[i]);n.admin_role=e,s[i]=n}l(s)}})}),{}),e(o)}})},t.prototype.componentDidMount=function(){var e=this,t={platform:this.props.loggingExtras.is_client?b.Platform.DESKTOP_SSCV:l.is_supported_mobile_browser()?b.Platform.MOBILE_WEB:b.Platform.WEB};b.SMBFunnelLogger.setCommonTags(t),b.SMBFunnelLogger.log(_.AMPMetrics.ACTIVATION_IMM_VIEW),this.loadMemberActionsData((function(t){e.setState({memberActionsData:t})}))},t.prototype.componentDidUpdate=function(e){var t=this;e.memberList.length!==this.props.memberList.length&&this.loadMemberActionsData((function(e){t.setState({memberActionsData:e})}))},t.prototype.render=function(){var e=this.props,t=e.open,a=e.tieredAdmin,o=e.isAddAdminRoleDialogV2Enabled,l=e.teamAvailableRoles,c=e.memberList,_=e.showSidebar,b=e.emails,f=e.sentEmails,h=e.handleOnClose,C=e.onCSVImport,I=e.handleOnSubmit,w=e.handleCSVImport,E=e.renderInputForm,S=e.renderPricingInfo,k=e.renderSubmitBtn,A=e.loggingExtras,D=e.showImportCSV,L=e.isInviteLinkEnabled,y=e.isMobileWeb,T=y?"invite-modal-first-task-mobile":"invite-modal-first-task",V=M.Viewer.get_viewer(),O=V.work_user,R=V.team_id,W=V.team_name;if(!O||!R||!W)return null;var x=O.id,B=1===c.length||y?r.intl.formatMessage({id:"5dI3gl",defaultMessage:"Invite team members"}):r.intl.formatMessage({id:"WzCl9b",defaultMessage:"Manage team members"});return i.default.createElement(s.IntlProvider,{defaultLocale:"en-US",locale:r.localeToBcp47LangTag(d.USER_LOCALE)},i.default.createElement(n.Modal,{className:y?"mw-invites-modal-sheet":"",open:t,ariaLabel:r.intl.formatMessage({id:"Ntdwnu",defaultMessage:"Invite Members"}),displayCloseButton:!0,onRequestClose:function(){f.length&&u.showClinkTooltip(u.TooltipType.Members),h()},overlayClickClose:!0,width:_?960:699,overflowY:!0,focusedElementOnOpen:this.focusRef,appElement:document.body,bodyClassName:"invite-modal "+T+" "+(_?T+"--sidebar-visible":"")},i.default.createElement(m.UXAnalyticsModalTracking,{id:"invite-modal"}),i.default.createElement("div",{className:T+"__container"},i.default.createElement("div",{className:T+"__content"},i.default.createElement("div",{className:T+"__title"},B),i.default.createElement(v.InviteModalInviteContent,{baseClass:T,focusRef:this.focusRef,currentUser:O,handleOnSubmit:I,onCSVImport:C,handleCSVImport:w,renderInputForm:E,renderSubmitBtn:k,showImportCSV:D,isInviteLinkEnabled:L,isMobileWeb:y}),S&&S(),i.default.createElement(p.InviteModalMemberList,{baseClass:T,currentUserId:x,teamId:R,teamName:W,tieredAdmin:a,isAddAdminRoleDialogV2Enabled:o,teamAvailableRoles:l,memberList:c,memberActionsData:this.state.memberActionsData,handleOnClose:h,loggingExtras:A,isMobileWeb:y})),_&&i.default.createElement(g.InviteModalSidebar,{baseClass:T,memberList:c,emails:b,sentEmails:f}))))},t})(i.default.Component);t.FirstTaskInviteModalWithoutCss=C,t.FirstTaskInviteModal=c.requireCssWithComponent(C,["/static/css/dig-components/index.web-vflGIJpmK.css","/static/css/teams/admin/widgets/invite_modal/invite_modal_first_task-vfl3asgRJ.css"])}));
//# sourceMappingURL=invite_modal_first_task.min.js-vfl_AIHbe.map