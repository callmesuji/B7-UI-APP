define("family/common/features",["require","exports","tslib","react"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFeatureFlag=t.FeatureFlagProvider=t.FAMILY_FEATURE_FLAGS=void 0;var i=(n=a.__importStar(n)).createContext,o=n.useContext;(t.FAMILY_FEATURE_FLAGS||(t.FAMILY_FEATURE_FLAGS={})).HAS_FAMILY_SHARED_FOLDER="has_family_shared_folder";var l=i({});t.FeatureFlagProvider=function(e){var t=e.children,a=e.flags;return n.createElement(l.Provider,{value:a},t)},t.useFeatureFlag=function(e){return!!o(l)[e]}})),define("family/common/links",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REMOVE_MEMBER_HELP_CENTER_ARTICLE=t.FAMILY_ROOM_HELP_CENTER_ARTICLE=void 0,t.FAMILY_ROOM_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/share-files-family-plan#familyroom",t.REMOVE_MEMBER_HELP_CENTER_ARTICLE="https://help.dropbox.com/accounts-billing/plans-upgrades/manage-family-plan#remove"})),define("modules/clean/account_page/constants",["require","exports","modules/core/uri"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GIGABYTE_IN_BYTES=t.MEGABYTE_IN_BYTES=t.ROOT_DOWNGRADE_URI=t.CancellationType=void 0,(function(e){e[e.ALL=1]="ALL",e[e.PLAN=2]="PLAN",e[e.SCHEDULE=3]="SCHEDULE",e[e.LICENSES=4]="LICENSES",e[e.EVH_ADDON=5]="EVH_ADDON",e[e.IND_SUBSCRIPTION=6]="IND_SUBSCRIPTION",e[e.FAMILY_NONPAYER=7]="FAMILY_NONPAYER"})(t.CancellationType||(t.CancellationType={})),t.ROOT_DOWNGRADE_URI=new a.URI({path:"/downgrade",query:{oqa:"acc_cancel"}}),t.MEGABYTE_IN_BYTES=1048576,t.GIGABYTE_IN_BYTES=1073741824})),define("modules/clean/account_page/tabs/billing",["require","exports","tslib","react","react-redux","styled-components","modules/clean/account_page/components/key_value_block","modules/clean/account_page/components/loading","modules/clean/account_page/util","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/billing/views/billing_history","modules/clean/account_page/widgets/billing/views/invoice_details","modules/clean/account_page/widgets/billing/views/license_keys","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/account_page/widgets/plan/views/add_schedule_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/event_handler","modules/clean/payments/skus/constants","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/subscription_status","modules/clean/react/css","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/react/snackbar","modules/clean/teams/admin/lib/billing_history","modules/clean/web_timing_logger","modules/constants/trademark","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P,S,M,C,E,T,w,A,I,x,L,N,k,D,B,R,O,F,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initialize_module=t.moduleInit=t.BillingTab=t.BillingTabView=void 0,n=a.__importDefault(n),i=a.__importStar(i),o=a.__importDefault(o),B=a.__importStar(B);var q=o.default.div(Y||(Y=a.__makeTemplateObject(["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n          }\n        }\n      }\n\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n\n        .description-line {\n          margin: 0;\n        }\n      }\n\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n    }\n  }\n"],["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n          }\n        }\n      }\n\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n\n        .description-line {\n          margin: 0;\n        }\n      }\n\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n    }\n  }\n"]))),j=(function(e){function t(t){var a=e.call(this,t)||this;return a.browserUpdateRequired=function(){return!!a.props.browserUpdateRequired&&(A.BrowserUpdateModalLoader.showInstance(),!0)},a.handlePaymentUpdate=function(){a.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_update_payment_method_click"),a.props.billingInfo.scheduled_for_downgrade?h.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):I.IndividualUpdateBillingModalLoader.showInstance())},a.handlePaymentAdd=function(){a.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_add_payment_method_click"),I.IndividualUpdateBillingModalLoader.showInstance())},a.handlePaymentAddToResubscribe=function(){a.browserUpdateRequired()||(b.ProEventsLogger.log("de_billing_tab_add_payment_method_resubscribe_click"),O.Notify.success(R.intl.formatMessage({id:"CDgQc9",defaultMessage:"Please update your billing information to be resubscribed."})),I.IndividualUpdateBillingModalLoader.showInstance())},a.reloadData=function(){var e=a.props,t=e.loadBillingInfo,n=e.loadPlanDataIfNecessary,i=e.loadEvhInfoIfNecessary;U.resetApolloStore(),t(!0),i(!0),n(!0)},a.handleBillingChange=function(){b.ProEventsLogger.log("de_billing_tab_change_billing_modal_open");var e=a.props.billingInfo,t=e.payment_info;e.scheduled_for_downgrade?h.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):v.ChangeScheduleModalView.showInstance({transitionPerformed:a.reloadData,paymentInfo:t,browserUpdateRequired:a.props.browserUpdateRequired,isFromBillingTab:!0})},a.handleRebillUpsell=function(e){e&&e.showChangePlanConfirm&&y.ChangePlanModalView.showInstance({mode:y.ChangePlanMode.CONFIRM,transitionPerformed:a.reloadData})},a.handleAddBillUpsell=function(){a.props.trialsConfig&&a.props.showNptScheduleModal&&(_.AddScheduleModalView.showInstance({transitionPerformed:a.reloadData,project:a.props.trialsConfig.project,productType:C.SkuContentClient.deserialize(a.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:a.user.id,skuCode:a.props.trialsConfig.trialPlan.skuCode,duration:a.props.trialsConfig.trialPlan.duration,billingId:a.props.billingInfo.payment_info.gateway_id}),b.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"billing_info_updated",project:a.props.trialsConfig.project}))},a.onEditInvoiceDetailsClick=function(){b.ProEventsLogger.log("de_billing_tab_edit_invoice_modal_open"),w.EditInvoiceAddressModalLoader.showUpdateTaxProfileModal(!1,a.onInvoiceDetailsUpdated)},a.onInvoiceDetailsUpdated=function(){a.props.loadBillingInfo(!0)},a.renderLicenseKeys=function(){return n.default.createElement("div",{className:"jest-license-keys account-page-block"},n.default.createElement(m.LicenseKeys,{licenseKeys:a.props.billingInfo.license_keys}))},a.renderBillingHistory=function(){var e=a.props.billingInfo,t=e.transactions,i=e.show_edit_invoice_modal,o=e.edit_past_invoices,l=i&&o,r=!1;null!==t&&t.transactions.length>0&&(r=N.getHistoryData(t.transactions).length>3);return n.default.createElement(u.BillingHistory,{showEditInvoiceModal:l,transactions:t.transactions,filters:t.filters,hasMore:r})},a.renderPaymentMethod=function(){if(!(a.disallowChangesToCurrentBilling||a.props.trialsConfig&&a.props.trialsConfig.hideBillingModal)){var e=a.props.billingInfo.payment_info,t=e.gateway_id,i=e.expiration_date,o=e.description,r=e.is_reseller_billing,s=e.end_date,d=e.deactivated,u=e.is_on_trial,p=e.reseller_name,m=e.reseller_link;if(r){var g=R.intl.formatMessage({id:"b9rPCC",defaultMessage:"Go to {reseller_name} to view or make changes to your account details"},{reseller_name:p}),f=n.default.createElement("a",{href:m,target:"_blank",rel:"noopener noreferrer"},g);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:f})}if(-1!==t){if(!c.shouldHidePaymentMethod(t)&&!a.props.billingInfo.payment_method)return n.default.createElement(l.KeyValueBlock,{className:"add-payment jest-update-payment",keyText:R.intl.formatMessage({id:"7Au+O9",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires"}),linkText:R.intl.formatMessage({id:"YcxVqg",defaultMessage:"Add"}),onLinkClick:a.handlePaymentAddToResubscribe});if(c.isLicenseKey(t))return n.default.createElement("div",{className:"account-page-block"},n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:R.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),subtext:R.intl.formatMessage({id:"nST3rs",defaultMessage:"Add your payment information now to have your subscription automatically renew when it expires"}),linkText:R.intl.formatMessage({id:"CyOG7U",defaultMessage:"Add payment method"}),onLinkClick:a.handlePaymentAdd}));if(c.shouldHidePaymentMethod(t)){var _=c.getPaymentMethodDisabledMessage(t,r,D.TRADEMARK_PLUS,s,d,u);return n.default.createElement(l.KeyValueBlock,{className:"jest-update-payment",keyText:_})}var h=o;return null!==i&&(h=R.intl.formatMessage({id:"3tRkOA",defaultMessage:"{payment_description}, exp: {expiration_date}"},{payment_description:o,expiration_date:i})),n.default.createElement(l.KeyValueBlock,{className:"update-payment-key-value jest-update-payment",keyText:R.intl.formatMessage({id:"DlX7Ow",defaultMessage:"Payment method"}),valueText:h,linkText:R.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}),onLinkClick:a.handlePaymentUpdate})}}},a.renderBillingPeriod=function(){if(!a.disallowChangesToCurrentBilling&&!a.isPlusTrialPlan){var e=a.props.billingInfo,t=e.payment_info,i=e.scheduled_for_downgrade;if(!c.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)&&t.period){if(!t.schedule_switchable&&!i&&!a.isProfessionalTrialPlan)return n.default.createElement(l.KeyValueBlock,{className:"change-billing-period jest-change-billing-period",keyText:R.intl.formatMessage({id:"R8sDaj",defaultMessage:"Sorry, you cannot change your billing schedule at this time."})});var o="yearly"===t.period?R.intl.formatMessage({id:"qklV/o",defaultMessage:"Plan billed yearly"}):R.intl.formatMessage({id:"tWmQYf",defaultMessage:"Plan billed monthly"});return n.default.createElement(l.KeyValueBlock,{className:"change-billing-period jest-change-billing-period",keyText:R.intl.formatMessage({id:"2ln1p6",defaultMessage:"Billing period"}),valueText:o,linkText:R.intl.formatMessage({id:"ZPvZld",defaultMessage:"Change"}),onLinkClick:a.handleBillingChange,disabled:t&&t.is_in_grace_period||a.isBackupPlan})}}},a.renderInvoiceDetails=function(){var e=a.props.billingInfo,t=e.show_edit_invoice_modal,i=e.payment_info,o=e.payment_method,l=e.has_invoice_details;if(a.user.paid&&t&&!c.shouldHideBillingChange(i.gateway_id,i.is_reseller_billing)&&i.period)return n.default.createElement(p.InvoiceDetails,{onLinkClick:a.onEditInvoiceDetailsClick,has_invoice_details:l,country_code:o?o.country_code:void 0})},a.user=s.getCurrentUser(),P.DBModalStack.register(x.BILLING_INFO_UPDATED,(function(e){b.ProEventsLogger.log("de_payment_modal_save_click"),U.resetApolloStore(),a.props.loadBillingInfo(!0),a.props.loadPlanDataIfNecessary(!0),a.handleRebillUpsell(e.detail),a.handleAddBillUpsell()})),a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.loadBillingInfo(),this.checkTTIstate(),b.ProEventsLogger.log("de_billing_tab_view"),this.events.on(window,"hashchange",(function(){e.displayResubscribeBillingModal(),e.displayUpdateBillingModal(),e.displayAddScheduleModal()})),this.displayResubscribeBillingModal(),this.displayUpdateBillingModal(),this.displayAddScheduleModal()},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.displayUpdateBillingModal=function(){var e,t=B.get_hash(),a=void 0!==t&&-1!==t.search("billing_info")&&-1===t.search("resubscribe_billing_info"),i=F.URI.parse(B.get_href()).getQuery().modal,o=i&&"billing_info"===i,l=F.URI.parse(B.get_href()).getQuery().reason,r="auto_convert"===l;if(a||o){if(!this.user.paid)return;if(this.browserUpdateRequired())return;if(this.props.trialsConfig&&this.props.trialsConfig.hideBillingModal)return;if(r){L.Snackbar.show(n.default.createElement(L.Snackbar,{variant:"warn",title:"Manage your trial billing details on your account page.",closeButtonText:R.intl.formatMessage({id:"W4An+g",defaultMessage:"Got it"}),timeoutDelayMs:6e3,useDig:!0}))}I.IndividualUpdateBillingModalLoader.showInstance(),b.ProEventsLogger.log("de_billing_tab_trigger_update_billing_modal",{reason:l,project:null===(e=this.props.trialsConfig)||void 0===e?void 0:e.project})}},t.prototype.displayResubscribeBillingModal=function(){var e=B.get_hash();if(void 0!==e&&-1!==e.search("resubscribe_billing_info")){if(this.browserUpdateRequired())return;I.IndividualUpdateBillingModalLoader.showInstance()}},t.prototype.displayAddScheduleModal=function(){var e=B.get_hash(),t=void 0!==e&&-1!==e.search("add_schedule"),a=F.URI.parse(B.get_href()).getQuery().modal;(t||a&&"add_schedule"===a)&&this.user.paid&&!this.browserUpdateRequired()&&this.props.trialsConfig&&!this.props.trialsConfig.hideBillingModal&&(_.AddScheduleModalView.showInstance({transitionPerformed:this.reloadData,project:this.props.trialsConfig.project,productType:C.SkuContentClient.deserialize(this.props.trialsConfig.trialPlan.skuContent).dropboxDisplayName(),userId:this.user.id,skuCode:this.props.trialsConfig.trialPlan.skuCode,duration:this.props.trialsConfig.trialPlan.duration,billingId:this.props.billingInfo.payment_info.gateway_id}),b.ProEventsLogger.log("de_billing_tab_trigger_add_schedule_modal",{source:"redirect_url",project:this.props.trialsConfig.project}))},Object.defineProperty(t.prototype,"subStatus",{get:function(){var e=this.props.billingInfo.serialized_sub_status;if(e)return E.SubscriptionStatus.deserialize(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.PLUS_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFamilyPayerPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.FAMILY_PAYER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFamilyNonPayerPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.FAMILY_NONPAYER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBackupPlan",{get:function(){var e,t;return(null===(t=null===(e=this.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===M.ProductPlanType.SYNC_EVERYTHING},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disallowChangesToCurrentBilling",{get:function(){return!this.user.paid||this.isFamilyNonPayerPlan},enumerable:!1,configurable:!0}),t.prototype.checkTTIstate=function(){this.props.dataLoadedForTTI&&(k.mark_time_to_view(),k.mark_time_to_interactive())},t.prototype.isLoading=function(){return"ready"!==this.props.loadingState},t.prototype.render=function(){return this.isLoading()?n.default.createElement(r.Loading,null):n.default.createElement(q,{className:"account-page-tab"},this.renderPaymentMethod(),this.renderBillingPeriod(),this.renderInvoiceDetails(),!this.isFamilyPayerPlan&&!this.isFamilyNonPayerPlan&&this.renderLicenseKeys(),this.renderBillingHistory())},t=a.__decorate([S.eventHandler],t)})(n.default.Component);t.BillingTabView=j;var Y,V=i.connect((function(e,t){return{browserUpdateRequired:t.browserUpdateRequired,billingInfo:e.billingInfo.billingInfo,loadingState:e.billingInfo.loadingState,dataLoadedForTTI:"ready"===e.billingInfo.loadingState}}),(function(e){return{loadBillingInfo:function(t){return void 0===t&&(t=!1),e(d.loadDataIfNecessary(t))},loadPlanDataIfNecessary:function(t,a){return void 0===t&&(t=!1),e(g.loadDataIfNecessary(t,a))},loadEvhInfoIfNecessary:function(t){return void 0===t&&(t=!1),e(f.loadEvhInfoIfNecessary(t))}}}))(j);t.BillingTab=T.requireCssWithComponent(V,["/static/css/plan_management-vflirqNOR.css"]),t.moduleInit=function(e){},t.initialize_module=function(e){}})),define("modules/clean/account_page/widgets/billing/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/billing/api","modules/clean/account_page/util"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e){var t=this;return void 0===e&&(e=!1),function(o,l){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===l().billingInfo.loadingState||e?(o({type:"billing_info_load"}),[4,n.getBillingInfo(i.getCurrentUser().id)]):[3,2];case 1:return t=a.sent(),o({type:"billing_info_loaded",billingInfo:t}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/billing/api",["require","exports","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingInfo=void 0,t.getBillingInfo=function(e){return a.WebRequest({url:"/account/ajax_billing_tab_model",subject_user:e,dataType:"json"})}})),define("modules/clean/account_page/widgets/billing/billing_history/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingHistory=void 0,t.getBillingHistory=function(e,t,i,o){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(a){return[2,n.WebRequest({url:"/account/ajax_load_more_billing_history/",data:{block:t,filter_type:i,filter_change:o},subject_user:e,dataType:"json"})]}))}))}})),define("modules/clean/account_page/widgets/billing/billing_history/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryOrder=void 0,(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.BillingHistoryOrder||(t.BillingHistoryOrder={}))})),define("modules/clean/account_page/widgets/billing/views/billing_history",["require","exports","tslib","react","modules/core/i18n","modules/clean/account_page/util","modules/clean/teams/admin/widgets/billing_history/billing_history_table","modules/clean/teams/admin/lib/billing_history","modules/clean/analytics","modules/clean/account_page/widgets/billing/billing_history/api","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/progress_indicators"],(function(e,t,a,n,i,o,l,r,s,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistory=void 0;var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.loadMoreBillingHistory=function(e){return a.__awaiter(n,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return this.setState({isLoading:!0}),s.ProEventsLogger.log("de_billing_history_view_more_click"),e.preventDefault(),[4,d.getBillingHistory(o.getCurrentUser().id,this.state.numBlocksLoaded,this.state.filter,!1)];case 1:return t=a.sent(),this.setState((function(e){return{transactions:e.isInitialLoad?t.transactions:e.transactions.concat(t.transactions),hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded+1,isInitialLoad:!1}})),[2,!1]}}))}))},n.changeFilter=function(e){return a.__awaiter(n,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(a){switch(a.label){case 0:return this.setState({isLoading:!0,filter:e}),s.ProEventsLogger.log("de_billing_history_change_filter_click"),[4,d.getBillingHistory(o.getCurrentUser().id,this.state.numBlocksLoaded,e,!0)];case 1:return t=a.sent(),this.state.isInitialLoad&&(n=r.getHistoryData(t.transactions),t.hasMore=n.length>3),this.setState((function(e){return{transactions:t.transactions,hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded,isInitialLoad:e.isInitialLoad}})),[2,!1]}}))}))},n.changeOrder=function(){n.setState((function(e){return{order:e.order===c.BillingHistoryOrder.ASCENDING?c.BillingHistoryOrder.DESCENDING:c.BillingHistoryOrder.ASCENDING}})),s.ProEventsLogger.log("de_billing_history_change_order_click")},n.handlePopoverSelection=function(e){n.state.filter!==e&&n.state.order!==e&&(e===c.BillingHistoryOrder.ASCENDING||e===c.BillingHistoryOrder.DESCENDING?n.changeOrder():n.changeFilter(e))},n.state={transactions:n.props.transactions?n.props.transactions.slice():[],hasMore:n.props.hasMore,isLoading:!1,numBlocksLoaded:0,isInitialLoad:!0,filter:"all_time",order:c.BillingHistoryOrder.ASCENDING},n}return a.__extends(t,e),t.prototype.render=function(){return n.default.createElement("div",{className:"account-page-block"},n.default.createElement("span",{className:"account-page-block__heading"},i.intl.formatMessage({id:"h9UTH1",defaultMessage:"Billing history"})),n.default.createElement("p",{className:"account-page-block__subtext"},i.intl.formatMessage({id:"efUvgd",defaultMessage:"View invoices and receipts for all payments made on your Dropbox account."})),n.default.createElement("div",{className:"billing-table-container"},n.default.createElement(l.BillingHistoryTable,{billingHistoryRecords:this.getHistory(),amountLabel:i.intl.formatMessage({id:"Q9yFMv",defaultMessage:"Amount"}),displayNoTransactionsOnEmptyRecords:!0,showEditInvoiceModal:this.props.showEditInvoiceModal,noTransactionLabel:i.intl.formatMessage({id:"lj3d2i",defaultMessage:"No transaction history"}),footer:this.buildFooter(),logAccountBillingTabEvents:!0,isTeam:!1,filter:this.state.filter,order:this.state.order,onSelection:this.handlePopoverSelection,filters:this.props.filters})))},t.prototype.getHistory=function(){var e=[];return this.state.transactions.length>0&&(e=r.getHistoryData(this.state.transactions),this.state.isInitialLoad&&(e=e.slice(0,3))),this.state.order===c.BillingHistoryOrder.ASCENDING?e:e.reverse()},t.prototype.buildFooter=function(){return this.state.isLoading?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement(u.Spinner,{size:"small","aria-valuetext":i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))):this.state.hasMore?n.default.createElement("tr",{className:"billing-history-row"},n.default.createElement("td",{colSpan:4,className:"billing-history-col"},n.default.createElement("a",{href:"#",className:"account-page__link",rel:"noopener noreferrer",onClick:this.loadMoreBillingHistory},i.intl.formatMessage({id:"Td8CMX",defaultMessage:"View more billing history"})))):void 0},t})((n=a.__importDefault(n)).default.Component);t.BillingHistory=p})),define("modules/clean/account_page/widgets/billing/views/license_keys",["require","exports","tslib","modules/core/i18n","modules/core/browser","react","styled-components","modules/clean/account_page/components/account_table","modules/clean/account_page/components/key_value_block"],(function(e,t,a,n,i,o,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseKeys=void 0,i=a.__importStar(i),o=a.__importDefault(o);var d,c,u,p,m,g,f,_,h,y,v,b=(l=a.__importDefault(l)).default(r.BodyRow)(d||(d=a.__makeTemplateObject(["\n  height: 56px;\n  border-top: 1px solid var(--color__faint__border);\n"],["\n  height: 56px;\n  border-top: 1px solid var(--color__faint__border);\n"]))),P=l.default(r.HeaderCell)(c||(c=a.__makeTemplateObject(["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"],["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"]))),S=l.default(r.HeaderCell)(u||(u=a.__makeTemplateObject(["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"],["\n  font-weight: normal;\n  text-align: left;\n  font-size: var(--type__body__small--fontsize);\n  color: var(--color__faint__text);\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"]))),M=l.default(r.HeaderRow)(p||(p=a.__makeTemplateObject(["\n  height: var(--spacing__unit--5);\n  background-color: var(--color__faint__background);\n  font-weight: normal;\n"],["\n  height: var(--spacing__unit--5);\n  background-color: var(--color__faint__background);\n  font-weight: normal;\n"]))),C=l.default(r.Table)(m||(m=a.__makeTemplateObject(["\n  width: 100%;\n  border-collapse: collapse;\n  .activated {\n    background-color: var(--color__faint__background);\n  }\n"],["\n  width: 100%;\n  border-collapse: collapse;\n  .activated {\n    background-color: var(--color__faint__background);\n  }\n"]))),E=l.default(r.TableFooter)(g||(g=a.__makeTemplateObject(["\n  width: 100%;\n  text-align: center;\n  border-top: 1px solid var(--color__faint__border);\n"],["\n  width: 100%;\n  text-align: center;\n  border-top: 1px solid var(--color__faint__border);\n"]))),T=l.default.tr(f||(f=a.__makeTemplateObject(["\n  height: 45px;\n"],["\n  height: 45px;\n"]))),w=l.default(r.BodyCell)(_||(_=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n"]))),A=l.default(r.BodyCell)(h||(h=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n"]))),I=l.default(r.BodyCell)(y||(y=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 170px;\n  padding-right: var(--spacing__unit--2);\n"]))),x=l.default(r.BodyCell)(v||(v=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"],["\n  color: var(--color__standard__text);\n  text-align: left;\n  width: 240px;\n  padding-left: var(--spacing__unit--2);\n"]))),L=(function(e){function t(t){var a=e.call(this,t)||this;return a.licenseRowsIncrement=3,a.handleRedeemClick=function(){i.redirect("/pro/redeem_key")},a.buildLicenseFooter=function(){if(a.state.showViewMore)return o.default.createElement(T,{className:"license-footer-row"},o.default.createElement("td",{colSpan:4},o.default.createElement("a",{onClick:a.showMoreLicense,href:"",rel:"noopener noreferrer"},n.intl.formatMessage({id:"fiL806",defaultMessage:"View more license keys"}))))},a.showMoreLicense=function(e){e.preventDefault(),a.setState((function(e,t){var n=e.maxShow+a.licenseRowsIncrement;return{maxShow:n,showViewMore:n<t.licenseKeys.length}}))},a.buildStatus=function(e){return e.activated?n.intl.formatMessage({id:"7rnsEt",defaultMessage:"Activated on {activated_date}"},{activated_date:e.activated_date}):n.intl.formatMessage({id:"QJkpjq",defaultMessage:"Scheduled for future use"})},a.buildDuration=function(e){return e.duration?e.duration:n.intl.formatMessage({id:"CNLpjm",defaultMessage:"N/A"})},a.buildLicenseKeyTable=function(){var e=a.props.licenseKeys;if(0!==e.length)return o.default.createElement("div",null,o.default.createElement(C,{className:"license-table"},o.default.createElement(r.TableHead,null,o.default.createElement(M,null,o.default.createElement(P,null,n.intl.formatMessage({id:"xn3SDu",defaultMessage:"Key"})),o.default.createElement(r.HeaderCell,null,n.intl.formatMessage({id:"Ncw9cm",defaultMessage:"Redeemed"})),o.default.createElement(r.HeaderCell,null,n.intl.formatMessage({id:"E3AATa",defaultMessage:"Duration"})),o.default.createElement(S,null,n.intl.formatMessage({id:"uufVvn",defaultMessage:"Status"})))),o.default.createElement(E,null,a.buildLicenseFooter()),o.default.createElement(r.TableBody,null,e.map((function(e,t){if(!(t>=a.state.maxShow))return o.default.createElement(b,{className:"license-body-row "+(e.activated?"activated":"unused"),key:e.key},o.default.createElement(x,null,e.key),o.default.createElement(w,{className:"license-redeemded"},e.redeemed_date),o.default.createElement(A,null,a.buildDuration(e)),o.default.createElement(I,null,a.buildStatus(e)))})))))},a.state={maxShow:3,showViewMore:!1},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.setState((function(e,t){return{showViewMore:e.maxShow<t.licenseKeys.length}}))},t.prototype.render=function(){return o.default.createElement("div",{className:"license-keys"},o.default.createElement(s.KeyValueBlock,{className:"redeem-license-key",keyText:n.intl.formatMessage({id:"M25rlh",defaultMessage:"License keys"}),linkText:n.intl.formatMessage({id:"dDHqbP",defaultMessage:"Redeem a license key"}),onLinkClick:this.handleRedeemClick,subtext:n.intl.formatMessage({id:"qDYIgp",defaultMessage:"License keys will be applied before any other form of payment method"})}),this.buildLicenseKeyTable())},t})(o.default.Component);t.LicenseKeys=L})),define("modules/clean/account_page/widgets/billing/views/invoice_details",["require","exports","tslib","react","modules/core/i18n","modules/clean/account_page/components/key_value_block","modules/clean/payments/validation"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceDetails=void 0;var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.country_code,a=e.has_invoice_details,r=i.intl.formatMessage({id:"uD4mCH",defaultMessage:"Add details to your invoice, such as company name and address."});t&&l.hasVat(t)&&(r=i.intl.formatMessage({id:"uhx0D0",defaultMessage:"Add details to your invoice, such as company name, address, and VAT ID."}));var s=a?i.intl.formatMessage({id:"+5HiT6",defaultMessage:"Update"}):i.intl.formatMessage({id:"VLPo6o",defaultMessage:"Add invoice details"});return n.default.createElement(o.KeyValueBlock,{className:"jest-invoice-details",keyText:i.intl.formatMessage({id:"IyXKYR",defaultMessage:"Invoice details"}),linkText:s,subtext:r,onLinkClick:this.props.onLinkClick})},t})((n=a.__importDefault(n)).default.Component);t.InvoiceDetails=r})),define("modules/clean/account_page/widgets/plan/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/plan/api","modules/clean/account_page/util"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=void 0,t.loadDataIfNecessary=function(e,t){var o=this;return function(l,r){return a.__awaiter(o,void 0,void 0,(function(){var o;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===r().planTab.loadingState||e?(t||l({type:"plan_tab_load_info"}),[4,n.getPlanInfo(i.getCurrentUser().id)]):[3,2];case 1:return o=a.sent(),l({type:"plan_tab_info_loaded",planInfo:o}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/plan/add_ons/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/add_ons/api"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadEvhInfoIfNecessary=void 0,t.loadEvhInfoIfNecessary=function(e){var t=this;return function(o,l){return a.__awaiter(t,void 0,void 0,(function(){var t;return a.__generator(this,(function(a){switch(a.label){case 0:return"never_loaded"===l().planTab.evhLoadingState||e?(o({type:"load_evh_info"}),[4,i.getEvhInfo(n.getCurrentUser().id)]):[3,2];case 1:return t=a.sent(),o({type:"evh_info_loaded",evhInfo:t}),[2,!0];case 2:return[2,!1]}}))}))}}})),define("modules/clean/account_page/widgets/plan/add_ons/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEvhInfo=void 0,t.getEvhInfo=function(e){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(t){return[2,n.WebRequest({url:"/account/ajax_get_evh_info",subject_user:e,dataType:"json"})]}))}))}})),define("modules/clean/account_page/widgets/plan/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery","modules/clean/api_v2/default_user_client","apiql/client/apollo","modules/clean/account_page/util"],(function(e,t,a,n,i,o,l){"use strict";var r;function s(){return r||(r=o.createApolloClient(l.getCurrentUser().id,{connectToDevTools:!0})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.resetApolloStore=t.getApolloClient=t.getFamilyQuotaInfo=t.getPlanInfo=void 0,t.getPlanInfo=function(e){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(t){return[2,n.WebRequest({url:"/account/ajax_plan_tab_model",subject_user:e,dataType:"json"})]}))}))},t.getFamilyQuotaInfo=function(e){return a.__awaiter(this,void 0,Promise,(function(){return a.__generator(this,(function(t){switch(t.label){case 0:return[4,new i.DefaultUserApiV2Client(e).ns("users").rpc("get_current_account",void 0,{})];case 1:return[2,t.sent().family_quota_info]}}))}))},t.getApolloClient=s,t.resetApolloStore=function(){s().resetStore()}})),define("modules/clean/account_page/widgets/plan/constants",["require","exports","modules/clean/payments/skus/constants"],(function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.planTypeToUpgrades=t.CHANGE_IND_PLAN_MODAL_UPDATED=void 0,t.CHANGE_IND_PLAN_MODAL_UPDATED="change_inv_plan_modal:updated",t.planTypeToUpgrades=((n={})[a.ProductPlanType.FAMILY_PAYER]=[a.ProductPlanType.PROFESSIONAL],n[a.ProductPlanType.PROFESSIONAL]=[a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.PLUS]=[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.STANDARD]=[a.ProductPlanType.PROFESSIONAL,a.ProductPlanType.FAMILY_PAYER,a.ProductPlanType.HS_DBX_PRO_BUNDLE],n[a.ProductPlanType.TRANSFER]=[a.ProductPlanType.PROFESSIONAL],n[a.ProductPlanType.SYNC_EVERYTHING]=[a.ProductPlanType.PLUS,a.ProductPlanType.PROFESSIONAL],n[a.ProductPlanType.PASSWORDS]=[a.ProductPlanType.PLUS,a.ProductPlanType.PROFESSIONAL],n)})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_utils",["require","exports","tslib","lodash","modules/core/exception","modules/clean/metrics/index","modules/clean/account_page/widgets/billing/payment_method_constants","apiql/client/components/account-gql","modules/clean/payments/cash","modules/clean/payments/skus/constants"],(function(e,t,a,n,i,o,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compareScheduledPlan=t.filterRevAPIScheduledPlan=t.convertLegacyScheduledPlan=t.isAccountScheduledPlanResult=t.compareCurrentPlan=t.filterRevAPICurrentPlan=t.convertLegacyCurrentPlan=t.isAccountCurrentPlanResult=t.comparePaymentInfo=t.filterRevAPIPaymentInfo=t.convertLegacyPaymentInfo=t.isAccountPaymentInfoResult=t.compareChangePlanPreviewData=t.filterRevAPIChangePlanPreviewData=t.convertLegacyChangePlanPreviewData=t.isAccountChangePlanPreviewResult=t.compareAvailablePlansData=t.convertLegacyAvailablePlansData=t.legacyProductTypeToProductFamily=t.isAccountAvailablePlansResult=t.recordRevAPIConsistencyStats=t.reportRevAPIException=t.PersonalPlanManagementRoutes=t.RevAPIConsistencyException=void 0;var c,u={INDIVIDUAL_BASIC:[[d.ProductFamily.PRO,d.ProductPlanType.BASIC]],FAMILY:[[d.ProductFamily.FAMILY,d.ProductPlanType.FAMILY_PAYER]],PLUS:[[d.ProductFamily.PRO,d.ProductPlanType.PLUS]],PROFESSIONAL:[[d.ProductFamily.PRO,d.ProductPlanType.PROFESSIONAL]],TRANSFER:[[d.ProductFamily.PRO,d.ProductPlanType.TRANSFER]],BACKUP:[[d.ProductFamily.PRO,d.ProductPlanType.SYNC_EVERYTHING]],TEAM_BASIC:[[d.ProductFamily.TEAM,d.ProductPlanType.BASIC]],STANDARD:[[d.ProductFamily.TEAM,d.ProductPlanType.NEW_STANDARD]],ADVANCED:[[d.ProductFamily.TEAM,d.ProductPlanType.ADVANCED]],SERVER:[[d.ProductFamily.TEAM,d.ProductPlanType.SERVER]],ENTERPRISE:[[d.ProductFamily.ENTERPRISE,d.ProductPlanType.NEW_STANDARD],[d.ProductFamily.ENTERPRISE,d.ProductPlanType.SERVER]],EDUCATION:[[d.ProductFamily.EDUCATION,d.ProductPlanType.STANDARD]],TEAM_DEPRECATED:[[d.ProductFamily.TEAM,d.ProductPlanType.STANDARD],[d.ProductFamily.ENTERPRISE,d.ProductPlanType.STANDARD]]},p=(function(e){function t(t){var a=e.call(this,t)||this;return a.name="RevAPIConsistencyException",a}return a.__extends(t,e),t})(Error);t.RevAPIConsistencyException=p,(function(e){e.GET_AVAILABLE_PLANS="get_available_plans",e.GET_CHANGE_PLAN_PREVIEW="get_change_plan_preview",e.GET_PAYMENT_INFO="get_payment_info",e.GET_CURRENT_PLAN="get_current_plan",e.GET_SCHEDULED_PLAN="get_scheduled_plan"})(c=t.PersonalPlanManagementRoutes||(t.PersonalPlanManagementRoutes={})),t.reportRevAPIException=function(e,t){var a={};if(t)for(var n=0,o=Object.keys(t);n<o.length;n++){var l=o[n];a["mismatch_"+l]=t[l]}i.reportException({err:new p(e),severity:i.SEVERITY.NONCRITICAL,tags:["rev_api_migration_pa"],exc_extra:a})},t.recordRevAPIConsistencyStats=function(e,t){o.getMetricsReporter().createStats({ns:"personal_plan_management",name:"revapi_consistency/"+t}).record(e?1:0)},t.isAccountAvailablePlansResult=function(e){return Boolean(e&&"AccountAvailablePlansResult"===e.__typename)},t.legacyProductTypeToProductFamily=function(e,t){var a;for(a in u)if(a)for(var n=0,i=u[a];n<i.length;n++){var o=i[n];if(o){var l=o[0],r=o[1];if(l===e&&r===t)return a}}return"UNKNOWN_PRODUCT_FAMILY"},t.convertLegacyAvailablePlansData=function(e){if(e)return e.map((function(e){return{advertised_contract_length_price:e.displayCost.formatCurrency(),advertised_space_short_tb:e.formattedSpecQuotaGb,contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:"Dropbox "+e.displayName(),offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)}}))},t.compareAvailablePlansData=function(e,i,o){var l=!0,r=e.map((function(e){return e.offering_id})),s=i.map((function(e){return e.offering_id}));n.isEqual(r,s)||(l=!1,t.reportRevAPIException("Different number of available plans",a.__assign({revAPIPlanIDs:r,legacyPlanIDs:s},o))),l&&i.forEach((function(n,i){var r;for(r in n)"__typename"!==r&&m(n[r])!==m(e[i][r])&&(l=!1,t.reportRevAPIException("Mismatch Catalog and RevAPI available plans data",a.__assign({property:r,revAPIValue:e[i][r],legacyAPIValue:n[r],revAPIOfferingID:e[i].offering_id,legacyOfferingID:n.offering_id},o)))})),t.recordRevAPIConsistencyStats(l,c.GET_AVAILABLE_PLANS)};var m=function(e){return"string"==typeof e?0===e.indexOf("AU$")?"":e.replace(/\s/g,"").replace(/\./g,",").replace(",00",""):e};t.isAccountChangePlanPreviewResult=function(e){return Boolean(e&&"AccountChangePlanPreviewResult"===e.__typename)},t.convertLegacyChangePlanPreviewData=function(e){if(e)return{immediate_price:e.formatted_prorated_price,offering_id:e.sku_code,preview_request_token:"",tax_included_in_total_amount:e.price_includes_tax,upcoming_bill_date:e.formatted_long_date,upcoming_bill_total_price:e.formatted_total_price,vat_id:e.vat}},t.filterRevAPIChangePlanPreviewData=function(e){return{immediate_price:e.immediate_price,offering_id:e.offering_id,preview_request_token:"",tax_included_in_total_amount:e.tax_included_in_total_amount,upcoming_bill_date:e.upcoming_bill_date,upcoming_bill_total_price:e.upcoming_bill_total_price,vat_id:e.vat_id}},t.compareChangePlanPreviewData=function(e,a,i,o){var l=t.filterRevAPIChangePlanPreviewData(i),r=!0;if(!n.isEqual(o,l)){var s=void 0;for(s in o)m(o[s])!==m(l[s])&&(r=!1,t.reportRevAPIException("Mismatch Legacy and RevAPI change plan preview data",{property:s,revAPIValue:l[s],legacyAPIValue:o[s],scheduledUserPlanID:e,chosenPlanID:a}))}t.recordRevAPIConsistencyStats(r,c.GET_CHANGE_PLAN_PREVIEW)},t.isAccountPaymentInfoResult=function(e){return Boolean(e&&"AccountPaymentInfoResult"===e.__typename)},t.convertLegacyPaymentInfo=function(e){if(e){var t,a="unknown"===e.account?null:e.account.slice(-4),n=!0,i=null;switch(e.gateway_id){case l.BRAINTREE:t=r.AccountPaymentInfoType.Card,i=e.type;break;case l.ADYEN_SEPA_GATEWAY:t=r.AccountPaymentInfoType.Sepa;break;case l.ADYEN_IDEAL_GATEWAY:t=r.AccountPaymentInfoType.Ideal;break;case l.PAYPAL_REFERENCE_TRANSACTION:t=r.AccountPaymentInfoType.Paypal,a=null;break;default:t=r.AccountPaymentInfoType.Unknown,n=!1}return{active_payment_method_type:t,last_digits:a,vat_country_code:e.country_code,can_update_payment_method_via_web_storefront:n,credit_type:i}}},t.filterRevAPIPaymentInfo=function(e){return{active_payment_method_type:e.active_payment_method_type,last_digits:e.last_digits,vat_country_code:e.vat_country_code,can_update_payment_method_via_web_storefront:e.can_update_payment_method_via_web_storefront,credit_type:e.credit_type}},t.comparePaymentInfo=function(e,a){var i=t.filterRevAPIPaymentInfo(e),o=n.isEqual(a,i);if(!o){var l=void 0;for(l in a)a[l]!==i[l]&&t.reportRevAPIException("Mismatch Legacy and RevAPI payment info",{property:l,revAPIValue:i[l],legacyAPIValue:a[l]})}t.recordRevAPIConsistencyStats(o,c.GET_PAYMENT_INFO)},t.isAccountCurrentPlanResult=function(e){return Boolean(e&&"AccountCurrentPlanResult"===e.__typename)},t.convertLegacyCurrentPlan=function(e){var t=null==e?void 0:e.subState;if(e&&t){var n=t.plan;if(n){var i=g(n);return a.__assign(a.__assign({},i),{contract_interval_end:t.formattedNextBillingDate,total_addon_offerings:[]})}}},t.filterRevAPICurrentPlan=function(e){e.__typename,e.advertised_space_long_rounded;var t=a.__rest(e,["__typename","advertised_space_long_rounded"]);return a.__assign(a.__assign({},t),{total_addon_offerings:[]})},t.compareCurrentPlan=function(e,a){var i=t.filterRevAPICurrentPlan(e),o=n.isEqual(a,i);if(!o){var l=void 0;for(l in a){var r=m(a[l]),s=m(i[l]);n.isEqual(r,s)||t.reportRevAPIException("Mismatch Legacy and RevAPI current plan info",{property:l,revAPIValue:s,legacyAPIValue:r})}}t.recordRevAPIConsistencyStats(o,c.GET_CURRENT_PLAN)},t.isAccountScheduledPlanResult=function(e){return Boolean(e&&"AccountScheduledPlanResult"===e.__typename)},t.convertLegacyScheduledPlan=function(e,t){var n,i=null==e?void 0:e.scheduledSubState,o=null==e?void 0:e.subState;if(e&&i&&o){var l=i.plan;if(l){var r=g(l),d=null===(n=e.nextBillingSummary)||void 0===n?void 0:n.total;return a.__assign(a.__assign({},r),{total_addon_offerings:[],scheduled_downgrade_to_basic:t,upcoming_billing_date:o.formattedNextBillingDate,upcoming_billing_total_amount:d?s.Cash.format(d):"NO TOTAL PROVIDED"})}}},t.filterRevAPIScheduledPlan=function(e){e.__typename;var t=a.__rest(e,["__typename"]);return a.__assign(a.__assign({},t),{total_addon_offerings:[]})},t.compareScheduledPlan=function(e,a){var i=t.filterRevAPIScheduledPlan(e),o=n.isEqual(a,i);if(!o){var l=void 0;for(l in a){var r=m(a[l]),s=m(i[l]);n.isEqual(r,s)||t.reportRevAPIException("Mismatch Legacy and RevAPI scheduled plan info",{property:l,revAPIValue:s,legacyAPIValue:r})}}t.recordRevAPIConsistencyStats(o,c.GET_SCHEDULED_PLAN)};var g=function(e){return{advertised_space_short_tb:e.formattedSpecQuotaGb||"",contract_length_quantity:1,contract_length_unit:e.scheduleDescription.toUpperCase(),dropbox_brand_display_name:e.displayUntranslatableNameDirectFromSku,offering_id:e.code,product_family:t.legacyProductTypeToProductFamily(e.productFamily,e.productType)}}})),define("modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons",["require","exports","tslib","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","react"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompareRevApiScheduledPlan=t.CompareRevApiCurrentPlan=t.CompareRevApiChangePlanPreview=t.CompareRevApiAvailablePlans=t.CompareRevApiPaymentInfo=void 0,t.CompareRevApiPaymentInfo=function(e){var t=n.useGetAccountPaymentInfoQuery(),a=t.loading,l=t.error,r=t.data;return o.useEffect((function(){var t=r&&r.account_payment_info&&i.isAccountPaymentInfoResult(r.account_payment_info)?r.account_payment_info:void 0;if(l)return i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_PAYMENT_INFO),void i.reportRevAPIException("Error loading payment info",{error:l});!a&&t&&e.legacyPaymentInfo&&i.comparePaymentInfo(t,e.legacyPaymentInfo)}),[a,e.legacyPaymentInfo]),null},t.CompareRevApiAvailablePlans=function(e){var t=n.useGetAccountAvailablePlansQuery({variables:{filter_product_family:e.filterProductFamily,filter_contract_length:e.filterContractLength}}),l=t.loading,r=t.error,s=t.data,d={context:e.context,userUpcomingPlanID:e.upcomingPlanId};return o.useEffect((function(){var t=s&&s.account_available_plans&&i.isAccountAvailablePlansResult(s.account_available_plans)?s.account_available_plans:void 0;if(r)return i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),void i.reportRevAPIException("Error loading available plans data",a.__assign({error:r},d));!l&&t&&e.legacyAvailablePlans&&(t.available_plans?i.compareAvailablePlansData(t.available_plans,e.legacyAvailablePlans,d):(i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_AVAILABLE_PLANS),i.reportRevAPIException("Available plans list not provided",a.__assign({error:r},d))))}),[l,e.legacyAvailablePlans]),null},t.CompareRevApiChangePlanPreview=function(e){var t=n.useGetAccountChangePlanPreviewQuery({variables:{offering_id:e.offeringId,vat_id:e.vatId}}),a=t.loading,l=t.error,r=t.data;return o.useEffect((function(){var t=r&&r.account_change_plan_preview&&i.isAccountChangePlanPreviewResult(r.account_change_plan_preview)?r.account_change_plan_preview:void 0;if(l)return i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_CHANGE_PLAN_PREVIEW),void i.reportRevAPIException("Error loading change plan preview data",{error:l});!a&&t&&e.legacyChangePlanPreviewData&&i.compareChangePlanPreviewData(e.scheduledPlanID,e.offeringId,t,e.legacyChangePlanPreviewData)}),[a,e.legacyChangePlanPreviewData]),null},t.CompareRevApiCurrentPlan=function(e){var t=n.useGetAccountCurrentPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}}),a=t.loading,l=t.error,r=t.data;return o.useEffect((function(){var t=r&&r.account_current_plan&&i.isAccountCurrentPlanResult(r.account_current_plan)?r.account_current_plan:void 0;if(l)return i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_CURRENT_PLAN),void i.reportRevAPIException("Error loading current plan ",{error:l});!a&&t&&e.legacyCurrentPlanInfo&&i.compareCurrentPlan(t,e.legacyCurrentPlanInfo)}),[a,e.legacyCurrentPlanInfo]),null},t.CompareRevApiScheduledPlan=function(e){var t=n.useGetAccountScheduledPlanQuery({variables:{should_hide_pricing_info:e.shouldHidePricingInfo}}),a=t.loading,l=t.error,r=t.data;return o.useEffect((function(){var t=r&&r.account_scheduled_plan&&i.isAccountScheduledPlanResult(r.account_scheduled_plan)?r.account_scheduled_plan:void 0;if(l)return i.recordRevAPIConsistencyStats(!1,i.PersonalPlanManagementRoutes.GET_SCHEDULED_PLAN),void i.reportRevAPIException("Error loading scheduled plan",{error:l});!a&&t&&e.legacyScheduledPlanInfo&&i.compareScheduledPlan(t,e.legacyScheduledPlanInfo)}),[a,e.legacyScheduledPlanInfo]),null}})),define("modules/clean/account_page/widgets/plan/strings",["require","exports","modules/core/i18n","modules/clean/payments/skus/constants"],(function(e,t,a,n){"use strict";function i(e){return e.purchased?e.is_unlimited_evh?a.intl.formatMessage({id:"y3dl6B",defaultMessage:"unlimited version history"}):a.intl.formatMessage({id:"9fMG6q",defaultMessage:"extended version history"}):""}Object.defineProperty(t,"__esModule",{value:!0}),t.getPaidPlanNameWithAddOns=t.getLockedTeamPlanName=void 0,t.getLockedTeamPlanName=function(e,t){var n=e?a.intl.formatMessage({id:"h2UqcJ",defaultMessage:"(team downgraded)"}):a.intl.formatMessage({id:"LGoRkl",defaultMessage:"(trial ended)"});return a.intl.formatMessage({id:"3onAtc",defaultMessage:"{plan_name} {downgraded_text}"},{plan_name:t,downgraded_text:n})},t.getPaidPlanNameWithAddOns=function(e,t,o,l){var r,s;return 1024===e.specQuotaGb||e.productFamily===n.ProductFamily.FAMILY?(r=e.displayName(!1,!1,l),s=a.intl.formatMessage({id:"Trr3KV",defaultMessage:"Dropbox {plan}"},{plan:r})):s=e.displayName(!0),t.purchased&&!(o&&t.scheduled_to_remove)&&(s=a.intl.formatMessage({id:"AGrwzr",defaultMessage:"{plan} + {addon}"},{plan:s,addon:i(t)})),s}})),define("modules/clean/account_page/widgets/plan/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformPlanTransition=void 0,(function(e){e[e.MONTHLY=1]="MONTHLY",e[e.YEARLY=2]="YEARLY",e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL",e[e.ADD_EVH=5]="ADD_EVH",e[e.REMOVE_EVH=6]="REMOVE_EVH",e[e.FAMILY_PAYER=7]="FAMILY_PAYER",e[e.BACKUP=8]="BACKUP",e[e.HS_DBX_PRO_BUNDLE=9]="HS_DBX_PRO_BUNDLE"})(t.PerformPlanTransition||(t.PerformPlanTransition={}))})),define("modules/clean/account_page/widgets/plan/views/add_schedule_modal",["require","exports","tslib","react","classnames","modules/clean/analytics","modules/clean/account_page/util","modules/clean/payments/skus/constants","modules/clean/react/css","spectrum/button","dig-components/modal","modules/clean/react/modal","dig-components/typography","modules/clean/static_urls","modules/core/i18n","modules/clean/react/payments/checkout/components/inputs/labeled_checkbox_input","modules/core/notify","modules/clean/react/growth/trials/requests","modules/clean/react/growth/logging_util","modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddScheduleModalView=void 0,n=a.__importDefault(n),i=a.__importDefault(i),u=a.__importStar(u);var b=(function(e){function t(t){var a=e.call(this,t)||this;return a.closeModals=function(){a.setState({isOpen:!1})},a.onTermsCheck=function(){a.setState({displayTermsErrorMsg:!1,termsChecked:!a.state.termsChecked})},a.onAccept=function(){var e=a.props,t=e.project,n=e.userId,i=e.skuCode,l=e.billingId,r=a.state,s=r.trialPriceConversions,d=r.finalBillingScheduleId;if(r.termsChecked){var c={trial_sku_code:i,conversion_token:s[d].conversion_token,billing_id:l.toString()};a.setState({submitting:!0}),o.ProEventsLogger.log("add_schedule_modal_accept",{scheduleId:d,advertised_monthly_price:s[d].advertised_monthly_price,advertised_yearly_price:s[d].advertised_yearly_price,currency:s[d].currency,total_amount:s[d].total_amount,project:t}),h.enableAutoConvert(n,t,y.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,c,(function(){_.Notify.success(g.intl.formatMessage({id:"RNIIJ0",defaultMessage:"You’ve added your billing period!"})),a.props.transitionPerformed&&a.props.transitionPerformed(),a.doneSubmittingRequest(),a.closeModals()}),(function(){_.Notify.error(g.intl.formatMessage({id:"OXfp6E",defaultMessage:"There was an error adding the billing period!"})),a.doneSubmittingRequest(),a.closeModals()}))}else a.setState({displayTermsErrorMsg:!0})},a.changeProductScheduleType=function(e){a.setState({finalBillingScheduleId:e})},a.getTermsErrorString=function(){var e=a.state.displayTermsErrorMsg,t=g.intl.formatMessage({id:"a2NBnL",defaultMessage:"Please agree to the terms of service."});return e?t:""},a.onDismissModal=function(){o.ProEventsLogger.log("add_schedule_modal_dismiss",{project:a.props.project}),a.closeModals()},a.state={displayTermsErrorMsg:!1,finalBillingScheduleId:r.ScheduleId.YEARLY,loadingContent:!0,submitting:!1,termsChecked:!1,trialPriceConversions:{},type:"",isOpen:!0},a}return a.__extends(t,e),t.showInstance=function(e){u.Modal.showInstance(n.default.createElement(t.AddScheduleModal,a.__assign({},e)))},t.prototype.componentDidMount=function(){this.loadPlanTransitions()},t.prototype.loadPlanTransitions=function(){var e=this,t=this.props,a=t.project,n=t.productType,i=t.userId,o={trial_sku_code:t.skuCode,trial_duration:t.duration,schedule_ids:[r.ScheduleId.MONTHLY,r.ScheduleId.YEARLY]};h.getPriceConversionsForSchedule(i,a,y.ComponentName.TRIAL_ENABLE_AUTO_CONVERT_MODAL,o,(function(t){if(t){var a=t.trial_price_conversions;a[r.ScheduleId.MONTHLY]&&a[r.ScheduleId.YEARLY]||(_.Notify.error(g.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.closeModals()),e.setState({loadingContent:!1,type:n,trialPriceConversions:a})}}),(function(){_.Notify.error(g.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.closeModals()}))},t.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},Object.defineProperty(t.prototype,"scheduleTransitionText",{get:function(){var e=this.state,t=e.trialPriceConversions,a=e.finalBillingScheduleId,i=t[a.toString()],o=a===r.ScheduleId.MONTHLY?"month":"year",s=g.intl.formatMessage({id:"OUUNz7",defaultMessage:"I agree to the <link>Dropbox Terms</link> and the <strong>Automatic Renewal Terms</strong> above"},{link:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"zmINZ0",defaultMessage:"terms"}),className:"terms-info__tos--terms-link",href:"#",key:"link_dbx",onClick:l.logClickAndOpenTab("de_terms_link_click","/terms",{from:"add_schedule_modal"})},e)},strong:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.default.createElement("strong",null,e)}}),d=n.default.createElement("span",null,s);return n.default.createElement("div",null,n.default.createElement("span",{className:"change-summary"},g.intl.formatMessage({id:"38ZvV3",defaultMessage:"Purchase summary"})),n.default.createElement("p",{className:"plan-transition"},g.intl.formatMessage({id:"Ufvtdi",defaultMessage:"Your trial ends on {date}. If you don’t <cancelLink>cancel</cancelLink> your free trial by that date, we’ll charge you {scheduled_total} per {schedule} (including applicable taxes) until you cancel your plan. If you have any charges after your trial, they <refundLink>won’t be refunded</refundLink> when you <downgradeLink>cancel</downgradeLink>, <legalLink>unless it’s legally required</legalLink>. All amounts shown are in {currency}."},{date:i.formatted_trial_end_date,schedule:o,scheduled_total:i.total_amount,currency:i.currency,strong:function(e){return n.default.createElement("strong",null,e)},cancelLink:function(e){return n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"lGpNw6",defaultMessage:"CancelLink"}),href:"#",onClick:l.logClickAndOpenTab("de_cancel_link_click","/help/accounts-billing/cancellations-refunds/cancel-free-trial",{from:"add_schedule_modal"})},e)},refundLink:function(e){return n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"WSrUNs",defaultMessage:"RefundLink"}),href:"#",onClick:l.logClickAndOpenTab("de_refund_link_click","/terms",{from:"add_schedule_modal"})},e)},downgradeLink:function(e){return n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"zuLHeg",defaultMessage:"DowngradeLink"}),href:"#",onClick:l.logClickAndOpenTab("de_downgrade_link_click","/help/accounts-billing/cancellations-refunds/downgrade-dropbox-plus-professional-plans",{from:"add_schedule_modal"})},e)},legalLink:function(e){return n.default.createElement("a",{"aria-label":g.intl.formatMessage({id:"enHZxv",defaultMessage:"LegalLink"}),href:"#",onClick:l.logClickAndOpenTab("de_legal_link_click","/help/accounts-billing/payments-billing/refund",{from:"add_schedule_modal"})},e)}})),n.default.createElement(f.LabeledCheckboxInput,{checked:this.state.termsChecked,onChange:this.onTermsCheck,labelText:d,name:"terms-checkbox",className:"billing-terms-and-service",errorText:this.getTermsErrorString()}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.state,t=e.loadingContent,a=e.submitting;return t||a},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this.state,a=t.loadingContent,o=t.trialPriceConversions,l=t.finalBillingScheduleId,r=t.type,s=g.intl.formatMessage({id:"nRgwkK",defaultMessage:"Step 2/2: choose your billing period"});e=a?n.default.createElement("div",{className:"loading-indicator"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:g.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})})):n.default.createElement("div",null,n.default.createElement("div",null,n.default.createElement(v.NptBillingScheduleItems,{trialPriceConversions:o,finalBillingScheduleId:l,planName:r,changeProductScheduleType:this.changeProductScheduleType})),n.default.createElement("div",{className:"plan-footer u-font-meta"},this.scheduleTransitionText));var f=i.default("change-plan-modal");return n.default.createElement(c.Modal,{overlayClassName:f,open:this.state.isOpen,isCentered:!0,withCloseButton:g.intl.formatMessage({id:"11bV9n",defaultMessage:"Cancel"}),shouldCloseOnOverlayClick:!1,onRequestClose:this.onDismissModal,onAfterClose:u.Modal.close},n.default.createElement(c.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(p.Title,{isBold:!1,size:"small"},s)),n.default.createElement(c.Modal.Body,{hasVerticalSpacing:!0},e),n.default.createElement(c.Modal.Footer,{hasTopBorder:!0},n.default.createElement(d.Button,{variant:"secondary",onClick:this.onDismissModal},g.intl.formatMessage({id:"dqvpHx",defaultMessage:"Cancel"})),n.default.createElement(d.Button,{className:"confirm-purchase-button",disabled:this.acceptButtonDisabled,variant:"primary",onClick:this.onAccept},g.intl.formatMessage({id:"/w1aTc",defaultMessage:"Confirm purchase"}))))},t.AddScheduleModal=s.requireCssWithComponent(t,["/static/css/teams/admin/widgets/add_schedule_modal/add_schedule_modal-vflzjyX-t.css"]),t})(n.default.Component);t.AddScheduleModalView=b})),define("modules/clean/account_page/widgets/plan/views/basic_plan_status",["require","exports","tslib","react","modules/core/browser","styled-components","modules/core/i18n","modules/clean/static_urls","modules/clean/analytics","modules/constants/trademark","dig-components/typography","dig-components/buttons","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicPlanStatusSection=void 0,n=a.__importDefault(n),i=a.__importStar(i),o=a.__importDefault(o);var _,h,y,v,b,P,S=f.hql_events.TaxonomyAppSurface.AppSurface,M=f.hql_events.TaxonomyActionSurface.ActionSurface,C=o.default.div(_||(_=a.__makeTemplateObject(["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"],["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"]))),E=o.default.div(h||(h=a.__makeTemplateObject(["\n  width: 36px;\n  margin: var(--spacing__unit--2) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"],["\n  width: 36px;\n  margin: var(--spacing__unit--2) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"]))),T=o.default.div(y||(y=a.__makeTemplateObject(["\n  display: flex;\n  padding: 36px 0;\n  border-bottom: 1px solid $color_stone_sixteen;\n"],["\n  display: flex;\n  padding: 36px 0;\n  border-bottom: 1px solid $color_stone_sixteen;\n"]))),w=o.default.div(v||(v=a.__makeTemplateObject(["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"],["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"]))),A=o.default(c.Title)(b||(b=a.__makeTemplateObject(["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"],["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"]))),I=o.default(u.Button)(P||(P=a.__makeTemplateObject(["\n  .plan-status-section__link--inline {\n    font-style: italic;\n  }\n"],["\n  .plan-status-section__link--inline {\n    font-style: italic;\n  }\n"])));t.BasicPlanStatusSection=function(e){var t=e.planName,a=void 0===t?d.DROPBOX_BASIC:t,o=e.plansUrl,c=void 0===o?"/plans?oqa=acc_general_upgrade":o,_=e.limitedTeam,h=e.hidePlansLink,y=e.hideUpgradeButton,v=e.upgradePlanButton;return v||(v=n.default.createElement(C,{className:"plan-status-section__upgrade_btn"},n.default.createElement(u.Button,{variant:"primary",size:"standard",role:"link",onClick:function(){var e;e=g.hql_events.HQLEventIdentity.create({eventClass:g.hql_events.HQLEventIdentity.EventClass.create({className:f.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:g.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_general_tab_upgrade_to_plus_click"}),actionEventId:g.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:f.hql_events.TaxonomyAction.Action.SELECT})}),p.logEvent(m.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:g.hql_events.HQLMetadata.create({appSurface:S.WEB,actionSurface:M.CENTER_PANE_GENERAL_TAB,identityOverride:e})})),s.ProEventsLogger.log("de_general_tab_upgrade_to_plus_click",{},(function(){i.redirect("/upgrade?oqa=acc_general_upgrade")}))},className:"jest-upgrade-plan-button"},l.intl.formatMessage({id:"7/M9u2",defaultMessage:"Upgrade"})))),n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{className:"plan-status-section__infohead"},l.intl.formatMessage({id:"7Fz7qP",defaultMessage:"Current plan"})),n.default.createElement(T,{className:"plan-status-section has-no-border"},n.default.createElement(E,{className:"plan-status-section__icon"},n.default.createElement("img",{src:r.static_url("/static/images/logo_catalog/dropbox-business-icon_m1_v2-vflfKjGis.svg"),alt:l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"})})),n.default.createElement(w,{className:"plan-status-section__description"},n.default.createElement(A,{size:"small",isBold:!0,className:"plan-status-section__title"},a),_,!h&&n.default.createElement(I,{size:"small",className:"plan-status-section__link",variant:"transparent",onClick:function(){i.open_tab(c)},role:"link"},l.intl.formatMessage({id:"ORB1Kv",defaultMessage:"See other plans"}))),!y&&v))}})),define("modules/clean/account_page/widgets/plan/views/cancel_changes_modal",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/constants","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_service","modules/constants/trademark","modules/core/i18n","modules/clean/dbmodal_stack","modules/clean/account_page/util","modules/core/notify","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/api_v2/user_client","modules/clean/payments/skus/billing_schedule","modules/core/exception","modules/clean/account_page/widgets/plan/views/loading_view","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P){"use strict";var S;Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmationView=void 0,n=a.__importDefault(n),i=a.__importStar(i),(function(e){e[e.NeverLoaded=0]="NeverLoaded",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"})(S||(S={}));var M=new Set([d.ProductFamily.PRO,d.ProductFamily.FAMILY]),C=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.cancellationType;a.cancelScheduledChange(e)},a.closeModals=function(){var e=a.props.onClose;e&&e(),a.setState({open:!1})},a.handleWrongPlanError=function(e,t){v.reportException({err:new Error("Current user plan (id: "+e+", family: "+t+") is invalid for cancel_changes_modal"),severity:v.SEVERITY.CRITICAL})},a.getDisplayName=function(e,t){if(e&&t){if(M.has(t))return d.productPlanTypeToIndividualDisplayName(e);if(t===d.ProductFamily.TEAM)return d.productPlanTypeToBusinessDisplayName(e,t)}return a.handleWrongPlanError(e,t),""},a.loadDowngradeInfo=function(){a.setState({loadingDowngradeInfo:S.Loading}),(new h.UserApiV2Client).ns("growth").rpc("get_cancel_changes_info",void 0,{subjectUserId:g.getCurrentUser().id}).then((function(e){a.setState({loadingDowngradeInfo:S.Ready,downgradeInfo:{subState:e.sub_state,finalSubState:e.final_sub_state}})})).catch((function(){f.Notify.error(p.intl.formatMessage({id:"yhOAKQ",defaultMessage:"There was an issue cancelling your changes, please contact Customer Support."})),v.reportException({err:new Error("get_cancel_changes_info call failed for user attempting to cancel changes of type: "+a.props.cancellationType),severity:v.SEVERITY.CRITICAL}),a.modalLogger.logModalError("modal_init"),a.closeModals()}))},new c.SubscriptionService,a.state={loadingDowngradeInfo:S.NeverLoaded,submitting:!1,open:!0},a.modalLogger=P.getSubscriptionAMPLogger({ns:"personal",modal:P.ModalTypes.CANCEL_CHANGES_MODAL}),a}return a.__extends(t,e),t.showInstance=function(e){r.Modal.showInstance(n.default.createElement(t,a.__assign({},e)))},t.prototype.componentDidMount=function(){this.loadDowngradeInfo()},Object.defineProperty(t.prototype,"currentProductPlanType",{get:function(){var e,t;return null===(t=null===(e=this.state.downgradeInfo)||void 0===e?void 0:e.subState.product_plan_type)||void 0===t?void 0:t.toString()},enumerable:!1,configurable:!0}),t.prototype.submittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!0})}))},t.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},t.prototype.cancelScheduledChange=function(e){var t=this,a=this.props.transitionPerformed,n=this.state.downgradeInfo;if(n){var r=n.subState,d=n.finalSubState;this.modalLogger.setProductPlanType(this.currentProductPlanType),this.submittingRequest();var c=y.getScheduleDescriptionAdjective(r.schedule_id),u=y.getScheduleDescriptionAdjective(d.schedule_id);i.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:e},subject_user:g.getCurrentUser().id,success:function(n){f.Notify.success(p.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),e===l.CancellationType.SCHEDULE&&(s.ProEventsLogger.log("de_change_billing_cancel_change"),s.ProEventsLogger.log("scheduled_billing_change_prompt_click_confirmed",{cta:"cancel_change_confirm",currentBillingSchedule:c,nextBillingSchedule:u})),e===l.CancellationType.EVH_ADDON&&s.ProEventsLogger.log("de_evh_modal_cancel_change"),e===l.CancellationType.PLAN&&s.ProEventsLogger.log("scheduled_plan_change_prompt_click_confirmed",{cta:"cancel_change_confirm"}),t.modalLogger.logModalSuccess(),a&&a(),t.doneSubmittingRequest(),t.closeModals(),t.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(o.CHANGE_IND_PLAN_MODAL_UPDATED,null)},error:function(){f.Notify.error(p.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),t.modalLogger.logModalError("modal_submit"),t.doneSubmittingRequest(),t.closeModals(),t.props.reOpenModalDialogAfterCancellation&&m.DBModalStack.trigger(o.CHANGE_IND_PLAN_MODAL_UPDATED,null)}})}},t.prototype.render=function(){var e=this.props.cancellationType,t=this.state,a=t.open,i=t.submitting,o=t.downgradeInfo;if(t.loadingDowngradeInfo!==S.Ready||!o)return n.default.createElement(b.LoadingView,{className:"cancel_changes_modal__loading-indicator"});var r,s=o.subState,c=o.finalSubState,m=y.getScheduleDescriptionAdjective(c.schedule_id),g=this.getDisplayName(s.product_plan_type,s.product_family),f=this.getDisplayName(c.product_plan_type,c.product_family),h=p.intl.formatMessage({id:"G4ktGR",defaultMessage:"Confirm cancelling change"});switch(e){case l.CancellationType.PLAN:r=c.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"1VHHGq",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{trademark_plus:u.TRADEMARK_PLUS,plan:g,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}}):p.intl.formatMessage({id:"hOx+lQ",defaultMessage:"You’re cancelling your scheduled plan change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{trademark_plus:u.TRADEMARK_PLUS,plan:g,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.SCHEDULE:r=s.schedule_id===d.ScheduleId.YEARLY?p.intl.formatMessage({id:"U+lU7/",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed yearly."},{plan:f,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}}):p.intl.formatMessage({id:"AtC6hy",defaultMessage:"You’re cancelling your scheduled billing change. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed monthly."},{plan:f,date:s.next_billing_date,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.EVH_ADDON:r=p.intl.formatMessage({id:"0zw1l2",defaultMessage:"You’re cancelling your EVH changes. Your Dropbox {plan} plan will renew on <strong>{date}</strong> and you will be billed {schedule}."},{plan:f,date:s.next_billing_date,schedule:m,strong:function(e){return n.default.createElement("strong",null,e)}});break;case l.CancellationType.IND_SUBSCRIPTION:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"ikAVu1",defaultMessage:"By confirming, your downgrade to Dropbox Basic will be cancelled."});break;case l.CancellationType.ALL:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"AmEj2/",defaultMessage:"By confirming, all existing scheduled changes will be cancelled."});break;default:h=p.intl.formatMessage({id:"NCTtwj",defaultMessage:"Confirmation"}),r=p.intl.formatMessage({id:"kMZoFx",defaultMessage:"By confirming, the scheduled change will be cancelled."})}var v=p.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),P=p.intl.formatMessage({id:"7VYYNS",defaultMessage:"Don’t cancel"});return n.default.createElement(_.ChangeConfirmationModal,{acceptButtonDisabled:i,acceptButtonText:v,description:r,dismissButtonText:P,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:a,submitting:i,title:h})},t})(n.default.Component);t.CancelChangesModalConfirmationView=C})),define("modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","react","modules/core/i18n","modules/clean/payments/skus/constants","modules/clean/account_page/util","modules/clean/account_page/constants","modules/clean/react/modal","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancelChangesModalConfirmation=void 0,n=a.__importStar(n);var m=(function(e){function t(t){var a=e.call(this,t)||this;return a.closeModals=function(){a.setState({open:!1}),c.Modal.close()},a.onAccept=function(){var e=a.props,t=e.planType,n=e.onAccept;t===r.ProductPlanType.HS_DBX_PRO_BUNDLE?a.closeModals():a.cancelScheduledChange(),n&&n()},a.state={submitting:!1,open:!0},a}return a.__extends(t,e),t.showInstance=function(e){c.Modal.showInstance(o.default.createElement(t,a.__assign({},e)))},t.prototype.submittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!0})}))},t.prototype.doneSubmittingRequest=function(){this.setState((function(e){return a.__assign(a.__assign({},e),{submitting:!1})}))},t.prototype.cancelScheduledChange=function(){var e,t,a,o=this,r=this.props,c=r.transitionPerformed,u=r.userIdOverride,m=p.getSubscriptionAMPLogger({ns:"personal",modal:p.ModalTypes.CANCEL_SUBS_WARNING_MODAL,productPlanType:null===(a=null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()}),g=null;g=u||s.getCurrentUser().id,this.submittingRequest(),n.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:d.CancellationType.IND_SUBSCRIPTION},subject_user:g,success:function(e){i.Notify.success(l.intl.formatMessage({id:"dC654w",defaultMessage:"You’ve cancelled your change!"})),c&&c(),m.logModalSuccess(),o.doneSubmittingRequest(),o.closeModals()},error:function(){i.Notify.error(l.intl.formatMessage({id:"iQ7Rjk",defaultMessage:"Failed to cancel changes."})),m.logModalError("modal_submit"),o.doneSubmittingRequest(),o.closeModals()}})},t.prototype.render=function(){var e=this.props,t=e.planType,a=e.subStatus,n=this.state,i=n.submitting,s=n.open;if(!a)return o.default.createElement("noscript",null);var d=(function(e){if(e===r.ProductPlanType.SYNC_EVERYTHING)return{title:l.intl.formatMessage({id:"yOnuCE",defaultMessage:"All set."}),getDescription:function(e){return l.intl.formatMessage({id:"muP0dn",defaultMessage:"You’ll have access to your plan until <strong>{date}</strong>. After that, your backup will remain available but it’ll be limited to the 2 GB storage quota of the Dropbox Basic plan. If you exceed your quota, automatic backups will stop."},{date:e,strong:function(e){return o.default.createElement("strong",null,e)}})},acceptButtonText:l.intl.formatMessage({id:"bGzf4A",defaultMessage:"I changed my mind, keep Backup"}),dismissButtonText:l.intl.formatMessage({id:"eyC1rP",defaultMessage:"Close"})};if(e===r.ProductPlanType.HS_DBX_PRO_BUNDLE)return{title:l.intl.formatMessage({id:"RQS9wP",defaultMessage:"Are you sure you want to cancel?"}),getDescription:function(e,t){var a=t.dropboxDisplayName,n=t.spaceShortFormTb;return l.intl.formatMessage({id:"w/CLLG",defaultMessage:"If you cancel today, you’ll be moved to a free plan on <strong>{date}</strong>, and you’ll lose access to {current_plan} features including:{br}<ul><li>{space_quota} of Dropbox space</li><li>Unlimited eSignatures</li><li>Any saved templates</li></ul>"},{br:o.default.createElement("br",null),current_plan:a,date:e,li:function(e){return o.default.createElement("li",{style:{marginBottom:"var(--spacing__unit--1)"}},e)},strong:function(e){return o.default.createElement("strong",null,e)},space_quota:n,ul:function(e){return o.default.createElement("ul",{style:{paddingLeft:0,listStylePosition:"inside"}},e)}})},acceptButtonText:l.intl.formatMessage({id:"1wtgq1",defaultMessage:"Confirm cancel"}),dismissButtonText:l.intl.formatMessage({id:"ZyFp/R",defaultMessage:"Don’t cancel"})};return{title:l.intl.formatMessage({id:"Au8OeU",defaultMessage:"Plan downgrade scheduled"}),getDescription:function(e){return l.intl.formatMessage({id:"tQTXOk",defaultMessage:"Your plan is scheduled to be downgraded to Dropbox Basic on <strong>{date}</strong>. If you want to make any changes, first cancel your scheduled downgrade."},{date:e,strong:function(e){return o.default.createElement("strong",null,e)}})},acceptButtonText:l.intl.formatMessage({id:"vhlPqJ",defaultMessage:"Cancel downgrade"}),dismissButtonText:l.intl.formatMessage({id:"DYOfu0",defaultMessage:"Dismiss"})}})(t),c=d.title,p=d.getDescription,m=d.acceptButtonText,g=d.dismissButtonText,f=a.subState.formattedNextBillingDate,_=(function(e){var t,a,n,i,o=(null===(a=null===(t=e.subState.plan)||void 0===t?void 0:t.content)||void 0===a?void 0:a.dropboxDisplayName())||"",l=(null===(i=null===(n=e.subState.plan)||void 0===n?void 0:n.content)||void 0===i?void 0:i.spaceShortFormTb())||"";return{dropboxDisplayName:o,spaceShortFormTb:l}})(a);return o.default.createElement(u.ChangeConfirmationModal,{acceptButtonDisabled:i,acceptButtonText:m,description:p(f,_),dismissButtonText:g,loadingContent:!1,onAccept:this.onAccept,onDismiss:this.closeModals,open:s,submitting:i,title:c})},t})((o=a.__importDefault(o)).default.Component);t.CancelChangesModalConfirmation=m})),define("modules/clean/account_page/widgets/plan/views/cancellable_notifications_view",["require","exports","tslib","react","react-dom-factories","styled-components","modules/clean/react/css","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/teams/admin/widgets/billing_notifications/cancellable_item","modules/clean/account_page/constants","modules/clean/payments/skus/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/analytics","modules/clean/api_v2/user_client","modules/clean/account_page/util","modules/clean/ts_utils"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableNotificationsView=t.CancellableNotificationsViewControl=void 0,n=a.__importDefault(n),i=a.__importDefault(i);var y,v=(o=a.__importDefault(o)).default.div(y||(y=a.__makeTemplateObject(["\n  border-bottom: 1px solid var(--color__faint__background);\n"],["\n  border-bottom: 1px solid var(--color__faint__background);\n"]))),b=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.getFamilyPayerScheduledChange=function(e){(new f.UserApiV2Client).ns("growth_plans").rpc("get_scheduled_change_family_manager",void 0,{subjectUserId:_.getCurrentUser().id}).then((function(a){t.setState({payerHasScheduledDowngrade:a.has_scheduled_plan_change,payerScheduledChangeDate:a.scheduled_change_date},e)}))},t.handleCancelSubscriptionAction=function(){t.handleCancelActions(c.CancellationType.IND_SUBSCRIPTION)},t.handleCancelPlanAction=function(){t.shouldLogScheduledProToPlusChange()&&g.ProEventsLogger.log("scheduled_plan_change_prompt_click",{cta:"cancel_change"}),t.handleCancelActions(c.CancellationType.PLAN)},t.handleCancelScheduleAction=function(){t.shouldLogScheduledBillingChange()&&g.ProEventsLogger.log("scheduled_billing_change_prompt_click",{cta:"cancel_change",currentBillingSchedule:t.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:t.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"}),t.handleCancelActions(c.CancellationType.SCHEDULE)},t.handleCancelEvhAction=function(){t.handleCancelActions(c.CancellationType.EVH_ADDON)},t.handleCancelActions=function(e){var a=t.props,n=a.subStatus,i=a.transitionPerformed,o=a.reOpenModalDialogAfterCancellation;n&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:i,cancellationType:e,reOpenModalDialogAfterCancellation:o})},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e,t,a=this;(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&this.getFamilyPayerScheduledChange((function(){a.shouldLogScheduledFamilyMemberDowngradePrompt()&&g.ProEventsLogger.log("scheduled_family_member_downgrade_prompt_view")})),this.shouldLogScheduledProToPlusChange()&&g.ProEventsLogger.log("scheduled_plan_change_prompt_view"),this.shouldLogScheduledBillingChange()&&g.ProEventsLogger.log("scheduled_billing_change_prompt_view",{currentBillingSchedule:this.props.subStatus.subState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly",nextBillingSchedule:this.props.subStatus.scheduledSubState.billingSchedule.id===u.ScheduleId.MONTHLY?"monthly":"yearly"})},t.prototype.shouldDisplayFamilyPayersScheduledChange=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===u.ProductPlanType.FAMILY_NONPAYER&&!0===this.state.payerHasScheduledDowngrade&&void 0!==this.state.payerScheduledChangeDate},t.prototype.renderCancelSubscriptionNotification=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t)return a?n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:r.intl.formatMessage({id:"Ai+Hmi",defaultMessage:"Dropbox Basic"}),handleAction:this.handleCancelSubscriptionAction,useCTA:!0}):void 0},t.prototype.shouldRenderDowngradePlanNotif=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(!t||a)return!1;var n=t.scheduledSubState;if(!n)return!1;var i=t.subState.plan,o=n.plan;return!(!i||!o)&&(i.productType!==o.productType||i.productType===o.productType&&i.productSpec!==o.productSpec)},t.prototype.shouldRenderBillingChangeNotif=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(!t||a)return!1;var n=t.scheduledSubState;return!!(n&&n.billingSchedule&&t.subState.billingSchedule)&&t.subState.billingSchedule.id!==n.billingSchedule.id},t.prototype.shouldLogScheduledProToPlusChange=function(){if(this.shouldRenderDowngradePlanNotif()){var e=this.props.subStatus.subState.plan,t=this.props.subStatus.scheduledSubState.plan;return e.productType===u.ProductPlanType.PROFESSIONAL&&t.productType===u.ProductPlanType.PLUS}return!1},t.prototype.shouldLogScheduledBillingChange=function(){return this.shouldRenderBillingChangeNotif()},t.prototype.shouldLogScheduledFamilyMemberDowngradePrompt=function(){return this.shouldDisplayFamilyPayersScheduledChange()},t.prototype.renderDowngradePlanNotification=function(){if(this.shouldRenderDowngradePlanNotif()){var e=this.props.subStatus.scheduledSubState.plan,t=r.intl.formatMessage({id:"McVRyL",defaultMessage:"Dropbox {scheduled_plan}"},{scheduled_plan:e.displayName()});return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"4c06XP",defaultMessage:"Scheduled plan change"}),description:t,handleAction:this.handleCancelPlanAction,useCTA:!0,className:"cancel-plan-schedule"})}},t.prototype.renderFamilyMemberScheduledChange=function(){if(this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"27UqZZ",defaultMessage:"Your plan will change from {dropbox_family} to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,dropbox_basic:p.DROPBOX_BASIC}),className:"cancel-plan-schedule"})},t.prototype.renderScheduledChange=function(){if(this.shouldRenderBillingChangeNotif()){var e=this.props.subStatus.scheduledSubState.billingSchedule.scheduleDescriptionAdjective;return n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"pSiFZ2",defaultMessage:"Scheduled billing period"}),description:r.intl.formatMessage({id:"HCfuYu",defaultMessage:"{billing} billing"},{billing:e.charAt(0).toUpperCase()+e.slice(1)}),handleAction:this.handleCancelScheduleAction,useCTA:!0,className:"cancel-billing-schedule"})}},t.prototype.renderEvhChange=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t&&!a){var i=t.scheduledSubState;if(i)return t.subState.addons.skus.length>0&&1===t.subState.quantityForEvhAddOn()&&0===i.quantityForEvhAddOn()?n.default.createElement(d.CancellableItemView,{title:r.intl.formatMessage({id:"3YA4ZU",defaultMessage:"Scheduled add-on change"}),description:r.intl.formatMessage({id:"ruwa4d",defaultMessage:"Remove extended version history"}),handleAction:this.handleCancelEvhAction,useCTA:!0,className:"cancel-evh-schedule"}):void 0}},t.prototype.appendAllCancellationTypes=function(e){e.push(this.renderCancelSubscriptionNotification()),e.push(this.renderDowngradePlanNotification()),e.push(this.renderScheduledChange()),e.push(this.renderEvhChange())},t.prototype.render=function(){var e=this.props,t=e.displaySingleChangeCancellationItem,a=e.scheduledForDowngrade,o=e.subStatus,l=e.paymentInfo,d=e.hasLicenseKey,p=e.displayNewTotal;if(!o)return n.default.createElement("noscript",null);if(!l||s.shouldHideBillingChange(l.gateway_id,l.is_reseller_billing))return n.default.createElement("noscript",null);var m=[];if(a&&!this.shouldDisplayFamilyPayersScheduledChange())return n.default.createElement("noscript",null);if(t)switch(t){case c.CancellationType.IND_SUBSCRIPTION:m.push(this.renderCancelSubscriptionNotification());break;case c.CancellationType.PLAN:m.push(this.renderDowngradePlanNotification());break;case c.CancellationType.SCHEDULE:m.push(this.renderScheduledChange());break;case c.CancellationType.EVH_ADDON:m.push(this.renderEvhChange());break;case c.CancellationType.FAMILY_NONPAYER:m.push(this.renderFamilyMemberScheduledChange());break;case c.CancellationType.ALL:this.appendAllCancellationTypes(m);break;case c.CancellationType.LICENSES:break;default:h.enforceExhaustive(t)}if(!(m=m.filter((function(e){return void 0!==e}))).length)return n.default.createElement("noscript",null);var g="";a||!p||this.shouldDisplayFamilyPayersScheduledChange()||(g=r.intl.formatMessage({id:"BunHhw",defaultMessage:"Your new {schedule} total will be {total}."},{schedule:u.productScheduleToProductScheduleDescription(o.finalSubState.plan.schedule),total:o.nextBillingSummary.total.toString()}));var f=this.shouldDisplayFamilyPayersScheduledChange()?this.state.payerScheduledChangeDate:o.subState.formattedNextBillingDate,_=n.default.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__header"},r.intl.formatMessage({id:"/3HS66",defaultMessage:"Changes are scheduled for <strong>{date}</strong>."},{date:f,strong:function(e){return i.default.strong({},e)}})," ",g);return n.default.createElement(v,{className:"cancellable-scheduled-notifications personal-cancellable-scheduled-notifications"},_,!d&&n.default.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__items"},m))},t})(n.default.Component);t.CancellableNotificationsViewControl=b,t.CancellableNotificationsView=l.requireCssWithComponent(b,["/static/css/teams/admin/widgets/billing_notifications/cancellable_scheduled_notifications-vflOSF7qX.css"])})),define("modules/clean/account_page/widgets/plan/views/change_confirmation_modal",["require","exports","tslib","react","styled-components","spectrum/modal","dig-components/buttons","modules/core/i18n","modules/clean/static_urls","dig-components/typography"],(function(e,t,a,n,i,o,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeConfirmationModal=void 0,n=a.__importDefault(n);var c,u,p,m,g,f,_,h,y=(i=a.__importDefault(i)).default(o.Modal)(c||(c=a.__makeTemplateObject(["\n  color: var(--color__standard__text);\n  display: flex;\n  flex-direction: column;\n  font-size: var(--type__body__standard--fontsize);\n  border-radius: 0;\n"],["\n  color: var(--color__standard__text);\n  display: flex;\n  flex-direction: column;\n  font-size: var(--type__body__standard--fontsize);\n  border-radius: 0;\n"]))),v=i.default.div(u||(u=a.__makeTemplateObject(["\n  font-family: var(--type__body__standard--fontfamily);\n  padding: var(--spacing__unit--3);\n"],["\n  font-family: var(--type__body__standard--fontfamily);\n  padding: var(--spacing__unit--3);\n"]))),b=i.default(d.Title)(p||(p=a.__makeTemplateObject(["\n  font-family: var(--type__title__small--fontfamily);\n  font-size: var(--type__title__small--fontsize);\n  font-weight: var(--type__title__small--fontweight_strong);\n  margin-bottom: var(--spacing__unit--3);\n"],["\n  font-family: var(--type__title__small--fontfamily);\n  font-size: var(--type__title__small--fontsize);\n  font-weight: var(--type__title__small--fontweight_strong);\n  margin-bottom: var(--spacing__unit--3);\n"]))),P=i.default.div(m||(m=a.__makeTemplateObject(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 65px;\n  padding-left: var(--spacing__unit--3);\n  padding-right: var(--spacing__unit--3);\n"],["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 65px;\n  padding-left: var(--spacing__unit--3);\n  padding-right: var(--spacing__unit--3);\n"]))),S=i.default.div(g||(g=a.__makeTemplateObject(["\n  white-space: nowrap;\n"],["\n  white-space: nowrap;\n"]))),M=i.default(l.Button)(f||(f=a.__makeTemplateObject(["\n  min-height: var(--spacing__unit--4);\n  height: auto;\n  white-space: normal;\n"],["\n  min-height: var(--spacing__unit--4);\n  height: auto;\n  white-space: normal;\n"]))),C=i.default(l.Button)(_||(_=a.__makeTemplateObject(["\n  min-height: var(--spacing__unit--4);\n  height: auto;\n  white-space: normal;\n  margin-left: var(--spacing__base_unit);\n"],["\n  min-height: var(--spacing__unit--4);\n  height: auto;\n  white-space: normal;\n  margin-left: var(--spacing__base_unit);\n"]))),E=i.default.div(h||(h=a.__makeTemplateObject(["\n  display: flex;\n  justify-content: center;\n  padding: 100px;\n"],["\n  display: flex;\n  justify-content: center;\n  padding: 100px;\n"]))),T=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){t.props.onAccept()},t.handleDismiss=function(){t.props.onDismiss()},t}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props,a=t.acceptButtonDisabled,i=t.acceptButtonText,o=t.description,l=t.dismissButtonText,c=t.loadingContent,u=t.open,p=t.link,m=t.title,g=t.submitting;return e=c?n.default.createElement(E,{className:"change-confirmation-modal__loading-indicator"},n.default.createElement("img",{src:s.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"60HSB/",defaultMessage:"Loading"})})):n.default.createElement("div",{className:"change-confirmation-modal"},n.default.createElement(v,null,n.default.createElement(b,{className:"change-confirmation-modal__title"},m),n.default.createElement(d.Text,{className:"change-confirmation-modal__description"},o)),n.default.createElement(P,null,n.default.createElement(S,null,p),n.default.createElement("div",null,n.default.createElement(M,{className:"change-confirmation-modal__btn-cancel",variant:"opacity",disabled:g,onClick:this.handleDismiss},l),n.default.createElement(C,{className:"change-confirmation-modal__btn-submit",variant:"primary",disabled:a,onClick:this.handleAccept},i)))),n.default.createElement(y,{appElement:document.getElementById("embedded-app")||document.body,ariaLabel:r.intl.formatMessage({id:"qgM6UX",defaultMessage:"Change Confirmation Modal"}),className:"ChangeConfirmationModal",displayCloseButton:!l,onRequestClose:this.handleDismiss,open:u,overlayClickClose:!1,width:560},e)},t})(n.default.Component);t.ChangeConfirmationModal=T})),define("modules/clean/account_page/widgets/plan/views/change_plan_modal",["require","exports","tslib","modules/core/browser","modules/core/notify","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/css","modules/clean/react/badge","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/account_page/widgets/plan/constants","modules/constants/individual_invoice_modal","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/views/plus_to_family_modal","modules/clean/payments/validation","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/account_page/constants","modules/clean/payments/cash","modules/clean/payments/skus/catalog_sku","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_status","modules/core/i18n","modules/clean/account_page/util","modules/clean/react/browse/uri_helper","modules/clean/static_urls","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/payments/three_ds_helper","modules/clean/family/constants","modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal","modules/clean/payments/skus/sku_content","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary","apiql/client/components/account-gql","@apollo/react-hooks","apollo-client","modules/clean/account_page/widgets/plan/api","modules/clean/display_format","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","modules/clean/account_page/widgets/plan/types"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P,S,M,C,E,T,w,A,I,x,L,N,k,D,B,R,O,F,U,q,j,Y,V,H,G,z,W,K){"use strict";var Q,X;Object.defineProperty(t,"__esModule",{value:!0}),t.ChangePlanModalView=t.ChangePlanOrigin=t.ChangePlanMode=void 0,n=a.__importStar(n),o=a.__importDefault(o),l=a.__importStar(l),(function(e){e.DEFAULT="default",e.CONFIRM="confirm"})(Q=t.ChangePlanMode||(t.ChangePlanMode={})),(function(e){e.DEFAULT="default",e.PLUS_TO_FAMILY="plus_to_family"})(X=t.ChangePlanOrigin||(t.ChangePlanOrigin={}));var Z=(function(e){function t(r){var s=e.call(this,r)||this;return s._isMounted=null,s._timeModalOpened=null,s._loggedRevAPIChangePlanPreviews={},s.setLoggedRevAPIChangePlanPreviews=function(e){e.forEach((function(e){return s._loggedRevAPIChangePlanPreviews[e.code]=!1}))},s.onLoadTransitionsError=function(){i.Notify.error(T.intl.formatMessage({id:"HcIX4g",defaultMessage:"Failed to load modal."})),s.modalLogger.logModalError("modal_init"),s.closeModals()},s.logChangePlan=function(e,t,n){var i=s.state.subStatus;i&&i.subState.billingSchedule&&(M.ProEventsLogger.log("change_plan_modal_change_plan",a.__assign({from_product_plan_type:C.ProductPlanType[e],to_product_plan_type:C.ProductPlanType[t]},n)),s.modalLogger.logModalSuccess())},s.onChangePlanConfirmation=function(){var e,a,n=s.state,i=n.subStatus,o=n.basicSkuQuotaGb,l=s.getChosenSku();(null===(a=null===(e=null==i?void 0:i.subState)||void 0===e?void 0:e.plan)||void 0===a?void 0:a.productType)===C.ProductPlanType.FAMILY_PAYER&&(null==l?void 0:l.productType)!==C.ProductPlanType.FAMILY_PAYER&&o?(b.DBModalStack.register(O.FAMILY_DISBAND_MODAL_GO_BACK,(function(){t.showInstance(s.props)})),O.showDisbandModal({confirmChangePlan:s.onAccept,basicSkuQuotaGb:o,displayFamilyRoomCheckbox:s.state.displayFamilyRoomCheckbox})):s.onAccept()},s.onAccept=function(e,t){var a,o=s.state.subStatus;if(null==o?void 0:o.subState.plan){var r,d=s.getChosenSku(),c=null===(a=null==o?void 0:o.subState.plan)||void 0===a?void 0:a.productType,u=null==d?void 0:d.productType;switch(u){case C.ProductPlanType.PLUS:case C.ProductPlanType.STANDARD:r=K.PerformPlanTransition.PLUS;break;case C.ProductPlanType.PROFESSIONAL:r=K.PerformPlanTransition.PROFESSIONAL;break;case C.ProductPlanType.FAMILY_PAYER:r=K.PerformPlanTransition.FAMILY_PAYER;break;case C.ProductPlanType.SYNC_EVERYTHING:r=K.PerformPlanTransition.BACKUP;break;case C.ProductPlanType.HS_DBX_PRO_BUNDLE:r=K.PerformPlanTransition.HS_DBX_PRO_BUNDLE}s.setState((function(e){return{showErrors:!0}}));var p=s.state,m=p.vat,g=p.accountPaymentInfo,f=p.threeDsData,_=p.handle3DsMessage,h=p.shouldShowPlusToFamilyModal;if((null==g?void 0:g.vat_country_code)&&s.vatValidator(g.vat_country_code,m))if(r&&c&&u){s.setState((function(e){return{submitting:!0}})),M.ProEventsLogger.log("de_change_plan_modal_confirm_change_click",t);var y={transition_change_type:r,browser_info:B.collectBrowserInfo(),three_ds_data:f};s.updateThreeDsData(""),m&&(y.vat=m,M.ProEventsLogger.log("vat_provided_on_upgrade",t)),l.WebRequest({url:"/account/perform_personal_transition",data:y,subject_user:s.getUserId(),success:function(e){var a=JSON.parse(e);if(a.redirect)return n.redirect(a.redirect);i.Notify.success(T.intl.formatMessage({id:"zpOY3S",defaultMessage:"You’ve changed your plan!"})),s.removeShowModalParams(),s.logChangePlan(c,u,t),s.props.transitionPerformed&&s.props.transitionPerformed();var o=U.isPlanChangeUpgrade(c,u);return(null==d?void 0:d.productType)===C.ProductPlanType.PROFESSIONAL&&o?n.redirect("/professional_onboarding"):(null==d?void 0:d.productType)===C.ProductPlanType.FAMILY_PAYER?h?n.redirect(R.FAMILY_INVITE_URI_PATH_SUCCESS):n.redirect(R.FAMILY_INVITE_URI_PATH):(document.dispatchEvent(new Event("db:change_plan_modal:plan_changed")),void s.closeModals())},error:function(t,a,n){e&&e(),s.setState((function(e){return{submitting:!1}}));var o=!1,l=null;try{l=JSON.parse(n)}catch(e){}finally{_&&l&&(o=!0,_(l))}o?s.modalLogger.logModalError("3ds"):(i.Notify.error(T.intl.formatMessage({id:"PMSOip",defaultMessage:"There was an error changing the plan!"})),s.modalLogger.logModalError("modal_submit"))}})}else i.Notify.error(T.intl.formatMessage({id:"WDKLwG",defaultMessage:"There was an error changing the plan!"}))}},s.updateThreeDsData=function(e){s.setState({threeDsData:e})},s.onDismiss=function(){M.ProEventsLogger.log("de_change_plan_modal_cancel_click")},s.closeModals=function(){S.Modal.close()},s.renderVat=function(){var e=null;if(!s.vatDisplayEnabled)return e;var t=s.state,a=t.vat,n=t.accountPaymentInfo,i=t.showErrors,l=null==n?void 0:n.vat_country_code;if(l){var r=f.getVatPrefix(l),d=T.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:f.getVatExamples(l).join(", ")});e=o.default.createElement(x.ArborTextInput,{className:"jest-vat-input",name:"vat",placeholderText:r,labelText:T.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"}),isValid:!i||s.vatValidator(l,a),errorText:d,value:a,onChange:s.onVatChange})}return e},s.onVatChange=function(e,t,a){var n=a;s.setState((function(e){return{vat:n,showErrors:!1}}))},s.renderPaymentMethod=function(){var e=s.state.accountPaymentInfo;if(!s.isPlanScheduledToChange())return o.default.createElement("div",{className:"upgrade-payment-method-link"},o.default.createElement(P.IndividualInlinePaymentMethodView,{accountPaymentInfo:e,paymentErrorMessage:T.intl.formatMessage({id:"qWYni+",defaultMessage:"Please update your billing information to change your plan."}),renderUpdateLink:o.default.createElement(D.UpdateBillingInfoLink,{updateBillingCTA:s.updateBillingInfo})}))},s.updateBillingInfo=function(e){e.stopPropagation(),e.preventDefault(),M.ProEventsLogger.log("de_update_billing_info_click"),s.showUpdateBillingModal()},s.showUpdateBillingModal=function(){S.Modal.close(),b.DBModalStack.register(k.BILLING_INFO_UPDATED,(function(){V.resetApolloStore(),t.showInstance(s.props)})),s.props.browserUpdateRequired?L.BrowserUpdateModalLoader.showInstance():N.IndividualUpdateBillingModalLoader.showInstance()},s.handleCancelScheduleAction=function(e){s.handleCancelActions(h.CancellationType.SCHEDULE),e.preventDefault()},s.handleCancelActions=function(e){var t=s.state.subStatus,a=s.props.transitionPerformed;return t&&m.CancelChangesModalConfirmationView.showInstance({transitionPerformed:a,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},s.transitionPerformedClosure=function(e){if(s.props.transitionPerformed)return s.props.transitionPerformed()},s.state={loadingContent:!0,submitting:!1,type:C.ProductPlanType.STANDARD,showErrors:!1,vat:""},s.modalLogger=G.getSubscriptionAMPLogger({ns:"personal",modal:G.ModalTypes.CHANGE_PLAN_MODAL}),s}return a.__extends(t,e),t.prototype.getUrlOption=function(e){var t=e,a=n.get_href().match(/option=([a-zA-Z_]*)/);if(a&&a.length>1){var i=a[1];"plus"===i&&(t=e===C.ProductPlanType.PROFESSIONAL?C.ProductPlanType.PLUS:e),"pro"===i&&(t=C.ProductPlanType.PROFESSIONAL),"family"===i&&(t=C.ProductPlanType.FAMILY_PAYER)}return t},t.showInstance=function(e){S.Modal.showInstance(o.default.createElement(t.ChangePlanModal,a.__assign({},e)))},t.prototype.componentDidMount=function(){this._isMounted=!0,this._timeModalOpened=Date.now(),this.loadPlanTransitions()},t.prototype.componentWillUnmount=function(){this._isMounted=!1},Object.defineProperty(t.prototype,"productTypeStr",{get:function(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()},enumerable:!1,configurable:!0}),t.prototype.logTTI=function(){if(this._timeModalOpened){var e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}},t.prototype.retrieveViewModel=function(e,t,a){var n=this,i=a?{vat:a}:void 0;l.WebRequest({url:"/account/ajax_change_plan",data:i,subject_user:this.getUserId(),success:function(t){var a=JSON.parse(t);n._isMounted&&(M.ProEventsLogger.log("change_plan_modal_available_plans_data_loaded"),e(a))},error:t})},t.prototype.onLoadPlanTransitions=function(e){var t=this;this.setState((function(a){var n,o=E.SubscriptionStatus.deserialize(e.serializedSubStatus),l=z.convertLegacyPaymentInfo(e.paymentMethod);l.active_payment_method_type===q.AccountPaymentInfoType.Card&&(n=new B.ThreeDsHandler({updateThreeDsData:t.updateThreeDsData,submitThreeDsChallenge:t.onAccept,triggerThreeDsChallenge:function(){},submitThreeDsFingerprint:t.onAccept,triggerThreeDsFingerprint:function(){},isDesktop:!1,isSeleniumChangesTest:!1}).handle3DsMessage);var r=o.finalSubState;if(!r.billingSchedule||!r.plan)throw"A base plan is required, in order to change it.";var s=t.getUrlOption(o.subState.plan.productType),d=o.subState.planSku.productType===C.ProductPlanType.PLUS||o.subState.planSku.productType===C.ProductPlanType.STANDARD,c=e.availablePlans.map((function(e){return v.CatalogSku.deserialize(e)})),u=c.concat([o.finalSubState.planSku]);u.every((function(e){return e.productType!==s}))&&(s=o.subState.plan.productType);var p=!1;t.props.origin===X.PLUS_TO_FAMILY&&((p=g.shouldShowPlusToFamilyModal(d,u,e.expPlusToFamilyUpsellVariant))?s=C.ProductPlanType.FAMILY_PAYER:i.Notify.error(T.intl.formatMessage({id:"lBd15f",defaultMessage:"You cannot change plans at this time."})));var m=new F.QuotaFormatter(e.basicSkuQuotaGb),f=e.growthRevapiPaPlanManagementCompareData;return t.setLoggedRevAPIChangePlanPreviews(c),{loadingContent:!1,subStatus:o,accountPaymentInfo:l,type:s,handle3DsMessage:n,basicSkuQuotaGb:m.spaceShortFormGb(),shouldShowPlusToFamilyModal:p,availablePlans:c,allSubSkus:u,growthRevapiPaPlanManagementCompareData:f,displayFamilyRoomCheckbox:e.displayFamilyRoomCheckbox}}),this.logTTI)},t.prototype.loadPlanTransitions=function(){var e=this;this.retrieveViewModel((function(t){e.onLoadPlanTransitions(t)}),this.onLoadTransitionsError)},t.prototype.getUserId=function(){return this.props.userIdOverride?this.props.userIdOverride:w.getCurrentUser().id},t.prototype.getChosenSku=function(){var e=this;if(this.state.allSubSkus)return this.state.allSubSkus.filter((function(t){return t.productType===e.state.type})).pop()},t.prototype.getChosenSkuCode=function(){var e=this.getChosenSku();return e?e.code:""},Object.defineProperty(t.prototype,"finalPlanType",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.plan&&e.finalSubState.plan.productType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasTypeChanged",{get:function(){return this.finalPlanType&&this.finalPlanType!==this.state.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentPlanChanged",{get:function(){return this.hasTypeChanged},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:C.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),t.prototype.removeShowModalParams=function(){var e=n.get_href().match(/modal=([a-zA-Z_]*)/);e&&e.length>1&&("plan"===e[1]&&window.history.replaceState({},document.title,n.get_href().split("?")[0]))},t.prototype.changeProductPlan=function(e){this.setState((function(t){return{type:e}}))},t.prototype.getPlanDescription=function(e){var t=e.content&&e.content.spaceShortFormTb();switch(e.productType){case C.ProductPlanType.STANDARD:case C.ProductPlanType.PLUS:return t?T.intl.formatMessage({id:"gK4PxX",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile, and {plan_space} storage."},{plan_space:t}):T.intl.formatMessage({id:"/Jj95M",defaultMessage:"Smart Sync, stress-free sharing, offline folders on mobile."});case C.ProductPlanType.HS_DBX_PRO_BUNDLE:return T.intl.formatMessage({id:"IXOQ0a",defaultMessage:"Includes Dropbox Pro and unlimited e-signatures with HelloSign Essentials."});case C.ProductPlanType.PROFESSIONAL:return t?T.intl.formatMessage({id:"Muci4i",defaultMessage:"Everything in Plus, shared link controls, and {plan_space} storage."},{plan_space:t}):T.intl.formatMessage({id:"wULqRj",defaultMessage:"Everything in Plus, with shared link controls."},{plan_space:t});case C.ProductPlanType.FAMILY_PAYER:return T.intl.formatMessage({id:"9Ru4ky",defaultMessage:"{count, plural, one{Up to {count} member, easy family sharing, and {plan_space} storage.} other{Up to {count} members, easy family sharing, and {plan_space} storage.}}"},{count:R.MAX_LICENSES,plan_space:t});case C.ProductPlanType.TRANSFER:return T.intl.formatMessage({id:"4k1fvl",defaultMessage:"Send transfers up to {transfer_send_size_limit} at a time with password protection and customized experiences."},{transfer_send_size_limit:H.format_bytes(100*h.GIGABYTE_IN_BYTES,2,!0,!0,!1)});case C.ProductPlanType.SYNC_EVERYTHING:return T.intl.formatMessage({id:"ACkjCJ",defaultMessage:"Automatic backup and recovery protection for one device."});case C.ProductPlanType.PASSWORDS:return T.intl.formatMessage({id:"CGyvlS",defaultMessage:"Securely store unlimited passwords and access them wherever."})}return""},t.prototype.changeProductPlanClosure=function(e){var t=this;return function(){t.changeProductPlan(e)}},t.prototype.renderPlanItems=function(){var e=this,t=this.state,a=t.type,n=t.allSubSkus,i=t.subStatus,l=[C.ProductPlanType.STANDARD,C.ProductPlanType.PLUS,C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.FAMILY_PAYER,C.ProductPlanType.HS_DBX_PRO_BUNDLE];if(n&&i&&i.subState.billingSchedule&&i.subState.plan&&i.subState.planSku&&i.finalSubState.plan&&i.finalSubState.planSku&&i.scheduledSubState&&i.scheduledSubState.billingSchedule)return n.sort((function(e,t){return e.productType&&t.productType?l.indexOf(e.productType)-l.indexOf(t.productType):0})).map((function(t){if(t&&t.billingSchedule){var n,l,r=!1,d=i.isOnTrial?i.finalSubState.plan:i.subState.plan;d&&t.productType===d.productType&&(n=T.intl.formatMessage({id:"dhdo+T",defaultMessage:"(current plan)"}),r=!0);var u=t.productType!==C.ProductPlanType.FAMILY_PAYER&&t.productType!==C.ProductPlanType.HS_DBX_PRO_BUNDLE;t.productType===C.ProductPlanType.TRANSFER||(null==d?void 0:d.productType)===C.ProductPlanType.TRANSFER?l=o.default.createElement("span",null,o.default.createElement("br",null),o.default.createElement("a",{href:"/transfer/plans",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"Vu1ffz",defaultMessage:"See plan details"}))):t.productType===C.ProductPlanType.SYNC_EVERYTHING?l=o.default.createElement("span",null,o.default.createElement("br",null),o.default.createElement("a",{href:"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"qSkDre",defaultMessage:"See plan details"}))):t.productType===C.ProductPlanType.PASSWORDS?l=o.default.createElement("span",null,o.default.createElement("br",null),o.default.createElement("a",{href:"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-passwords-plan",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"oHpGsH",defaultMessage:"See plan details"}))):u&&(l=o.default.createElement("span",null,o.default.createElement("br",null),o.default.createElement("a",{href:"/plans",target:"_blank",rel:"noreferrer noopener"},T.intl.formatMessage({id:"wo0qrl",defaultMessage:"See plan details"}))));var p=T.intl.formatMessage({id:"q0DZmp",defaultMessage:"Dropbox {plan_name}"},{plan_name:t.displayName()}),m=void 0;e.props.mode===Q.CONFIRM&&t.productType===C.ProductPlanType.PROFESSIONAL&&(m={variant:s.BadgeVariant.NEW,color:s.BadgeColor.NEON_GREEN});var g=d&&t.productType===d.productType?e.getPlanDescription(d):e.getPlanDescription(t);return o.default.createElement(q.GetAccountDeprecatedPlanChangePreviewComponent,{key:t.code,skip:r,variables:{vat:e.vatID,sku_code:t.code,country_override:A.getQueryArgs().country_override}},(function(i){var s,d=i.loading,u=null===(s=i.data)||void 0===s?void 0:s.account_deprecated_plan_change_preview,f=(null==u?void 0:u.formatted_base_price)?null==u?void 0:u.formatted_base_price:t.displayCost.toString();return o.default.createElement(c.AdminPricedListItem,{className:"test-plan-item-"+t.productType+" "+(r?"test-current-plan-item":""),key:t.code,isSelected:a===t.productType,title:p,titleWarningText:void 0,titleSecondaryText:n,description:g,detailsLink:l,loadingPrice:d,priceString:f,unit:t.billingSchedule.id===C.ScheduleId.MONTHLY?T.intl.formatMessage({id:"YRatzw",defaultMessage:"per month"}):T.intl.formatMessage({id:"4Wu5r9",defaultMessage:"per year"}),onClick:e.changeProductPlanClosure(t.productType),disableItem:e.isPlanScheduledToChange(),badge:m})}))}}))},t.prototype.renderBillingSection=function(){return o.default.createElement("div",null,o.default.createElement(d.AdminPricedList,null,this.renderPlanItems()),this.renderVat())},t.prototype.vatValidator=function(e,t){return!t||f.validateVat(e,t)},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.state.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isPlanScheduledToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isBillingScheduleToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.getPlanNameWithEvhText=function(e){var t=this.state.subStatus;return t&&t.scheduledSubState&&t.scheduledSubState.quantityForEvhAddOn()>0?e+" "+T.intl.formatMessage({id:"NsQt0k",defaultMessage:"+ extended version history"}):e},t.prototype.renderScheduleTransitionText=function(e){var t=this.state.subStatus;if(t&&t.subState.plan){var a,n=o.default.createElement("a",{href:"#",onClick:this.handleCancelScheduleAction},T.intl.formatMessage({id:"e+rwVi",defaultMessage:"Cancel change"}));if(this.isPlanScheduledToChange())return o.default.createElement("span",{className:"plan-transition"},T.intl.formatMessage({id:"5eLA6l",defaultMessage:"You’ve already requested a change to your plan. If you want to choose a different plan or billing period, first cancel your pending change."})," ",n);if(!this.hasTypeChanged&&t.currentBillingSummary){var i=t.scheduledSubState,l=t.nextBillingSummary,r=t.subState,s=t.currentBillingSummary;a=this.isScheduledToChange()?T.intl.formatMessage({id:"EkFAkT",defaultMessage:"Starting on {date}, we’ll bill you once a {schedule_noun} for your Dropbox {plan}. Your new {schedule} total will be {scheduled_total}."},{plan:this.getPlanNameWithEvhText(i.plan.displayName()),date:r.formattedNextBillingDate,schedule:i.billingSchedule.scheduleDescriptionAdjective,schedule_noun:i.billingSchedule.scheduleDescriptionNoun,scheduled_total:y.Cash.formatWithTaxLabels(l.total,l),strong:function(e){return o.default.createElement("strong",null,e)}}):T.intl.formatMessage({id:"H2ofu+",defaultMessage:"Your Dropbox {plan} plan will renew on {date}. Your current {schedule} total is {recurring_total}."},{plan:this.getPlanNameWithEvhText(r.plan.displayName()),schedule:r.billingSchedule.scheduleDescriptionAdjective,recurring_total:y.Cash.formatWithTaxLabels(s.total,s),date:r.formattedNextBillingDate})}if(this.hasTypeChanged&&e){var d=w.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),c=w.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"});a=o.default.createElement(U.ChangePlanPreviewSummary,{subChangePreview:e,onClickCancel:d,onClickLegal:c,currentSku:t.subState.planSku,chosenSku:this.getChosenSku(),chosenSkuName:this.getPlanNameWithEvhText(this.getChosenSku().displayName())})}return a?o.default.createElement("div",null,e||this.isScheduledToChange()?o.default.createElement("span",{className:"change-summary"},T.intl.formatMessage({id:"eSqPLW",defaultMessage:"Change summary"})):null,o.default.createElement("p",{className:"plan-transition"},a)):void 0}},t.prototype.renderChangeFooter=function(e,t){var a;return t===Y.NetworkStatus.loading||t===Y.NetworkStatus.setVariables?o.default.createElement("div",{className:"loading-indicator"},o.default.createElement("img",{src:I.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:T.intl.formatMessage({id:"QNTZp/",defaultMessage:"Loading"})})):t===Y.NetworkStatus.error?(this.modalLogger.logModalError("change_preview"),o.default.createElement("div",{className:"loading-indicator"},T.intl.formatMessage({id:"EUUBQX",defaultMessage:"There was an unexpected error. Please try again later or contact support."}))):(this.isPlanScheduledToChange()||(a=this.renderPaymentMethod()),o.default.createElement("div",{className:"plan-footer u-font-meta"},this.renderScheduleTransitionText(e),a))},t.prototype.acceptButtonDisabled=function(e){var t=this.state.accountPaymentInfo,a=this.state,n=a.loadingContent,i=a.submitting;return!(!n&&!i&&e&&t)||!this.hasUserSelectedDifferentPlan()},t.prototype.isValidVatCountry=function(){var e=this.state.accountPaymentInfo;return!!((null==e?void 0:e.vat_country_code)&&f.hasVat(e.vat_country_code))},Object.defineProperty(t.prototype,"vatID",{get:function(){var e=this.state,t=e.accountPaymentInfo,a=e.vat;return(null==t?void 0:t.vat_country_code)&&f.validateVat(t.vat_country_code,a)?a:""},enumerable:!1,configurable:!0}),t.prototype.shouldShowVatForPlan=function(e){return[C.ProductPlanType.PROFESSIONAL,C.ProductPlanType.TRANSFER,C.ProductPlanType.HS_DBX_PRO_BUNDLE].includes(e)},t.prototype.hasUserSelectedDifferentPlan=function(){return!this.isPlanScheduledToChange()&&this.hasTypeChanged},Object.defineProperty(t.prototype,"vatDisplayEnabled",{get:function(){var e=this.state,t=e.loadingContent,a=e.submitting;return!(!p.INDIVIDUAL_INVOICE_MODAL||t||a||!this.hasUserSelectedDifferentPlan()||!this.isValidVatCountry()||!this.finalPlanType||this.shouldShowVatForPlan(this.finalPlanType)||!this.shouldShowVatForPlan(this.state.type))},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,n=this.props,i=n.transitionPerformed,l=n.paymentInfo,r=n.mode,s=this.state,d=s.subStatus,c=s.loadingContent,p=s.submitting,m=s.type,f=s.vat,y=s.growthRevapiPaPlanManagementCompareData,v=s.accountPaymentInfo,P=s.availablePlans;return o.default.createElement(j.ApolloProvider,{client:V.getApolloClient()},y&&o.default.createElement(W.CompareRevApiAvailablePlans,{upcomingPlanId:d.finalSubState.planSku.code,legacyAvailablePlans:z.convertLegacyAvailablePlansData(P),filterContractLength:q.AccountPlanFilterArgument.SameAsScheduled,filterProductFamily:q.AccountPlanFilterArgument.DifferentThanScheduled,context:"change_plan_modal"}),y&&o.default.createElement(W.CompareRevApiPaymentInfo,{legacyPaymentInfo:v}),o.default.createElement(q.GetAccountDeprecatedPlanChangePreviewComponent,{skip:!this.hasTypeChanged,variables:{vat:this.vatID,sku_code:this.getChosenSkuCode()}},(function(n){var s,v=n.networkStatus,P=n.loading,M=!(n.loading||n.error),E=n.data&&n.data.account_deprecated_plan_change_preview?n.data.account_deprecated_plan_change_preview:void 0,w=z.convertLegacyChangePlanPreviewData(E),A=T.intl.formatMessage({id:"9q9Jhs",defaultMessage:"Change plan"}),x=T.intl.formatMessage({id:"5Dr7st",defaultMessage:"Cancel"}),L=T.intl.formatMessage({id:"X0xlzt",defaultMessage:"Confirm change"});if(c||e.state.shouldShowPlusToFamilyModal&&P)A="",L="",x="",s=o.default.createElement("div",{"data-testid":"loading-indicator",className:"loading-indicator"},o.default.createElement("div",{className:"loading-indicator__text"},T.intl.formatMessage({id:"IxHAnI",defaultMessage:"Loading account details..."})),o.default.createElement("img",{src:I.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:T.intl.formatMessage({id:"w1RdJ3",defaultMessage:"Loading"})}));else{var N=void 0;d&&i&&(b.DBModalStack.clear(),b.DBModalStack.register(u.CHANGE_IND_PLAN_MODAL_UPDATED,(function(){t.showInstance(a.__assign(a.__assign({},e.props),{transitionPerformed:e.transitionPerformedClosure}))})),N=o.default.createElement(_.CancellableNotificationsView,{subStatus:d,transitionPerformed:e.transitionPerformedClosure,displaySingleChangeCancellationItem:h.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:l,displayNewTotal:!1})),s=o.default.createElement("div",null,N,e.renderBillingSection(),e.renderChangeFooter(w,v)),r===Q.CONFIRM&&d&&(A=T.intl.formatMessage({id:"p+qbry",defaultMessage:"Confirm plan"}),d.finalSubState.plan.productType===m?(L=null,x=T.intl.formatMessage({id:"31Fc4k",defaultMessage:"Confirm"})):(L=T.intl.formatMessage({id:"/ifa0B",defaultMessage:"Upgrade plan"}),x=null))}var k=null;y&&!P&&w&&(k=o.default.createElement(W.CompareRevApiChangePlanPreview,{scheduledPlanID:d.finalSubState.planSku.code,offeringId:e.getChosenSkuCode(),vatId:e.vatID,legacyChangePlanPreviewData:w}));var D=e.state.allSubSkus&&e.state.allSubSkus.find((function(e){return e&&e.productType===C.ProductPlanType.FAMILY_PAYER}));return e.state.shouldShowPlusToFamilyModal&&e.state.subStatus&&D&&w&&e.state.accountPaymentInfo?o.default.createElement(o.default.Fragment,null,k,o.default.createElement(g.PlusToFamilyModal,{subStatus:e.state.subStatus,subChangePreview:w,familySku:D,accountPaymentInfo:e.state.accountPaymentInfo,acceptButtonDisabled:e.acceptButtonDisabled(M),onAccept:e.onAccept,submitting:p,onUpdateBillingInfo:e.showUpdateBillingModal,shouldShowVatInput:e.vatDisplayEnabled,onVatChange:e.onVatChange,vat:f})):o.default.createElement("div",{"data-testid":"change-plan-modal"},k,o.default.createElement(S.Modal,{acceptButtonDisabled:e.acceptButtonDisabled(M),acceptButtonText:L,className:"change-plan-modal",dismissButtonText:x,autoClose:!1,onAccept:e.onChangePlanConfirmation,onDismiss:e.onDismiss,submitting:p,title:A},s))})))},t.ChangePlanModal=r.requireCssWithComponent(t,["/static/css/teams/admin/widgets/change_plan_modal/change_plan_modal-vflR_dLwF.css"]),t})(o.default.Component);t.ChangePlanModalView=Z})),define("modules/clean/account_page/widgets/plan/views/change_plan_preview_summary",["require","exports","tslib","modules/core/i18n","react","modules/clean/account_page/widgets/plan/constants"],(function(e,t,a,n,i,o){"use strict";function l(e,t){var a=o.planTypeToUpgrades[e];return void 0!==a&&a.includes(t)}function r(e,t){return t?n.intl.formatMessage({id:"QebzyJ",defaultMessage:"{price} (taxes included)"},{price:e}):e}Object.defineProperty(t,"__esModule",{value:!0}),t.priceWithTaxLabel=t.isPlanChangeUpgrade=t.ChangePlanPreviewSummary=void 0,i=a.__importDefault(i),t.ChangePlanPreviewSummary=function(e){if(!e.chosenSku||!e.currentSku)return i.default.createElement("noscript",null);var t,a={plan:e.chosenSkuName,date:e.subChangePreview.upcoming_bill_date,prorated_price:r(e.subChangePreview.immediate_price||"",e.subChangePreview.tax_included_in_total_amount||!1),schedule_noun:e.chosenSku.billingSchedule.scheduleDescriptionNoun,schedule:e.chosenSku.billingSchedule.scheduleDescriptionAdjective,scheduled_total:r(e.subChangePreview.upcoming_bill_total_price||"",e.subChangePreview.tax_included_in_total_amount||!1),strong:function(e){return i.default.createElement("strong",null,e)},cancelLink:function(t){return i.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:e.onClickCancel},t)},legalLink:function(t){return i.default.createElement("a",{"aria-label":n.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:e.onClickLegal},t)}};return t=l(e.currentSku.productType,e.chosenSku.productType)?n.intl.formatMessage({id:"IYLgtU",defaultMessage:"You’re upgrading your plan to Dropbox {plan}. <strong>We’ll charge you {prorated_price} now</strong>, which is prorated for the current billing period. Starting on {date} and until you <cancelLink>cancel</cancelLink>, we’ll bill you once a {schedule_noun} and your new {schedule} total will be {scheduled_total}. If you cancel, previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a):n.intl.formatMessage({id:"f5t2Mw",defaultMessage:"Starting on {date}, your plan will be downgraded to Dropbox {plan} and your new {schedule} total will be {scheduled_total}. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},a),i.default.createElement("div",{className:"test-plan-transition-description"},t)},t.isPlanChangeUpgrade=l,t.priceWithTaxLabel=r})),define("modules/clean/account_page/widgets/plan/views/plus_to_family_modal",["require","exports","tslib","modules/core/exception","modules/core/browser","modules/core/i18n","modules/core/uri","react","modules/clean/account_page/util","modules/clean/react/modal","dig-components/typography","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/payments/skus/constants","modules/clean/family/constants","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/stormcrow/experiment","modules/clean/payments/skus/constants","modules/clean/payments/validation","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/analytics","modules/clean/account_page/widgets/plan/views/change_plan_preview_summary"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlusToFamilyModal=t.shouldShowPlusToFamilyModal=t.PLUS_TO_FAMILY_MODAL=void 0,n=a.__importStar(n),i=a.__importStar(i),r=a.__importDefault(r),t.PLUS_TO_FAMILY_MODAL="plus_to_family_modal",t.shouldShowPlusToFamilyModal=function(e,t,a){if(!e)return n.reportException({err:new Error("Plus to Family Modal only available to Plus users"),severity:"non-critical"}),!1;var i=a&&_.Experiment(a).isActive;if(!i)return n.reportException({err:new Error("Plus to Family Modal only available to gated users"),severity:"non-critical"}),!1;var o=1===t.filter((function(e){return e&&e.productType===h.ProductPlanType.FAMILY_PAYER})).length;return o?o&&i:(n.reportException({err:new Error("Family plan not available"),severity:"non-critical"}),!1)};var S=(function(e){function n(){var a=null!==e&&e.apply(this,arguments)||this;return a.onDismiss=function(){b.ProEventsLogger.log("de_change_plan_modal_cancel_click",{from:t.PLUS_TO_FAMILY_MODAL}),a.removeURIModalQueryParam()},a.onAccept=function(){a.props.onAccept(void 0,{from:t.PLUS_TO_FAMILY_MODAL})},a.updateBillingInfo=function(){b.ProEventsLogger.log("de_update_billing_info_click",{from:t.PLUS_TO_FAMILY_MODAL}),a.props.onUpdateBillingInfo()},a.renderVatInput=function(){var e=a.props,t=e.vat,n=e.accountPaymentInfo.vat_country_code;if(a.props.shouldShowVatInput&&n)return r.default.createElement(v.ArborTextInput,{name:"vat",placeholderText:y.getVatPrefix(n),labelText:o.intl.formatMessage({id:"jabE//",defaultMessage:"VAT number (optional)"}),isValid:y.validateVat(n,t),errorText:o.intl.formatMessage({id:"1dRSXy",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:y.getVatExamples(n).join(", ")}),value:t,onChange:a.props.onVatChange})},a}return a.__extends(n,e),n.prototype.removeURIModalQueryParam=function(){var e=i.get_href().match(/modal=(plus_to_family*)/);if(e&&e.length>1){var t=l.URI.parse(i.get_href()).removeQuery("modal");window.history.replaceState({},document.title,t.toString())}},n.prototype.getPlanComparisonText=function(){var e=this.props,t=e.subStatus,a=e.familySku,n=t.finalSubState.plan,i=n.displayCost.toString(),l=a.displayCost.toString();return n.billingSchedule.id===p.ScheduleId.MONTHLY?o.intl.formatMessage({id:"hNT7DA",defaultMessage:"{count, plural, one{{newCost}/month for up to {count} user ({currentPlan} is {currentCost}/month for 1 user)} other {{newCost}/month for up to {count} users ({currentPlan} is {currentCost}/month for 1 user)}}"},{currentPlan:n.displayName(),currentCost:i,newCost:l,count:m.MAX_LICENSES}):o.intl.formatMessage({id:"dlmjiM",defaultMessage:"{count, plural, one{{newCost}/year for up to {count} user ({currentPlan} is {currentCost}/year for 1 user)} other {{newCost}/year for up to {count} users ({currentPlan} is {currentCost}/year for 1 user)}}"},{currentPlan:n.displayName(),currentCost:i,newCost:l,count:m.MAX_LICENSES})},n.prototype.renderPlusToFamilyPlanUpsell=function(){var e=this.props,a=e.subStatus,n=e.familySku,i=a.finalSubState.plan,l=n.content&&n.content.spaceShortFormGbRounded();return r.default.createElement("div",{className:"test-plus-family-plan-modal__content"},r.default.createElement(c.Text,null,o.intl.formatMessage({id:"NI7W3i",defaultMessage:"{count, plural, one{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} member.} other{{familyPlan} includes the same features as Dropbox {currentPlan} (your current plan) for up to {count} members.}}"},{familyPlan:g.DROPBOX_FAMILY,currentPlan:i.displayName(),count:m.MAX_LICENSES})),r.default.createElement(c.Text,null,r.default.createElement("ul",null,r.default.createElement("li",null,this.getPlanComparisonText()),r.default.createElement("li",null,o.intl.formatMessage({id:"aE4CAA",defaultMessage:"Share {space} of encrypted cloud storage"},{space:l})),r.default.createElement("li",null,o.intl.formatMessage({id:"OX5PaW",defaultMessage:"Easily create shared spaces for photos, videos, docs, and more"})))),r.default.createElement(c.Text,{size:"small"},o.intl.formatMessage({id:"V3rkGP",defaultMessage:"Questions? Check out the <overview_link>Family plan overview</overview_link>."},{overview_link:function(e){return r.default.createElement(c.Link,{href:"#","aria-label":o.intl.formatMessage({id:"kc7uwV",defaultMessage:"FamilyPlanOverviewLink"}),onClick:s.logClickAndRedirect("de_family_plan_overview_link_click","/help/accounts-billing/plans-upgrades/dropbox-family-plan",{from:t.PLUS_TO_FAMILY_MODAL})},e)}})))},n.prototype.renderFooter=function(){return r.default.createElement("div",{className:"plus-family-plan-modal__footer"},this.renderVatInput(),r.default.createElement(c.Text,{color:"faint",isBold:!0,tagName:"p"},o.intl.formatMessage({id:"sIclY/",defaultMessage:"Plan change summary"})),r.default.createElement(c.Text,{size:"small",color:"faint"},this.getTransitionText()))},n.prototype.getTransitionText=function(){var e,a,n,i,l=this.props,d=l.subStatus,c=l.subChangePreview,m=l.familySku,g=l.accountPaymentInfo,_=d.finalSubState.plan,h=function(e){return r.default.createElement("a",{"aria-label":o.intl.formatMessage({id:"mRCTvJ",defaultMessage:"CancelLink"}),href:"#",onClick:s.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:t.PLUS_TO_FAMILY_MODAL})},e)},y=function(e){return r.default.createElement("a",{"aria-label":o.intl.formatMessage({id:"g/nUIt",defaultMessage:"LegalLink"}),href:"#",onClick:s.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:t.PLUS_TO_FAMILY_MODAL})},e)},v=P.priceWithTaxLabel(null!==(e=c.upcoming_bill_total_price)&&void 0!==e?e:"",null!==(a=c.tax_included_in_total_amount)&&void 0!==a&&a),b=P.priceWithTaxLabel(null!==(n=c.immediate_price)&&void 0!==n?n:"",null!==(i=c.tax_included_in_total_amount)&&void 0!==i&&i),S=r.default.createElement(u.IndividualInlinePaymentMethodView,{accountPaymentInfo:g,renderUpdateLink:r.default.createElement(f.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo})});return _.billingSchedule.id===p.ScheduleId.MONTHLY?o.intl.formatMessage({id:"5NWG7E",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a month. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:d.finalSubState.plan.displayName(),plan:m.displayName(),proratedPrice:b,date:c.upcoming_bill_date,scheduledTotal:v,paymentInfo:S,cancelLink:h,legalLink:y}):o.intl.formatMessage({id:"KUkJyi",defaultMessage:"If you change from Dropbox {currentPlan} to Dropbox {plan}, we’ll charge you {proratedPrice} now. Starting on {date}, we’ll bill you {scheduledTotal} a year. Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded unless it’s <legalLink>legally required</legalLink>. {paymentInfo}"},{currentPlan:d.finalSubState.plan.displayName(),plan:m.displayName(),proratedPrice:b,date:c.upcoming_bill_date,scheduledTotal:v,paymentInfo:S,cancelLink:h,legalLink:y})},n.prototype.render=function(){return r.default.createElement(d.Modal,{className:"plus-family-plan-modal",title:g.DROPBOX_FAMILY,acceptButtonDisabled:this.props.acceptButtonDisabled,acceptButtonText:o.intl.formatMessage({id:"e2x8vE",defaultMessage:"Change to {familyPlan} plan"},{familyPlan:g.TRADEMARK_FAMILY}),dismissButtonText:o.intl.formatMessage({id:"dTig7r",defaultMessage:"Cancel"}),autoClose:!1,onAccept:this.onAccept,onDismiss:this.onDismiss,submitting:this.props.submitting},this.renderPlusToFamilyPlanUpsell(),this.renderFooter())},n})(r.default.Component);t.PlusToFamilyModal=S})),define("modules/clean/account_page/widgets/plan/views/change_schedule_modal",["require","exports","tslib","modules/core/browser","react","dig-components/typography","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/analytics","modules/clean/subscription/tools/amp_logger","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/types","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/account_page/widgets/plan/views/update_billing_info","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/views/change_confirmation_modal","modules/clean/dbmodal_stack","modules/clean/payments/cash","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_status","modules/clean/react/modal","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/core/i18n","modules/clean/account_page/constants","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/account_page/widgets/plan/revenue_api_migration_utils","modules/clean/account_page/widgets/plan/api","modules/clean/account_page/widgets/plan/revenue_api_migration_comparisons","@apollo/react-hooks","apiql/client/components/account-gql","modules/clean/account_page/widgets/plan/api"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P,S,M,C,E,T,w,A,I,x,L,N,k,D,B,R,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeScheduleModalView=void 0,n=a.__importStar(n),i=a.__importDefault(i);var F=L.hql_events.TaxonomyAppSurface.AppSurface,U=L.hql_events.TaxonomyActionSurface.ActionSurface,q=(function(e){function t(a){var i=e.call(this,a)||this;return i._timeModalOpened=null,i.closeModals=function(){i.setState({open:!1})},i.onAccept=function(){var e,t,a=i.getSubChangePlan();a&&(a.finalSubState.billingSchedule.id===y.ScheduleId.MONTHLY&&(t=u.PerformPlanTransition.YEARLY,e=u.PerformPlanTransition.MONTHLY),a.finalSubState.billingSchedule.id===y.ScheduleId.YEARLY&&(t=u.PerformPlanTransition.MONTHLY,e=u.PerformPlanTransition.YEARLY),e&&t?(i.setState((function(e){return e.submitting=!0,e})),l.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:e},subject_user:g.getCurrentUser().id,success:function(e){var t=JSON.parse(e);if(t.redirect)return n.redirect(t.redirect);w.Notify.success(E.intl.formatMessage({id:"dVc1qR",defaultMessage:"You’ve changed your billing period!"})),i.logChangeSchedule(),i.modalLogger.logModalSuccess(),i.props.transitionPerformed&&i.props.transitionPerformed(),i.closeModals()},error:function(){w.Notify.error(E.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})),i.modalLogger.logModalError("modal_submit"),i.setState((function(e){return e.submitting=!1,e}))}})):w.Notify.error(E.intl.formatMessage({id:"wiPRXu",defaultMessage:"There was an error changing the billing period!"})))},i.updateBillingInfo=function(e){r.ProEventsLogger.log("de_update_billing_info_click"),i.closeModals(),_.DBModalStack.register(C.BILLING_INFO_UPDATED,(function(){O.resetApolloStore(),t.showInstance(i.props)})),i.props.browserUpdateRequired?S.BrowserUpdateModalLoader.showInstance():M.IndividualUpdateBillingModalLoader.showInstance()},i.handleCancelScheduleAction=function(){return i.handleCancelActions(T.CancellationType.SCHEDULE),!1},i.handleCancelActions=function(e){var t=i.props.transitionPerformed;return c.CancelChangesModalConfirmationView.showInstance({transitionPerformed:t,cancellationType:e,reOpenModalDialogAfterCancellation:!1}),!1},i.transitionPerformedClosure=function(e){if(i.props.transitionPerformed)return i.props.transitionPerformed()},i.onDismissModal=function(){r.ProEventsLogger.log("de_cancel_billing_change_modal"),i.setState({open:!1})},i.state={loadingContent:!0,subChangePlans:[],submitting:!1,hasLicenseKey:!1,open:!0},i.modalLogger=s.getSubscriptionAMPLogger({ns:"personal",modal:s.ModalTypes.CHANGE_SCHEDULE_MODAL}),i}return a.__extends(t,e),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){var e=this.state.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===y.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){var e,t=this.state.subStatus;return(null===(e=null==t?void 0:t.subState.plan)||void 0===e?void 0:e.productType)===y.ProductPlanType.PLUS_TRIAL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"productTypeStr",{get:function(){var e,t,a;return null===(a=null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.subState)||void 0===t?void 0:t.plan)||void 0===a?void 0:a.productType.toString()},enumerable:!1,configurable:!0}),t.showInstance=function(e){P.Modal.showInstance(i.default.createElement(t,a.__assign({},e)))},t.prototype.componentDidMount=function(){this._timeModalOpened=Date.now(),this.logChangeScheduleModalOpen(),this.loadPlanTransitions()},t.prototype.logTTI=function(){if(this._timeModalOpened){var e=Date.now()-this._timeModalOpened;this.modalLogger.setProductPlanType(this.productTypeStr),this.modalLogger.logModalTTI(e)}},t.prototype.loadPlanTransitions=function(){var e=this;l.WebRequest({url:"/account/ajax_change_plan_schedule",subject_user:g.getCurrentUser().id,success:function(t){var n=JSON.parse(t);e.setState((function(e){var t,i=a.__assign({},e);i.loadingContent=!1,i.subStatus=b.SubscriptionStatus.deserialize(n.serializedSubStatus),i.paymentMethod=n.paymentMethod,i.hasLicenseKey=n.hasLicenseKey;var o=i.subStatus.finalSubState;if(!o.billingSchedule||!o.plan)throw"A base plan is required, in order to change it.";return i.subChangePlans=n.serializedSubChangePlans.map((function(e){return v.SubscriptionChangePlan.deserialize(e)})),i.allSubStatuses=i.subChangePlans.map((function(e){return e})),i.allSubStatuses.push(i.subStatus),i.growthRevapiPaPlanManagementCompareData=n.growthRevapiPaPlanManagementCompareData,r.ProEventsLogger.log("de_plan_tab_change_billing_load_modal",{from:(null===(t=i.subStatus.subState.billingSchedule)||void 0===t?void 0:t.id)===y.ScheduleId.MONTHLY?"monthly":"yearly"}),i}),e.logTTI)},error:function(){w.Notify.error(E.intl.formatMessage({id:"C2BKnZ",defaultMessage:"Failed to load modal."})),e.modalLogger.logModalError("modal_init"),e.closeModals()}})},t.prototype.getSubChangePlan=function(){var e=this;return this.state.subChangePlans.filter((function(t){var a=t.finalSubState;return!(!a.plan||!a.billingSchedule)&&(a.plan.productType===e.currentPlanType&&a.billingSchedule.id===e.scheduleToSwitchTo)})).pop()},Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:y.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scheduleToSwitchTo",{get:function(){return this.state.subStatus&&this.state.subStatus.subState.billingSchedule.id===y.ScheduleId.MONTHLY?y.ScheduleId.YEARLY:y.ScheduleId.MONTHLY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPlanType",{get:function(){var e,t;return(null===(t=null===(e=this.state.subStatus)||void 0===e?void 0:e.finalSubState.plan)||void 0===t?void 0:t.productType)||y.ProductPlanType.STANDARD},enumerable:!1,configurable:!0}),t.prototype.logChangeScheduleModalOpen=function(){var e,t;this.props.isFromBillingTab?(e=U.CENTER_PANE_BILLING_TAB,t="de_billing_tab_change_billing_open_modal"):(e=U.CENTER_PANE_PLAN_TAB,t="de_plan_tab_change_billing_open_modal");var a=x.hql_events.HQLEventIdentity.create({eventClass:x.hql_events.HQLEventIdentity.EventClass.create({className:L.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:x.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:t}),actionEventId:x.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"change_billing_schedule_modal",action:L.hql_events.TaxonomyAction.Action.SHOWN})});A.logEvent(I.hql_events.ShownChangeBillingScheduleModal.create({hqlMetadata:x.hql_events.HQLMetadata.create({appSurface:F.WEB,actionSurface:e,identityOverride:a})}))},t.prototype.logChangeSchedule=function(){var e=this.state.subStatus;e&&e.subState.billingSchedule&&r.ProEventsLogger.log("de_change_billing_change_schedule",{from:e.subState.billingSchedule.id===y.ScheduleId.MONTHLY?"monthly":"yearly",to:e.subState.billingSchedule.id===y.ScheduleId.MONTHLY?"yearly":"monthly"})},t.prototype.isBillingScheduleToChange=function(){var e=this.state,t=e.subStatus;return!e.hasLicenseKey&&(!!(t&&t.subState.billingSchedule&&t.finalSubState.billingSchedule)&&t.subState.billingSchedule.id!==t.finalSubState.billingSchedule.id)},Object.defineProperty(t.prototype,"changesSummaryContent",{get:function(){var e=this,t=this.state,a=t.subStatus,n=t.paymentMethod,l=this.getSubChangePlan();if(a&&a.subState.plan){if(a.subState.plan.scheduleId!==a.finalSubState.plan.scheduleId&&!this.isProfessionalTrialPlan)return E.intl.formatMessage({id:"uGbqz6",defaultMessage:"You’ve already requested a change to your billing period. If you want to choose a different billing period, first cancel your pending change. <cancelChangeLink>Cancel change</cancelChangeLink>"},{cancelChangeLink:function(t){return i.default.createElement(o.Link,{href:"#","aria-label":E.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),className:"change-confirmation-modal__link",onClick:e.handleCancelScheduleAction,variant:"primary",hasNoUnderline:!0},t)}});var r={nextBillingDate:a.subState.formattedNextBillingDate,scheduleId:l.finalSubState.billingSchedule.id,totalPrice:h.Cash.formatWithTaxLabels(l.nextBillingSummary.total,l.nextBillingSummary)},s=i.default.createElement(p.IndividualInlinePaymentMethodView,{accountPaymentInfo:N.convertLegacyPaymentInfo(n),renderUpdateLink:i.default.createElement(m.UpdateBillingInfoLink,{updateBillingCTA:this.updateBillingInfo}),transitionDetails:r});return E.intl.formatMessage({id:"pVEqbN",defaultMessage:"{paymentInfo}{br}{br}Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded <legalLink>unless it’s legally required</legalLink>."},{br:i.default.createElement("br",null),strong:function(e){return i.default.createElement("strong",null,e)},cancelLink:function(e){return i.default.createElement(o.Link,{href:"#","aria-label":E.intl.formatMessage({id:"A3cCkZ",defaultMessage:"Cancel link"}),onClick:g.logClickAndRedirect("de_cancel_link_click","/help/billing/cancel-dropbox-plus",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e)},legalLink:function(e){return i.default.createElement(o.Link,{href:"#","aria-label":E.intl.formatMessage({id:"5Kyedz",defaultMessage:"Legal link"}),onClick:g.logClickAndRedirect("de_legal_link_click","/help/billing/plus-refund",{from:"change_plan_modal"}),variant:"primary",hasNoUnderline:!0},e)},paymentInfo:s})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.state.paymentMethod,t=this.state,a=t.loadingContent,n=t.submitting;return a||n||!e||this.isBillingScheduleToChange()},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,a=this.state,n=a.subStatus,o=a.loadingContent,l=a.submitting,r=a.open,s=a.growthRevapiPaPlanManagementCompareData,c=this.props.transitionPerformed;n&&c&&!this.isProfessionalTrialPlan&&!this.isPlusTrialPlan&&(_.DBModalStack.clear(),_.DBModalStack.register(d.CHANGE_IND_PLAN_MODAL_UPDATED,(function(){t.showInstance({transitionPerformed:e.transitionPerformedClosure})})));var u=E.intl.formatMessage({id:"BKISIV",defaultMessage:"Confirm"}),p=E.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),g=this.isBillingScheduleToChange()&&!this.isProfessionalTrialPlan?E.intl.formatMessage({id:"ewZ2I2",defaultMessage:"Change billing period"}):this.scheduleToSwitchTo===y.ScheduleId.YEARLY?E.intl.formatMessage({id:"z17QUa",defaultMessage:"You’re switching to yearly billing"}):E.intl.formatMessage({id:"/tHQbR",defaultMessage:"You’re switching to monthly billing"}),h=i.default.createElement(m.UpdateBillingInfoButton,{updateBillingCTA:this.updateBillingInfo}),v=this.state.subChangePlans.map((function(e){return e.finalSubState.plan})).filter((function(e){return e}));return i.default.createElement(B.ApolloProvider,{client:k.getApolloClient()},s&&i.default.createElement(D.CompareRevApiAvailablePlans,{upcomingPlanId:n.finalSubState.planSku.code,legacyAvailablePlans:N.convertLegacyAvailablePlansData(v),filterContractLength:R.AccountPlanFilterArgument.DifferentThanScheduled,filterProductFamily:R.AccountPlanFilterArgument.SameAsScheduled,context:"change_schedule_modal"}),i.default.createElement(f.ChangeConfirmationModal,{acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:u,description:this.changesSummaryContent,dismissButtonText:p,link:h,loadingContent:o,onAccept:this.onAccept,onDismiss:this.onDismissModal,open:r,submitting:l,title:g}))},t})(i.default.Component);t.ChangeScheduleModalView=q})),define("modules/clean/account_page/widgets/plan/views/disband_family_confirmation_modal",["require","exports","tslib","react","styled-components","dig-components/modal","dig-components/typography","dig-components/controls","modules/core/i18n","modules/clean/react/modal","modules/clean/dbmodal_stack","dig-components/buttons","modules/constants/trademark","family/common/links"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDisbandModal=t.DisbandFamilyConfirmationModal=t.FAMILY_DISBAND_MODAL_GO_BACK=void 0,n=a.__importDefault(n);var g,f,_,h,y=(i=a.__importDefault(i)).default.div(g||(g=a.__makeTemplateObject(["\n  display: flex;\n  margin-bottom: var(--spacing__unit--2);\n  &:last-child {\n    margin-bottom: 0;\n  }\n"],["\n  display: flex;\n  margin-bottom: var(--spacing__unit--2);\n  &:last-child {\n    margin-bottom: 0;\n  }\n"]))),v=i.default(r.Checkbox)(f||(f=a.__makeTemplateObject(["\n  margin-top: var(--spacing__unit--0_5);\n  max-width: 20px;\n  flex: 1;\n  margin-right: var(--spacing__base_unit);\n"],["\n  margin-top: var(--spacing__unit--0_5);\n  max-width: 20px;\n  flex: 1;\n  margin-right: var(--spacing__base_unit);\n"]))),b=i.default.div(_||(_=a.__makeTemplateObject(["\n  margin-bottom: var(--spacing__unit--3);\n"],["\n  margin-bottom: var(--spacing__unit--3);\n"]))),P=i.default(l.Text)(h||(h=a.__makeTemplateObject(["\n  flex: 2;\n"],["\n  flex: 2;\n"]))),S=function(e){var t=e.children;return n.default.createElement(l.Link,{href:m.FAMILY_ROOM_HELP_CENTER_ARTICLE,target:"_blank",rel:"noreferrer",variant:"monochromatic"},t)};t.FAMILY_DISBAND_MODAL_GO_BACK="disband_family_confirmation_modal:goback",t.DisbandFamilyConfirmationModal=function(e){var a=e.displayFamilyRoomCheckbox,i=n.default.useState(!1),r=i[0],m=i[1],g=n.default.useState(!1),f=g[0],_=g[1],h=n.default.useState(!1),M=h[0],C=h[1],E=n.default.useState(!1),T=E[0],w=E[1],A=!r||!f||a&&!M||T,I=function(){d.Modal.close()},x=function(){w(!1)};return n.default.createElement(o.Modal,{open:!0,className:"disband-family-confirmation-modal",overlayClassName:"disband-family-confirmation-modal-overlay",width:"small",onRequestClose:I},n.default.createElement(o.Modal.Header,{hasBottomSpacing:"title-standard"},n.default.createElement(l.Title,{isBold:!0},s.intl.formatMessage({id:"I9CTpA",defaultMessage:"Are you sure you want to change plans?"}))),n.default.createElement(o.Modal.Body,null,n.default.createElement(b,null,n.default.createElement(P,null,s.intl.formatMessage({id:"QDkSaP",defaultMessage:"{dropbox_family} will be canceled, and active members of your {family_plan} plan will have their accounts downgraded to {dropbox_basic}"},{dropbox_family:p.DROPBOX_FAMILY,family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC}))),n.default.createElement(b,null,n.default.createElement(P,{isBold:!0},s.intl.formatMessage({id:"Md6TJX",defaultMessage:"If you still want to change plans, please acknowledge the following:"}))),n.default.createElement(y,null,n.default.createElement(v,{onChange:function(){m(!r)},checked:r,className:"disband-confirmation-checkbox downgrade-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"+E9wLh",defaultMessage:"By proceeding, {family_plan} plan members will be downgraded to a {basic_space_quota} {dropbox_basic} plan."},{family_plan:p.TRADEMARK_FAMILY,dropbox_basic:p.DROPBOX_BASIC,basic_space_quota:e.basicSkuQuotaGb}))),a&&n.default.createElement(y,null,n.default.createElement(v,{onChange:function(){C(!M)},checked:M,className:"disband-confirmation-checkbox family-shared-folder-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"DaDVT1",defaultMessage:"All members will keep a copy of your <link>Family Room folder.</link>"},{link:function(e){return n.default.createElement(S,null,e)}}))),n.default.createElement(y,null,n.default.createElement(v,{onChange:function(){_(!f)},checked:f,className:"disband-confirmation-checkbox over-quota-acknowledged"}),n.default.createElement(P,null,s.intl.formatMessage({id:"zGHPY9",defaultMessage:"If members are using more than {basic_space_quota} of storage, Dropbox will stop syncing, additional files can’t be uploaded, and files can’t be restored to earlier versions."},{basic_space_quota:e.basicSkuQuotaGb})))),n.default.createElement(o.Modal.Footer,null,n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-back",disabled:T,variant:"transparent",onClick:function(){d.Modal.close(),c.DBModalStack.trigger(t.FAMILY_DISBAND_MODAL_GO_BACK,{})}},s.intl.formatMessage({id:"lhKaOC",defaultMessage:"Back"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-cancel",disabled:T,variant:"opacity",onClick:I},s.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),n.default.createElement(u.Button,{className:"disband-family-confirmation-modal-confirm",variant:"primary",onClick:function(){w(!0),e.confirmChangePlan(x)},disabled:A},s.intl.formatMessage({id:"ZCkVHN",defaultMessage:"Confirm change"}))))},t.showDisbandModal=function(e){d.Modal.showInstance(n.default.createElement(t.DisbandFamilyConfirmationModal,a.__assign({},e)))}})),define("modules/clean/account_page/widgets/plan/views/loading_view",["require","exports","tslib","react","modules/core/i18n","modules/clean/static_urls"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingView=void 0,n=a.__importStar(n),t.LoadingView=function(e){return n.createElement("div",{className:e.className},n.createElement("img",a.__assign({src:o.static_url("/static/images/icons/ajax-loading-small-blue-vflVk_QNP.gif"),alt:i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})},e.imageProps)))}})),define("modules/clean/account_page/widgets/plan/views/individual_inline_payment_method",["require","exports","tslib","react","modules/core/i18n","modules/clean/payments/skus/constants","apiql/client/components/account-gql"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualInlinePaymentMethodView=void 0;var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.renderCreditCard=function(){var e=this.props,t=e.accountPaymentInfo,a=e.transitionDetails;if(t){var l=t.last_digits,r=void 0;if(a){var s=a.nextBillingDate,d=a.scheduleId,c=a.totalPrice;return r=d===o.ScheduleId.YEARLY?i.intl.formatMessage({id:"IK0bTU",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your card ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}):i.intl.formatMessage({id:"QRWsYu",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your card ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}),n.default.createElement("span",null,r," ")}return r=i.intl.formatMessage({id:"GK+TXw",defaultMessage:"We’ll charge your card ending in {last4}."},{last4:l}),n.default.createElement("span",null,r," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)},t.prototype.renderDirectDebit=function(){var e=this.props,t=e.accountPaymentInfo,a=e.transitionDetails;if(t){var l=t.last_digits,r=void 0;if(a){var s=a.nextBillingDate,d=a.scheduleId,c=a.totalPrice;return r=d===o.ScheduleId.YEARLY?i.intl.formatMessage({id:"5ZcdXx",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your IBAN ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}):i.intl.formatMessage({id:"j+Ib+Z",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your IBAN ending in <strong>{last4}</strong>."},{last4:l,date:s,scheduled_total:c,strong:function(e){return n.default.createElement("strong",null,e)}}),n.default.createElement("span",null,r," ")}return r=i.intl.formatMessage({id:"RFtAL9",defaultMessage:"We’ll charge your IBAN ending in {last4}."},{last4:l}),n.default.createElement("span",null,r," ",this.props.renderUpdateLink)}return n.default.createElement("span",null)},t.prototype.renderPaypal=function(){var e=this.props,t=e.renderUpdateLink,a=e.transitionDetails;if(a){var l=a.nextBillingDate,r=a.scheduleId,s=a.totalPrice,d=r===o.ScheduleId.YEARLY?i.intl.formatMessage({id:"GvhVZe",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your PayPal account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}}):i.intl.formatMessage({id:"S7Wy/F",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your PayPal account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}});return n.default.createElement("span",null,d," ")}return n.default.createElement("span",null,i.intl.formatMessage({id:"aQ9deh",defaultMessage:"We’ll charge your PayPal account."})," ",t)},t.prototype.renderIdeal=function(){var e=this.props,t=e.renderUpdateLink,a=e.transitionDetails;if(a){var l=a.nextBillingDate,r=a.scheduleId,s=a.totalPrice,d=r===o.ScheduleId.YEARLY?i.intl.formatMessage({id:"TZiYnT",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per year on your iDEAL account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}}):i.intl.formatMessage({id:"8MQcfN",defaultMessage:"Starting <strong>{date}</strong>, we’ll charge you <strong>{scheduled_total}</strong> per month on your iDEAL account."},{date:l,scheduled_total:s,strong:function(e){return n.default.createElement("strong",null,e)}});return n.default.createElement("span",null,d," ")}return n.default.createElement("span",null,i.intl.formatMessage({id:"7EJCsH",defaultMessage:"We’ll charge your iDEAL account."})," ",t)},t.prototype.render=function(){var e=this.props,t=e.accountPaymentInfo,a=e.paymentErrorMessage;if(!t&&a)return n.default.createElement("span",null,a," ",this.props.renderUpdateLink);if(!t)return n.default.createElement("span",null);switch(t.active_payment_method_type){case l.AccountPaymentInfoType.Card:return this.renderCreditCard();case l.AccountPaymentInfoType.Sepa:return this.renderDirectDebit();case l.AccountPaymentInfoType.Paypal:return this.renderPaypal();case l.AccountPaymentInfoType.Ideal:return this.renderIdeal();default:return n.default.createElement("span",null)}},t})((n=a.__importDefault(n)).default.Component);t.IndividualInlinePaymentMethodView=r})),define("modules/clean/account_page/widgets/plan/views/npt_billing_schedule_items",["require","exports","tslib","react","modules/core/i18n","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/payments/skus/constants","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list"],(function(e,t,a,n,i,o,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NptBillingScheduleItems=void 0;var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.changeProductScheduleTypeClosure=function(e){var t=this;return function(){t.props.changeProductScheduleType(e)}},t.prototype.getScheduleDescription=function(e,t,a,n){switch(e){case l.ScheduleId.YEARLY:return i.intl.formatMessage({id:"Fd23KZ",defaultMessage:"{plan_name} is {price_per_year} per year. You’ll save {savePercentage} over monthly billing."},{plan_name:this.props.planName,price_per_year:a,savePercentage:n});case l.ScheduleId.MONTHLY:return i.intl.formatMessage({id:"XD9xb9",defaultMessage:"{plan_name} is {price_per_month} per month. You’ll spend {price_per_year} per year."},{plan_name:this.props.planName,price_per_month:t,price_per_year:a})}return""},t.prototype.getBillingItemTitle=function(e){switch(e){case l.ScheduleId.YEARLY:return i.intl.formatMessage({id:"onubGk",defaultMessage:"Billed yearly"});case l.ScheduleId.MONTHLY:return i.intl.formatMessage({id:"ytUb1D",defaultMessage:"Billed monthly"})}return""},t.prototype.render=function(){var e=this,t=this.props,a=t.trialPriceConversions,s=t.finalBillingScheduleId;return n.default.createElement(r.AdminPricedList,null,Object.keys(a).map((function(t){var r=parseInt(t,10),d=r===s,c=a[t],u=c.advertised_monthly_price,p=i.intl.formatMessage({id:"0OYZsq",defaultMessage:"per month"});return r===l.ScheduleId.YEARLY&&(u=c.advertised_yearly_price,p=i.intl.formatMessage({id:"1BL+ll",defaultMessage:"per year"})),n.default.createElement(o.AdminPricedListItem,{key:c.conversion_token.plan_sku_code,isSelected:d,title:e.getBillingItemTitle(r),titleWarningText:void 0,titleSecondaryText:void 0,description:e.getScheduleDescription(r,c.advertised_monthly_price,c.advertised_yearly_price,c.advertised_yearly_price_savings),price:void 0,priceString:u,detailsLink:void 0,unit:p,onClick:e.changeProductScheduleTypeClosure(r),disableItem:!1,recommended:r===l.ScheduleId.YEARLY})})))},t})((n=a.__importDefault(n)).default.Component);t.NptBillingScheduleItems=s})),define("modules/clean/account_page/widgets/plan/views/plan_status",["require","exports","tslib","modules/core/browser","react","styled-components","modules/clean/viewer","modules/core/uri","modules/core/i18n","modules/core/exception","modules/core/exception","modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader","modules/clean/account_page/widgets/plan/strings","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/billing/payment_method_constants","modules/clean/static_urls","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/payments/cash","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/payments/skus/constants","modules/clean/analytics","modules/constants/trademark","dig-components/buttons","modules/clean/account_page/widgets/plan/views/basic_plan_status","modules/core/notify","modules/clean/hql/index","dropbox/proto/hql_events/activation/activation","dropbox/proto/hql_events/revenue/revenue","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v,b,P,S,M,C,E,T,w,A,I,x,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlanStatus=void 0,n=a.__importStar(n),i=a.__importDefault(i),o=a.__importDefault(o),d=a.__importStar(d);var N,k,D=L.hql_events.TaxonomyAppSurface.AppSurface,B=L.hql_events.TaxonomyActionSurface.ActionSurface,R=o.default.div(Q||(Q=a.__makeTemplateObject(["\n  display: flex;\n  padding: 36px 0;\n  border-bottom: 1px solid var(--color__standard__border);\n"],["\n  display: flex;\n  padding: 36px 0;\n  border-bottom: 1px solid var(--color__standard__border);\n"]))),O=o.default.div(X||(X=a.__makeTemplateObject(["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"],["\n  flex-grow: 1;\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n"]))),F=o.default.h1(Z||(Z=a.__makeTemplateObject(["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"],["\n  font-size: var(--type__body__large--fontsize);\n  margin-bottom: 0;\n  color: var(--color__standard__text);\n"]))),U=o.default.p(J||(J=a.__makeTemplateObject(["\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n  width: 100%;\n  max-width: 343px;\n  padding-right: 8px;\n  box-sizing: border-box;\n"],["\n  color: var(--color__faint__text);\n  font-size: var(--type__body__small--fontsize);\n  line-height: var(--type__body__large--lineight);\n  width: 100%;\n  max-width: 343px;\n  padding-right: 8px;\n  box-sizing: border-box;\n"]))),q=o.default.div($||($=a.__makeTemplateObject(["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"],["\n  flex-basis: 140px;\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n"]))),j=o.default.span(ee||(ee=a.__makeTemplateObject(["\n  font-size: var(--type__body__small--fontsize);\n"],["\n  font-size: var(--type__body__small--fontsize);\n"]))),Y=o.default.div(te||(te=a.__makeTemplateObject(["\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  font-size: var(--type__body__standard--fontsize);\n"],["\n  text-align: right;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  font-size: var(--type__body__standard--fontsize);\n"]))),V=o.default.a(ae||(ae=a.__makeTemplateObject(["\n  font-style: italic;\n"],["\n  font-style: italic;\n"]))),H=o.default.div(ne||(ne=a.__makeTemplateObject(["\n  width: 36px;\n  margin: var(--spacing__unit--2) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"],["\n  width: 36px;\n  margin: var(--spacing__unit--2) var(--spacing__unit--2) auto var(--spacing__base_unit);\n  height: 69px;\n"]))),G=o.default(C.Button)(ie||(ie=a.__makeTemplateObject(["\n  width: 124px;\n  height: var(--spacing__unit--4);\n  margin: 0;\n  padding: 0;\n"],["\n  width: 124px;\n  height: var(--spacing__unit--4);\n  margin: 0;\n  padding: 0;\n"]))),z=o.default(C.Button)(oe||(oe=a.__makeTemplateObject(["\n  line-height: var(--type__body__small--lineheight);\n  width: 124px;\n  height: auto;\n  min-height: var(--spacing__unit--4);\n  margin: var(--spacing__unit--2) 0;\n  padding: var(--spacing__unit--0_5);\n  white-space: normal;\n"],["\n  line-height: var(--type__body__small--lineheight);\n  width: 124px;\n  height: auto;\n  min-height: var(--spacing__unit--4);\n  margin: var(--spacing__unit--2) 0;\n  padding: var(--spacing__unit--0_5);\n  white-space: normal;\n"]))),W=o.default.p(le||(le=a.__makeTemplateObject(["\n  padding: 0;\n  margin: 0;\n"],["\n  padding: 0;\n  margin: 0;\n"]))),K=o.default.div(re||(re=a.__makeTemplateObject(["\n  .plan-status-section__try-free-trial {\n    position: relative;\n\n    p {\n      width: 370px;\n      margin: 0;\n    }\n  }\n"],["\n  .plan-status-section__try-free-trial {\n    position: relative;\n\n    p {\n      width: 370px;\n      margin: 0;\n    }\n  }\n"])));(function(e){e[e.Cancel=0]="Cancel",e[e.Change=1]="Change",e[e.Manage=2]="Manage",e[e.Upgrade=3]="Upgrade"})(N||(N={})),(function(e){e.BUTTON="button",e.QUERY_PARAM="query_param"})(k||(k={}));var Q,X,Z,J,$,ee,te,ae,ne,ie,oe,le,re,se=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isOverQuota=function(){return t.usage>t.quota},t.logSeePlanDetails=function(){var e=t.props.isTransactionInformationPage;w.logEvent(A.hql_events.SelectMoreDetails.create({isTransactionInformationPage:Boolean(e),hqlMetadata:x.hql_events.HQLMetadata.create({appSurface:D.WEB,actionSurface:B.CENTER_PANE})})),S.ProEventsLogger.log("de_plan_tab_details_click")},t.cancelPlanClick=function(){t.props.isPersonalUser?n.redirect("/account/plan?modal=individual_cancel_survey"):n.redirect("/team/cancel")},t.canShowChangePlan=function(e){var a,n=t.props,i=n.subStatus,o=n.eligibleFor1tb,l=[P.ProductPlanType.STANDARD,P.ProductPlanType.PLUS,P.ProductPlanType.PROFESSIONAL,P.ProductPlanType.TRANSFER,P.ProductPlanType.SYNC_EVERYTHING,P.ProductPlanType.PASSWORDS,P.ProductPlanType.HS_DBX_PRO_BUNDLE,P.ProductPlanType.FAMILY_PAYER];e||l.push(P.ProductPlanType.FAMILY_NONPAYER);var r=null===(a=null==i?void 0:i.subState.plan)||void 0===a?void 0:a.productType;return!(!r||-1===l.indexOf(r))&&(!(t.props.hasUnusedLicenseKey||!t.isInStandardSchedule()||o)&&!t.isExternallyManagedSubscription)},t.openChangeBillingPeriodModal=function(e){return function(a){a&&a.preventDefault();var n=t.props,i=n.browserUpdateRequired,o=n.onUpdate,l=n.paymentInfo,r=n.scheduledForDowngrade,s=n.subStatus;r?b.CancelChangesModalConfirmation.showInstance({transitionPerformed:o,subStatus:s}):(v.ChangeScheduleModalView.showInstance({transitionPerformed:o,paymentInfo:l,browserUpdateRequired:i}),S.ProEventsLogger.log(e))}},t.onChangeBillingPeriodClick=t.openChangeBillingPeriodModal("de_plan_tab_change_billing_open_modal"),t.onUpdateBillingClick=function(e){e.preventDefault(),t.props.browserUpdateRequired?_.BrowserUpdateModalLoader.showInstance():u.IndividualUpdateBillingModalLoader.showInstance()},t.logUpgradeButtonClick=function(){var e=x.hql_events.HQLEventIdentity.create({eventClass:x.hql_events.HQLEventIdentity.EventClass.create({className:L.hql_events.TaxonomyClass.ClassName.SEE_AND_CLICK}),legacyEvent:x.hql_events.HQLEventIdentity.LegacyEvent.create({table:"pro_events",name:"de_plan_tab_upgrade_to_plus_click"}),actionEventId:x.hql_events.HQLEventIdentity.ActionEventIdentity.create({object:"basic_upgrade_button",action:L.hql_events.TaxonomyAction.Action.SELECT})});w.logEvent(I.hql_events.SelectBasicUpgradeButton.create({hqlMetadata:x.hql_events.HQLMetadata.create({appSurface:D.WEB,actionSurface:B.CENTER_PANE_PLAN_TAB,identityOverride:e})}))},t.redirectToUpgrade=function(){t.logUpgradeButtonClick(),S.ProEventsLogger.log("de_plan_tab_upgrade_to_plus_click");var e=t.isOverQuota()?"acc_plan_upgrade_overquota_btn":"acc_plan_upgrade",a=new r.URI({path:"/upgrade",query:{oqa:e}}).toString();n.redirect(a)},t.purchaseNowClick=function(){S.ProEventsLogger.log("de_plan_tab_purchase_now_click"),n.redirect("/pro/convert")},t.cancelTrialClick=function(){S.ProEventsLogger.log("de_plan_tab_cancel_trial_click");var e=t.props.modalCallbacks;return(null==e?void 0:e.openTryBackupModal)?e.openTryBackupModal():(null==e?void 0:e.openIndividualCancelSurvey)?e.openIndividualCancelSurvey():void n.redirect("/account/plan?modal=individual_cancel_survey")},t.contactSupportClick=function(){S.ProEventsLogger.log("de_plan_tab_contact_support_click"),n.redirect("/support")},t.addPaymentClick=function(){S.ProEventsLogger.log("de_plan_tab_add_payment_method_click"),u.IndividualUpdateBillingModalLoader.showInstance()},t.logOpenChangePlanModal=function(){var e,a=t.props.subStatus;if((null===(e=null==a?void 0:a.subState.plan)||void 0===e?void 0:e.productClass)===P.ProductClass.PLAN){var n=a.subState.plan.productType;w.logEvent(I.hql_events.ShownChangePlanModal.create({currentProductPlanType:n,hqlMetadata:x.hql_events.HQLMetadata.create({appSurface:D.WEB,actionSurface:B.CENTER_PANE})})),S.ProEventsLogger.log("change_plan_modal_view",{current_product_plan_type:P.ProductPlanType[n]})}else d.reportException({err:new Error("Change plan modal opened without a plan"),severity:"non-critical"})},t.openChangePlanModal=function(e,a,i){void 0===a&&(a=k.BUTTON),void 0===i&&(i=y.ChangePlanOrigin.DEFAULT),e&&e.preventDefault(),t.props.isLoggedInUser||(t.props.isPersonalUser?n.redirect("/account/plan"):n.redirect("/team/admin/billing/manage"));var o=t.props,l=o.browserUpdateRequired,r=o.scheduledForDowngrade,s=o.paymentInfo;r?b.CancelChangesModalConfirmation.showInstance({transitionPerformed:t.props.onUpdate,subStatus:t.props.subStatus,userIdOverride:t.getUserForModal()}):(y.ChangePlanModalView.showInstance({browserUpdateRequired:l,transitionPerformed:t.props.onUpdate,paymentInfo:s,origin:i,userIdOverride:t.getUserForModal()}),t.logOpenChangePlanModal())},t.renderContactSupportLink=function(){return i.default.createElement(Y,{className:"plan-status-section__contact_support_link"},i.default.createElement("a",{href:"#",className:"account-page__link",onClick:t.contactSupportClick},s.intl.formatMessage({id:"NYuVLU",defaultMessage:"Contact support to change plan"})))},t.renderBillingPeriod=function(){var e=t.props,a=e.paymentInfo,n=e.scheduledForDowngrade,o=e.hasUnusedLicenseKey,l=e.subStatus;if(!t.isFamilyNonPayerPlan()&&!t.isBackupPlan()&&a&&t.props.showChangeBillingPeriod&&!o&&l&&l.subState.plan){var r=a.gateway_id,d=a.is_reseller_billing,c=a.end_date,u=a.deactivated,p=a.is_on_trial,g=a.reseller_name,f=a.reseller_link;if(!a.schedule_switchable&&!n&&!t.isProfessionalTrial()||t.isExternallyManagedSubscription){var _=m.getBillingDisabledMessage({gatewayId:r,isResellerBilling:d,resellerName:g,resellerLink:f,dropboxPlan:l.subState.plan.displayName(),endDate:c,deactivated:u,isOnTrial:p});return i.default.createElement(j,{className:"plan-status-section__message"},_)}if(!t.isPlusTrial())return a.is_in_grace_period?i.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link",onClick:t.onUpdateBillingClick},s.intl.formatMessage({id:"iq/tnl",defaultMessage:"Please update your billing information"})):i.default.createElement("a",{href:"#",className:"plan-status-section__link account-page__link","data-test":"change-billing-link",onClick:t.onChangeBillingPeriodClick},s.intl.formatMessage({id:"Cfhoeq",defaultMessage:"Change billing period"}))}},t.managePlanClick=function(){n.redirect("/team/admin/billing/manage")},t.createTrialCtaButtons=function(e,a){return void 0===e&&(e=!0),void 0===a&&(a=!1),a?i.default.createElement(q,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(z,{className:"cancel-button",variant:"outline",onClick:t.cancelTrialClick},s.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):e?i.default.createElement(q,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(G,{className:"purchase-button",variant:"primary",onClick:t.purchaseNowClick},s.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"})),i.default.createElement(z,{className:"cancel-button",variant:"primary",onClick:t.cancelTrialClick},s.intl.formatMessage({id:"QJ3PjI",defaultMessage:"Cancel trial"}))):i.default.createElement(q,{className:"plan-status-section__upgrade_btn trial-cta"},i.default.createElement(C.Button,{className:"purchase-button",variant:"primary",onClick:t.purchaseNowClick},s.intl.formatMessage({id:"rki01J",defaultMessage:"Purchase Now"})))},t.renderChangePlanButton=function(e){var a=t.props,n=a.paymentInfo,o=a.isLoggedInUser,l=a.isLoggedInAsTransactionOwner;if(o&&!l)return t.renderLoginInstructions(N.Change);var r=t.getChangePlanButtonText(),s=t.getChangePlanClickHandler(e);return i.default.createElement(q,{className:"plan-status-section__upgrade_btn"},i.default.createElement(C.Button,{className:"jest-change-plan-button",variant:"primary",onClick:s,disabled:null==n?void 0:n.is_in_grace_period},r))},t.getChangePlanButtonText=function(){return t.isFamilyNonPayerPlan()?s.intl.formatMessage({id:"I9CJF0",defaultMessage:"See other plans"}):s.intl.formatMessage({id:"w1kkK2",defaultMessage:"Change plan"})},t.getChangePlanClickHandler=function(e){var a=t.props.subStatus;return e?function(){a.subState.plan.isEnterprise?n.redirect("/team/admin/help?role=work"):n.redirect("/team/admin/billing/manage?show_switch_plan")}:t.isFamilyNonPayerPlan()?function(){S.ProEventsLogger.log("de_plan_tab_see_other_plans_family_member_click"),n.redirect(t.plansURL)}:t.openChangePlanModal},t.logUpgradeOverquotaBtn=function(e){S.GrowthEventsLogger.log("acc_plan_upgrade_overquota_btn",{action:e,button_text:"Upgrade now",destination_url:"http://www.dropbox.com/upgrade",location:"in_product",quota_status:"over",upsell_type:"modal"})},t.onUpgradePlanButtonClick=function(){t.logUpgradeOverquotaBtn("click"),t.redirectToUpgrade()},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=r.URI.parse(n.get_href()).getQuery().modal;if(t)if("plan"===t||"plus_to_family"===t)if(this.canShowChangePlan(!0)){var a="plan"===t?y.ChangePlanOrigin.DEFAULT:y.ChangePlanOrigin.PLUS_TO_FAMILY;Promise.resolve().then((function(){e.openChangePlanModal(void 0,k.QUERY_PARAM,a)}))}else T.Notify.error(s.intl.formatMessage({id:"Ruu9sN",defaultMessage:"You cannot change plans at this time."}));else"downgrade"===t&&this.props.scheduledForDowngrade&&b.CancelChangesModalConfirmation.showInstance({transitionPerformed:this.props.onUpdate,subStatus:this.props.subStatus,userIdOverride:this.getUserForModal()})},Object.defineProperty(t.prototype,"plansURL",{get:function(){var e=this.props,t=e.isLoggedInUser,a={oqa:"acc_plan_upgrade"};return e.isTransactionInformationPage&&!t&&(a.trigger="nr"),this.isTransferPlan()?new r.URI({path:"/transfer/plans",query:a}).toString():this.isBackupPlan()?"https://help.dropbox.com/accounts-billing/plans-upgrades/dropbox-backup-plan":new r.URI({path:"/plans",query:a}).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usage",{get:function(){return this.props.usageBreakdown.usage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExternallyManagedSubscription",{get:function(){var e=this.props,t=e.paymentInfo;return e.isExternallyBilled||t&&m.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)},enumerable:!1,configurable:!0}),t.prototype.renderCancelPlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(N.Cancel):i.default.createElement(q,{className:"plan-status-section__upgrade_btn"},i.default.createElement(C.Button,{onClick:this.cancelPlanClick,variant:"outline"},s.intl.formatMessage({id:"vQndaY",defaultMessage:"Cancel plan"})))},t.prototype.isTransferPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.TRANSFER},t.prototype.isBackupPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.SYNC_EVERYTHING},t.prototype.isHSProPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.HS_DBX_PRO_BUNDLE},t.prototype.isFamilyPayerPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.FAMILY_PAYER},t.prototype.isFamilyNonPayerPlan=function(){var e,t;return(null===(t=null===(e=this.props.subStatus)||void 0===e?void 0:e.subState.plan)||void 0===t?void 0:t.productType)===P.ProductPlanType.FAMILY_NONPAYER},t.prototype.isFamilyPlan=function(){return this.isFamilyPayerPlan()||this.isFamilyNonPayerPlan()},t.prototype.isFreePlusPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.FREE},t.prototype.isInStandardSchedule=function(){var e=this.props.subStatus;if(e&&e.subState&&e.subState.billingSchedule){var t=e.subState.billingSchedule.id;return t===P.ScheduleId.MONTHLY||t===P.ScheduleId.YEARLY}return!1},t.prototype.pendingScheduledChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isTaurusPlan=function(){var e=this.props.subStatus;if(e&&e.subState.plan){var t=e.subState.plan.productType;return t===P.ProductPlanType.PLUS||t===P.ProductPlanType.PLUS_TRIAL||t===P.ProductPlanType.PROFESSIONAL||t===P.ProductPlanType.PROFESSIONAL_TRIAL||t===P.ProductPlanType.PLUS_WITH_SS||t===P.ProductPlanType.PLUS_WITH_SS_TRIAL}return!1},t.prototype.isPlanScheduledToChange=function(){var e=this.props,t=e.subStatus;return!!e.scheduledForDowngrade||!!(t&&t.subState.plan&&t.finalSubState.plan)&&t.subState.plan.productType!==t.finalSubState.plan.productType},t.prototype.isEvhScheduledToChange=function(){var e=this.props.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isBillingScheduleToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.getGatewayId=function(){var e=this.props.paymentInfo;return e?e.gateway_id:g.NOT_APPLICABLE},t.prototype.isTrialPlan=function(){return this.isPlusTrial()||this.isProfessionalTrial()},t.prototype.isPlusTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===P.ProductPlanType.TRIAL||e.subState.plan.productType===P.ProductPlanType.PLUS_TRIAL)},t.prototype.isProfessionalTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.PROFESSIONAL_TRIAL},t.prototype.isLicensePlan=function(){var e=this.props,t=e.hasLicenseKey,a=e.paymentInfo;return!!a&&(t||m.isLicenseKey(a.gateway_id))},t.prototype.renderLoginInstructions=function(e){var t,a;return a=this.props.userEmail?this.props.userEmail:s.intl.formatMessage({id:"fZ1ZfV",defaultMessage:"the account user"}),t=e===N.Cancel?s.intl.formatMessage({id:"diOSTv",defaultMessage:"Please login as {email}{br}to cancel your plan."},{br:i.default.createElement("br",null),email:a}):e===N.Change?s.intl.formatMessage({id:"7/qGqI",defaultMessage:"Please login as {email}{br}to change your plan."},{br:i.default.createElement("br",null),email:a}):e===N.Manage?s.intl.formatMessage({id:"yHAcZL",defaultMessage:"Please login as {email}{br}to manage your plan."},{br:i.default.createElement("br",null),email:a}):e===N.Upgrade?s.intl.formatMessage({id:"EYQ0Wr",defaultMessage:"Please login as {email}{br}to upgrade your plan."},{br:i.default.createElement("br",null),email:a}):s.intl.formatMessage({id:"wBh1Uk",defaultMessage:"Please login as {email}."},{email:a}),i.default.createElement("div",{className:"plan-status-section__login-msg"},t)},t.prototype.getUserForModal=function(){var e=this.props,t=e.isPersonalUser,a=e.useSpecifiedRole,n=e.isLoggedInAsTransactionOwner,i=null;if(a&&n){var o=l.Viewer.get_viewer();i=t?o.personal_user?o.personal_user.id:null:o.work_user?o.work_user.id:null,c.assert(null!=i,"Could not find user for specified role; modal will fail")}return i},t.prototype.renderDropboxLogo=function(){return i.default.createElement(H,{className:"plan-status-section__icon u-mar-right-s"},i.default.createElement("img",{src:f.static_url("/static/images/logo_catalog/dropbox-business-icon_m1_v2-vflfKjGis.svg"),alt:""}))},t.prototype.getTeamName=function(){return this.props.isLoggedInAsTransactionOwner&&l.Viewer.get_viewer().team_name?l.Viewer.get_viewer().team_name:this.props.teamName?this.props.teamName:null},t.prototype.renderManagePlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(N.Manage):i.default.createElement(q,{className:"plan-status-section__upgrade_btn"},i.default.createElement(C.Button,{variant:"transparent",className:"button-tertiary",onClick:this.managePlanClick},s.intl.formatMessage({id:"RBsGH7",defaultMessage:"Manage plan"})))},t.prototype.renderBusinessPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isTeamAdmin,n=e.scheduledForDowngrade,o=e.showCancelButton;if(t&&t.subState.isDeactivatedTeam)return this.renderBasicPlanSection();if(t&&t.subState.plan){var r=t.subState.plan.productType===P.ProductPlanType.STANDARD,d=t.subState.plan.displayName(!1,r);r||(d=s.intl.formatMessage({id:"15/NF/",defaultMessage:"{trade_mark} {plan_title}"},{trade_mark:M.TRADEMARK_BUSINESS,plan_title:d}));var c,u,p="",m=this.getTeamName();m&&(a?(p=s.intl.formatMessage({id:"TcIDqw",defaultMessage:"You’re an admin of the {team_name} Dropbox account."},{team_name:m}),this.props.isLoggedInAsTransactionOwner||(p=s.intl.formatMessage({id:"J98s/Q",defaultMessage:"This account is an admin of the {team_name} Dropbox account."},{team_name:m}))):(p=s.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:m}),this.props.isLoggedInAsTransactionOwner||(p=s.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:m}))));var g=l.Viewer.get_viewer();if(this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner)c=this.renderLoginInstructions(),u=null;else if(a||!this.props.isLoggedInUser){var f=t.subState.plan.productType;if(f===P.ProductPlanType.STANDARD||f===P.ProductPlanType.NEW_STANDARD||f===P.ProductPlanType.STANDARD_TRIAL?c=this.renderChangePlanButton(!0):f!==P.ProductPlanType.ADVANCED&&f!==P.ProductPlanType.ADVANCED_TRIAL||(c=this.renderManagePlanButton()),o&&(c=n?this.renderManagePlanButton():this.renderCancelPlanButton()),!t.subState.plan.isEnterprise){var _=s.intl.formatMessage({id:"pHsXLD",defaultMessage:"Manage your team in the Admin Console"});this.props.isLoggedInAsTransactionOwner||(_=s.intl.formatMessage({id:"FbWoPF",defaultMessage:"Manage this team in the Admin Console"})),u=i.default.createElement("p",null,i.default.createElement("a",{className:"plan-status-section__link account-page__link",href:"/team/admin/billing/manage"},_))}}else!a&&g.is_paired&&(u=i.default.createElement("p",null,s.intl.formatMessage({id:"7bN4Js",defaultMessage:"Looking for details on another plan?"})," ",i.default.createElement(V,{className:"plan-status-section__link plan-status-section__link--inline account-page__link",href:"/account/plan?role=personal"},s.intl.formatMessage({id:"JejsPF",defaultMessage:"Visit your personal account page."}))));var h="";return this.props.showTeamScheduledForDowngrade&&n&&(h=s.intl.formatMessage({id:"D26Tzh",defaultMessage:"Any active members of your {plan} team will be downgraded to Dropbox Basic accounts on {date}."},{plan:d,date:t.formattedNextBillingDate}),this.props.isLoggedInAsTransactionOwner||(h=s.intl.formatMessage({id:"fBp3Tk",defaultMessage:"Any active members of the {plan} team will be downgraded to Dropbox Basic accounts on {date}."},{plan:d,date:t.formattedNextBillingDate}))),i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},d),i.default.createElement("span",null,p),i.default.createElement("br",null),i.default.createElement("span",null,h),u),c)}},t.prototype.showBasicPlanWithTrial=function(){var e=this.props.trialsConfig;return e&&e.trialBanner&&e.currentPlan&&e.currentPlan.skuContent&&e.currentPlan.skuContent.name===M.TRADEMARK_BASIC},t.prototype.renderUpgradePlanButton=function(e){return this.props.trialsConfig&&this.props.trialsConfig.trialBanner?i.default.createElement("div",null):this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(N.Upgrade):(this.isOverQuota()&&this.logUpgradeOverquotaBtn("view"),i.default.createElement(q,{className:"plan-status-section__upgrade_btn"},i.default.createElement(C.Button,{variant:"primary",className:"jest-upgrade-plan-button",onClick:this.onUpgradePlanButtonClick},e)))},t.prototype.renderBasicPlanSection=function(){var e,t=this.props,a=t.subStatus,n=t.isLimitedTeam,o=t.isLockedTeam,l=t.isPaidTeam,r=M.DROPBOX_BASIC;if(a){o&&(null===(e=a.subState.planSku)||void 0===e?void 0:e.content)?r=p.getLockedTeamPlanName(l,a.subState.planSku.content.dropboxDisplayName()):!this.showBasicPlanWithTrial()&&a.subState.plan&&(r=a.subState.plan.displayName());var d=void 0;if(n||a.subState.isDeactivatedTeam){var c=this.getTeamName(),u=s.intl.formatMessage({id:"jgGyr5",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:c});this.props.isLoggedInAsTransactionOwner||(u=s.intl.formatMessage({id:"2c6DhA",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:c})),d=i.default.createElement(W,{className:"plan-status-section__team_desc"},u)}var m=this.isOverQuota()?s.intl.formatMessage({id:"F2lDMN",defaultMessage:"Upgrade now"}):s.intl.formatMessage({id:"IqV88I",defaultMessage:"Upgrade"}),g=this.renderUpgradePlanButton(m);return i.default.createElement(E.BasicPlanStatusSection,{planName:r,plansUrl:this.plansURL,limitedTeam:d,upgradePlanButton:g,hidePlansLink:this.isExternallyManagedSubscription,hideUpgradeButton:o})}},t.prototype.renderResellerPlan=function(){var e=s.intl.formatMessage({id:"mAtx6/",defaultMessage:"Dropbox {plus} 1TB"},{plus:M.TRADEMARK_PLUS});return i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},e),i.default.createElement(U,{className:"plan-status-section__title_description"},this.renderBillingPeriod())))},t.prototype.renderPaidPlanSection=function(){var e=this.props,t=e.subStatus,a=e.evhInfo,n=e.isLimitedTeam,o=e.hasUnusedLicenseKey,l=e.paymentInfo,r=e.scheduledForDowngrade,d=e.isLoggedInAsTransactionOwner,c=e.showCancelButton;if(t&&t.scheduledSubState&&t.subState.plan){var u,g=t.subState.plan,f=p.getPaidPlanNameWithAddOns(g,a,!1,this.getGatewayId()),_=void 0,y=void 0,v="";if(l&&m.shouldHideBillingSummary(l.gateway_id,t.subState.plan.productType)?v="":t.nextBillingSummary&&t.finalSubState.billingSchedule&&(v=s.intl.formatMessage({id:"sWfgaw",defaultMessage:"{total} per {period}."},{total:h.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary),period:t.finalSubState.billingSchedule.scheduleDescriptionNoun})),o&&(v=s.intl.formatMessage({id:"E5PyhP",defaultMessage:"Your license key will be activated and no charge made to your payment method on file."}),d||(v=s.intl.formatMessage({id:"Yutfxu",defaultMessage:"This account’s license key will be activated and no charge made to the payment method on file."}))),!this.isExternallyManagedSubscription){var b="";if(this.pendingScheduledChange()&&t.scheduledSubState&&t.scheduledSubState.plan&&t.scheduledSubState.billingSchedule){var P=t.scheduledSubState.plan,S=p.getPaidPlanNameWithAddOns(P,a,!0);b=s.intl.formatMessage({id:"HLknNq",defaultMessage:"Starting on {date}, we’ll bill you once a {new_period_noun} for your {plan} plan. Your new {new_period_adj} total will be {new_amount}."},{date:t.formattedNextBillingDate,new_period_noun:t.scheduledSubState.billingSchedule.scheduleDescriptionNoun,plan:S,new_period_adj:t.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,new_amount:h.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}),d||(b=s.intl.formatMessage({id:"c9VDND",defaultMessage:"Starting on {date}, we’ll bill this account once a {new_period_noun} for the {plan} plan. This account’s new {new_period_adj} total will be {new_amount}."},{date:t.formattedNextBillingDate,new_period_noun:t.scheduledSubState.billingSchedule.scheduleDescriptionNoun,plan:S,new_period_adj:t.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,new_amount:h.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}))}else this.isFamilyNonPayerPlan()?b=s.intl.formatMessage({id:"w5oksG",defaultMessage:"You’re a member of the {family} plan."},{family:g.displayName()}):(b=s.intl.formatMessage({id:"pO8IP6",defaultMessage:"Your {plan} plan will renew on {date}. {billing_summary}"},{plan:f,date:t.formattedNextBillingDate,billing_summary:v}),d||(b=s.intl.formatMessage({id:"Ofo1Y4",defaultMessage:"This account’s {plan} plan will renew on {date}. {billing_summary}"},{plan:f,date:t.formattedNextBillingDate,billing_summary:v})));_=i.default.createElement("span",{className:"plan-status-section__description-content"},b," ")}if(r){var M=s.intl.formatMessage({id:"DbT6E7",defaultMessage:"Your {plan} will downgrade to Dropbox Basic on {date}."},{plan:f,date:t.formattedNextBillingDate});d||(M=s.intl.formatMessage({id:"KxyGh1",defaultMessage:"This account’s {plan} will downgrade to Dropbox Basic on {date}."},{plan:f,date:t.formattedNextBillingDate})),_=i.default.createElement("span",null,M," ")}if(n){var C=this.getTeamName(),E=s.intl.formatMessage({id:"X0wsLF",defaultMessage:"You’re a member of the {team_name} Dropbox account."},{team_name:C});d||(E=s.intl.formatMessage({id:"/IIBtR",defaultMessage:"This account is a member of the {team_name} Dropbox account."},{team_name:C})),y=i.default.createElement(W,{className:"plan-status-section__team_desc"},E)}return this.isExternallyManagedSubscription||this.isInStandardSchedule()||(u=this.renderContactSupportLink()),this.canShowChangePlan(!1)&&(u=this.renderChangePlanButton(!1)),c&&!r&&(u=this.renderCancelPlanButton()),(this.isFreePlusPlan()||o)&&(u=this.renderContactSupportLink()),i.default.createElement("div",null,i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},f),y,i.default.createElement(U,{className:"plan-status-section__title_description"},_,!o&&this.renderPlanDetails(),i.default.createElement("br",null),this.renderBillingPeriod())),u))}},t.prototype.renderPlanDetails=function(){if(!this.isHSProPlan()){if(this.isFamilyPlan())return i.default.createElement("a",{className:"plan-status-section__link account-page__link",onClick:this.logSeePlanDetails,href:"/help/accounts-billing/plans-upgrades/dropbox-family-plan",target:"_blank",rel:"noopener noreferrer"},s.intl.formatMessage({id:"um7qHG",defaultMessage:"What’s included?"}));var e=void 0;if(this.isTaurusPlan()){if(this.isExternallyManagedSubscription)return;e=s.intl.formatMessage({id:"RuKlo2",defaultMessage:"See plan details"})}else if(this.isBackupPlan())e=s.intl.formatMessage({id:"3hCG9P",defaultMessage:"See plan info"});else{if(this.isExternallyManagedSubscription)return;e=s.intl.formatMessage({id:"VEb96o",defaultMessage:"See available plans"})}return i.default.createElement("a",{className:"plan-status-section__link account-page__link jest-see-plan-details-btn",onClick:this.logSeePlanDetails,href:this.plansURL,target:"_blank",rel:"noopener noreferrer"},e)}},t.prototype.renderTrialSection=function(){var e=this.props,t=e.subStatus,a=e.paymentInfo;if(t&&t.subState&&t.subState.plan&&a){var n=a.gateway_id,o=a.trial_info;if(o){var l=i.default.createElement("noscript",null);m.isIOS(n)||m.isAndroid(n)||(l=this.createTrialCtaButtons(!o.is_trial_overdue,this.isProfessionalTrial()));var r,d=s.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:t.subState.plan.displayName(!1,!1,n)});return o.is_trial_overdue&&(d+=" "+s.intl.formatMessage({id:"yI+MEC",defaultMessage:"(Expired)"})),r=this.isProfessionalTrial()?m.getProfessionalTrialPlanDescription(t):m.getTrialDescription(n,o,t.formattedNextBillingDate),i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},d),i.default.createElement(U,{className:"plan-status-section__title_description"},r," ",this.isProfessionalTrial()&&i.default.createElement("span",null,this.renderPlanDetails(),i.default.createElement("br",null),this.renderBillingPeriod()))),l)}}},Object.defineProperty(t.prototype,"hasSelfServablePaymentAfterLicensekey",{get:function(){var e=this.props.paymentInfo;return e&&!m.isLicenseKey(e.gateway_id)&&!m.shouldHidePaymentMethod(e.gateway_id)},enumerable:!1,configurable:!0}),t.prototype.renderLicensePlanSection=function(){var e=this.props.subStatus;if(!e||!e.subState||!e.subState.plan)return i.default.createElement("noscript",null);var t=s.intl.formatMessage({id:"625HOw",defaultMessage:"Dropbox {plus}"},{plus:e.subState.plan.displayName()}),a=i.default.createElement("noscript",null);if(this.props.hasUnusedLicenseKey){var n=s.intl.formatMessage({id:"jQ1eDP",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. Your next license key will be activated on {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate});this.props.isLoggedInAsTransactionOwner||(n=s.intl.formatMessage({id:"yXjZBq",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The next license key will be activated on {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate}));var o=i.default.createElement("noscript",null);if(this.hasSelfServablePaymentAfterLicensekey)o=i.default.createElement("div",null,s.intl.formatMessage({id:"flOh9z",defaultMessage:"No charge made to your payment method on file."})),this.props.isLoggedInAsTransactionOwner||(o=i.default.createElement("div",null,s.intl.formatMessage({id:"c1bGK9",defaultMessage:"No charge made to the payment method on file."})));else{var l=s.intl.formatMessage({id:"nswDHh",defaultMessage:"You can add your payment information now to have your subscription automatically renew when your keys expire."});this.props.isLoggedInAsTransactionOwner||(l=s.intl.formatMessage({id:"/Xs7Nm",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when the keys expire."})),o=i.default.createElement("div",null,l,i.default.createElement("br",null),i.default.createElement("a",{href:"#",onClick:this.addPaymentClick},s.intl.formatMessage({id:"2zkZ/z",defaultMessage:"Add payment method."})))}a=i.default.createElement("div",null,n,i.default.createElement("br",null),o)}else if(this.hasSelfServablePaymentAfterLicensekey&&!this.props.scheduledForDowngrade){var r=e.scheduledSubState.billingSchedule.scheduleDescriptionNoun,d=s.intl.formatMessage({id:"QoelR9",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),c=s.intl.formatMessage({id:"DrEa0N",defaultMessage:"{new_total} per {new_period} will be charged to your payment method on file."},{new_total:h.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:r});this.props.isLoggedInAsTransactionOwner||(d=s.intl.formatMessage({id:"kQDw1e",defaultMessage:"This Dropbox {plus} plan was activated with a license key. The plan will renew on {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),c=s.intl.formatMessage({id:"xhxvHj",defaultMessage:"{new_total} per {new_period} will be charged to the payment method on file."},{new_total:h.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:r})),a=i.default.createElement("div",null,d,i.default.createElement("br",null),c,i.default.createElement("br",null),this.renderBillingPeriod())}else{d=s.intl.formatMessage({id:"6ejtCb",defaultMessage:"Your Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate});var u=s.intl.formatMessage({id:"vNTGeR",defaultMessage:"You can add your payment information now to have your subscription automatically renew when it expires."});this.props.isLoggedInAsTransactionOwner||(d=s.intl.formatMessage({id:"uTD2X0",defaultMessage:"This account’s Dropbox {plus} plan was activated with a license key. The plan is active until {date}."},{plus:M.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),u=s.intl.formatMessage({id:"fEZEwT",defaultMessage:"The account owner can add payment information now to have this subscription automatically renew when it expires."})),a=i.default.createElement("div",null,d,i.default.createElement("br",null),u,i.default.createElement("br",null),i.default.createElement("a",{href:"#",onClick:this.addPaymentClick},s.intl.formatMessage({id:"fSZaj1",defaultMessage:"Add payment method."})))}return i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},t),i.default.createElement(U,{className:"plan-status-section__title_description"},a)),this.renderContactSupportLink())},t.prototype.render1TBChangeablePlan=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(!t||!t.subState||!t.subState.plan)return i.default.createElement("noscript",null);var n=t.subState.plan.displayName(!0),o="";t.subState.billingSchedule&&t.subState.billingSchedule.scheduleDescriptionNoun&&t.currentBillingSummary&&t.currentBillingSummary.total&&(o=s.intl.formatMessage({id:"fRlyEz",defaultMessage:"{total} per {period}."},{total:h.Cash.formatWithTaxLabels(t.currentBillingSummary.total,t.currentBillingSummary),period:t.subState.billingSchedule.scheduleDescriptionNoun}));var l=i.default.createElement("noscript",null);if(!this.isExternallyManagedSubscription){var r=s.intl.formatMessage({id:"BIh4SD",defaultMessage:"Your {plan} plan will renew on {date}. {billing_summary}"},{plan:n,date:t.formattedNextBillingDate,billing_summary:o});this.props.isLoggedInAsTransactionOwner||(r=s.intl.formatMessage({id:"E6SULc",defaultMessage:"This account’s {plan} plan will renew on {date}. {billing_summary}"},{plan:n,date:t.formattedNextBillingDate,billing_summary:o})),l=i.default.createElement("span",null,r)}if(a){var d=s.intl.formatMessage({id:"Ul0kIv",defaultMessage:"Your {plan} will downgrade to Dropbox Basic on {date}. {billing_summary}"},{plan:n,date:t.formattedNextBillingDate,billing_summary:o});this.props.isLoggedInAsTransactionOwner||(d=s.intl.formatMessage({id:"+pnXuI",defaultMessage:"This account’s {plan} will downgrade to Dropbox Basic on {date}. {billing_summary}"},{plan:n,date:t.formattedNextBillingDate,billing_summary:o})),l=i.default.createElement("span",null,d)}var c=this.renderContactSupportLink();return i.default.createElement(R,{className:"plan-status-section"},this.renderDropboxLogo(),i.default.createElement(O,{className:"plan-status-section__description"},i.default.createElement(F,{className:"plan-status-section__title"},n),i.default.createElement(U,{className:"plan-status-section__title_description"},l,i.default.createElement("br",null),this.renderBillingPeriod())),c)},t.prototype.renderPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isExternallyBilled,n=e.paymentInfo,i=e.isLimitedTeam,o=e.eligibleFor1tb;return this.showBasicPlanWithTrial()?this.renderBasicPlanSection():o?this.render1TBChangeablePlan():a&&void 0!==n&&null!==n.reseller_name?this.renderResellerPlan():a&&i&&void 0!==n&&n.gateway_id===g.NOT_APPLICABLE?void 0:t&&t.subState.plan&&[P.ProductFamily.PRO,P.ProductFamily.FAMILY].includes(t.subState.plan.productFamily)?this.isTrialPlan()?this.renderTrialSection():this.isLicensePlan()?this.renderLicensePlanSection():this.renderPaidPlanSection():this.renderBasicPlanSection()},t.prototype.render=function(){var e=this.props,t=e.isPersonalUser,a=e.isLimitedTeam,n=t||a?this.renderPlanSection():this.renderBusinessPlanSection();return i.default.createElement(K,{className:"plan-status"},n)},t})(i.default.Component);t.PlanStatus=se})),define("modules/clean/account_page/widgets/plan/views/update_billing_info",["require","exports","tslib","react","modules/core/i18n","dig-components/buttons"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateBillingInfoButton=t.UpdateBillingInfoLink=void 0,n=a.__importDefault(n),t.UpdateBillingInfoLink=function(e){var t=e.className,a=e.updateBillingCTA;return n.default.createElement("a",{key:"updateBillingInfo",className:t||"",href:"#",onClick:function(e){e.stopPropagation(),e.preventDefault(),a(e)}},i.intl.formatMessage({id:"ipgitK",defaultMessage:"Update billing information"}))},t.UpdateBillingInfoButton=function(e){var t=e.updateBillingCTA;return n.default.createElement(o.Button,{variant:"transparent",onClick:function(e){e.stopPropagation(),e.preventDefault(),t(e)}},i.intl.formatMessage({id:"LcZnrF",defaultMessage:"Update billing info"}))}})),define("modules/clean/family/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_LICENSES=t.getFamilyJoinUrl=t.FAMILY_INVITE_URI_PATH_SUCCESS=t.FAMILY_INVITE_URI_PATH=t.FAMILY_HOME_PATH=void 0,t.FAMILY_HOME_PATH="/h",t.FAMILY_INVITE_URI_PATH="/family/invite",t.FAMILY_INVITE_URI_PATH_SUCCESS="/family/invite?success",t.getFamilyJoinUrl=function(e){return"/family/join/"+e},t.MAX_LICENSES=6})),define("modules/clean/react/growth/trials/util",["require","exports","tslib","modules/clean/react/growth/util","modules/clean/api_v2/user_client","modules/clean/payments/skus/constants"],(function(e,t,a,n,i,o){"use strict";function l(e){return{href:e.href,onClickType:e.on_click_type,text:e.text}}var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getTransitionChangeType=t.PerformPlanTransitionForTrials=t.fetchModalConfig=t.formatCtaConfigResult=void 0,t.formatCtaConfigResult=l,t.fetchModalConfig=function(e){return a.__awaiter(this,void 0,Promise,(function(){var t,o,r,s,d,c,u,p,m,g,f;return a.__generator(this,(function(a){switch(a.label){case 0:if(t={primaryCTA:{}},!(o=n.getActiveUserId()))return[3,5];r=new i.UserApiV2Client,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,r.ns("trials").rpc("get_trials_modal_config",{modal_type:e},{subjectUserId:o})];case 2:return s=a.sent(),d=s.description,c=s.features,u=s.heading,p=s.primary_cta,m=s.secondary_cta,g=p?l(p):void 0,f=m?l(m):void 0,[2,{description:d,features:c,heading:u,primaryCTA:g,secondaryCTA:f}];case 3:return a.sent(),[2,t];case 4:return[3,6];case 5:return[2,t];case 6:return[2]}}))}))},(function(e){e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL"})(r=t.PerformPlanTransitionForTrials||(t.PerformPlanTransitionForTrials={})),t.getTransitionChangeType=function(e){if(e.finalSubState.planSku){if(e.finalSubState.planSku.productType===o.ProductPlanType.PLUS)return r.PLUS;if(e.finalSubState.planSku.productType===o.ProductPlanType.PROFESSIONAL)return r.PROFESSIONAL}return null}})),define("modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader",["require","exports","tslib","modules/core/notify","react","modules/clean/react/css","modules/clean/react/sprite","modules/core/uri","modules/core/i18n","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/payments/validation","modules/clean/react/modal","dig-components/modal","dig-components/typography","spectrum/button","modules/clean/static_urls","modules/clean/react/tooltip","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_as_promised_jquery","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_,h,y,v){"use strict";function b(e){return function(t){return null==t||t.length<=e}}function P(e,t){return i.default.createElement(_.Tooltip,{position:_.TooltipPosition.RIGHT,tooltip_contents:t},e,i.default.createElement(l.Sprite,{group:"web",name:"info",className:"info-sprite",alt:""}))}Object.defineProperty(t,"__esModule",{value:!0}),t.EditInvoiceAddressModalLoader=void 0,i=a.__importDefault(i),u=a.__importStar(u);var S=s.intl.formatMessage({id:"F5ADP7",defaultMessage:"Country and postal code must match your account’s payment information."}),M=s.intl.formatMessage({id:"XjVAbc",defaultMessage:"Your tax rate on this invoice cannot be updated."}),C={addressName:s.intl.formatMessage({id:"B6dG2q",defaultMessage:"Billing name"}),address:s.intl.formatMessage({id:"fz9og9",defaultMessage:"Billing address"}),city:s.intl.formatMessage({id:"QnFif0",defaultMessage:"City"}),state:s.intl.formatMessage({id:"pyUCBn",defaultMessage:"State"}),zip:P(s.intl.formatMessage({id:"10Ms2o",defaultMessage:"Postal code"}),S),country:P(s.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),S),exclusionId:s.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),exclusionIdWithTooltip:P(s.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),M)},E=(function(e){function o(t){var n=e.call(this,t)||this;return n.disableds={addressName:!1,address:!1,city:!1,state:!1,zip:!0,country:!0,exclusionId:!1,exclusionIdWithTooltip:!1},n.addressNameLength=100,n.addressLength=250,n.cityLength=50,n.stateLength=50,n.vatLength=25,n.undefinedLength=void 0,n.validateHandlers={addressName:b(n.addressNameLength),address:b(n.addressLength),city:b(n.cityLength),state:b(n.stateLength),zip:function(){return!0},country:function(){return!0},exclusionId:function(){return!0},exclusionIdWithTooltip:function(){return!0}},n.maxLengths={addressName:n.addressNameLength,address:n.addressLength,city:n.cityLength,state:n.stateLength,zip:n.undefinedLength,country:n.undefinedLength,exclusionId:n.vatLength,exclusionIdWithTooltip:n.vatLength},n.errorTexts={addressName:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),address:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),city:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),state:s.intl.formatMessage({id:"M9vy6c",defaultMessage:"Too long"}),zip:"",country:"",exclusionId:"",exclusionIdWithTooltip:""},n.onSave=function(){var e=n.state.formState,t=n.props.invoice;if(e)if(n.logActions("edit_billing_address_started"),n.setState({submitting:!0}),n.isInputValid()){var a={address_name:e.addressName,address:e.address,city:e.city,state:e.state,exclusion_id:e.exclusionId};t&&(a.invoice_id=r.URI.parse(t.link).getQuery().id.toString()),n.makeEditBillingAddressRequest(a)}else n.setState({submitting:!1,showErrors:!0})},n.onCancel=function(){n.logActions("edit_billing_address_cancelled"),n.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))},n.state={submitting:!1,showErrors:!1,open:!0},t.isTeam?(n.editUrl="/edit_billing_address",n.viewModelUrl="/edit_billing_address_view_model",n.vatClass="grid__item--1-1",n.modalClass="edit-invoice-modal"):(n.editUrl="/edit_billing_address_individual",n.viewModelUrl="/edit_billing_address_individual_view_model",n.vatClass="grid__item--1-2",n.modalClass="edit-invoice-modal professional-modal"),n}return a.__extends(o,e),o.showInstance=function(e,a){var n=i.default.createElement(t.EditInvoiceAddressModalLoader,{invoice:e,isTeam:a});u.Modal.showInstance(n)},o.showUpdateTaxProfileModal=function(e,a){var n=i.default.createElement(t.EditInvoiceAddressModalLoader,{isTeam:e,onUpdated:a});u.Modal.showInstance(n)},o.prototype.componentDidMount=function(){var e,t=void 0;this.props.invoice&&(t=null===(e=r.URI.parse(this.props.invoice.link).getQuery().id)||void 0===e?void 0:e.toString(),this.disableds.exclusionIdWithTooltip=!0),this.makeRequest(t)},o.prototype.makeRequest=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,n;return a.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t={invoice_id:e},[4,y.WebRequest({url:this.viewModelUrl,data:t,dataType:"json"})];case 1:return n=i.sent(),c.hasVat(n.countryCode)&&(this.errorTexts.exclusionId=s.intl.formatMessage({id:"LW2miv",defaultMessage:"Please enter a valid VAT number, e.g. {examples}."},{examples:c.getVatExamples(n.countryCode).join(", ")}),this.validateHandlers.exclusionId=function(e){return!e||c.validateVat(n.countryCode,e)}),this.setState({formState:n}),[3,3];case 2:return i.sent(),this.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),[3,3];case 3:return[2]}}))}))},o.prototype.render=function(){var e,t=this.state,a=t.formState,n=t.showErrors,o=t.submitting,l=this.props,r=l.isTeam,d=l.invoice;if(a){var _=null;if(c.hasVat(a.countryCode)){var h=c.getVatPrefix(a.countryCode);_=d?this.renderInput("exclusionIdWithTooltip",this.vatClass):this.renderInput("exclusionId",this.vatClass,h)}e=r?i.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInstructions(a.countryCode),this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-1"),this.renderInput("city","grid__item--1-2"),this.renderInput("state","grid__item--11-24"),this.renderInput("zip","grid__item--7-24"),this.renderInput("country","grid__item--2-3"),_):i.default.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-2"),this.renderInput("city","grid__item--1-4"),this.renderInput("state","grid__item--1-4"),this.renderInput("zip","grid__item--1-2"),this.renderInput("country","grid__item--1-2"),_,this.renderInstructions(a.countryCode))}else e=i.default.createElement("div",{className:"loading-spinner"},i.default.createElement("img",{src:f.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:s.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}));var y=i.default.createElement(p.Modal.Footer,{hasTopBorder:!r,className:"oq-modal__buttons"},i.default.createElement(g.Button,{className:"edit-invoice-modal__cancel-button",variant:"secondary",onClick:this.onCancel},s.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"})),i.default.createElement(g.Button,{disabled:!a||o||n&&!this.isInputValid(),variant:"primary",onClick:this.onSave},s.intl.formatMessage({id:"F5NZs5",defaultMessage:"Save changes"})));return i.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:s.intl.formatMessage({id:"bv7A4+",defaultMessage:"Close"}),onRequestClose:this.onCancel,overlayClassName:this.modalClass,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close},i.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(m.Title,{color:"faint",isBold:!1,size:"small"},s.intl.formatMessage({id:"/WFCIJ",defaultMessage:"Edit invoice details"}))),i.default.createElement(p.Modal.Body,null,i.default.createElement("div",{className:"dynamic-content"},e)),y)},o.prototype.logActions=function(e){this.props.isTeam?h.TeamsWebActionsLogger.log(e):h.UserActivityLogger.log("web",e)},o.prototype.makeEditBillingAddressRequest=function(e){return a.__awaiter(this,void 0,void 0,(function(){var t,i,o,l,r;return a.__generator(this,(function(d){switch(d.label){case 0:t=this.props,i=t.onUpdated,o=t.isTeam,l=v.getSubscriptionAMPLogger({ns:o?"team":"personal",modal:v.ModalTypes.EDIT_INVOICE_MODAL}),d.label=1;case 1:return d.trys.push([1,3,4,5]),r=this.editUrl,[4,y.WebRequest({url:r,data:e})];case 2:return d.sent(),this.logActions("edit_billing_address_success"),n.Notify.success(s.intl.formatMessage({id:"Il5prr",defaultMessage:"Invoice details updated."})),l.logModalSuccess(),[3,5];case 3:return d.sent(),this.logActions("edit_billing_address_edit_failure"),l.logModalError("modal_submit"),[3,5];case 4:return i&&i(),this.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),[7];case 5:return[2]}}))}))},o.prototype.renderInstructions=function(e){var t,a=this.props.invoice;if(t=a?s.intl.formatMessage({id:"Wc4dM+",defaultMessage:"You are editing details for the {date} invoice."},{date:a.date}):s.intl.formatMessage({id:"MhniSh",defaultMessage:"You are editing details for all future invoices. To edit past invoices, click “Edit” on the invoice item instead."}),c.hasVat(e)){var n=s.intl.formatMessage({id:"Qyx8hc",defaultMessage:"Please note that changing your VAT number could impact your applicable tax rate."});a&&(n=s.intl.formatMessage({id:"q3KPUy",defaultMessage:"To add or change a VAT number or request a tax refund, contact support."})),t=t.concat(" ",n)}return i.default.createElement(m.Text,{variant:"paragraph",size:"small",color:"faint",className:"grid__item--1-1 instructions"},t)},o.prototype.renderInput=function(e,t,a){var n=this.state,o=n.formState,l=n.showErrors,r="";return o&&(r=o[e]),i.default.createElement(d.ArborTextInput,{name:e,id:e,containerClassName:t,isValid:l?!!this.validateHandlers[e](r)&&"":"",labelText:C[e],errorText:this.errorTexts[e],value:r,onChange:this.onChangeFactory(e),disabled:this.disableds[e],placeholderText:a,maxLength:this.maxLengths[e]})},o.prototype.onChangeFactory=function(e){var t=this;return function(a,n,i){var o=t.state.formState;o&&t.setState((function(t){return o[e]=i,t}))}},o.prototype.isInputValid=function(){var e=this.state.formState;return!!e&&(this.validateHandlers.addressName(e.addressName)&&this.validateHandlers.address(e.address)&&this.validateHandlers.city(e.city)&&this.validateHandlers.state(e.state)&&this.validateHandlers.exclusionId(e.exclusionId))},o})(i.default.Component);t.EditInvoiceAddressModalLoader=o.requireCssWithComponent(E,["/static/css/payments/edit_invoice_address_modal/edit_invoice_address_modal-vflTqEhcT.css"])})),define("modules/clean/react/payments/downgrade/components/downgrade_family_manager_data",["require","exports","tslib","react","spectrum/checkbox","modules/core/i18n","modules/clean/react/css","modules/clean/display_format","modules/constants/trademark","modules/clean/react/payments/downgrade/components/downgrade_helpers","dig-components/icons","dig-components/icons/src","modules/clean/dropbox_form","family/common/features"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DowngradeFamilyManagerData=t.DowngradeFamilyManagerHeader=t.DowngradeFamilyManagerFooter=t.DowngradeFamilyFeatureItem=t.DowngradeFamilyManagerDataView=void 0;var g=(function(e){function l(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={disbandFamilyAcknowledged:!1,overQuotaAcknowledged:!1,familySharedFolderAcknowledged:!1},t.handleDisbandFamilyAcknowledgment=function(e){t.setState({disbandFamilyAcknowledged:!t.state.disbandFamilyAcknowledged})},t.handleOverQuotaAcknowledgment=function(e){t.setState({overQuotaAcknowledged:!t.state.overQuotaAcknowledged})},t.handleFamilySharedFolderAcknowledgement=function(e){t.setState({familySharedFolderAcknowledged:!t.state.familySharedFolderAcknowledged})},t.hasFamilySharedFolder=function(){var e;return!!(null===(e=t.props.familyFeatureFlags)||void 0===e?void 0:e[m.FAMILY_FEATURE_FLAGS.HAS_FAMILY_SHARED_FOLDER])},t.renderFamilyAcknowledgements=function(){var e=t.props.freeQuota,a=t.hasFamilySharedFolder(),l=t.state,d=l.overQuotaAcknowledged,c=l.disbandFamilyAcknowledged,u=l.familySharedFolderAcknowledged;return n.default.createElement("div",null,n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{className:"family-payer-disband-downgrade-check disband-acknowledgement",checked:c?"checked":"unchecked",onChange:t.handleDisbandFamilyAcknowledgment}),n.default.createElement("p",null,o.intl.formatMessage({id:"gMMxaZ",defaultMessage:"You and every member of your {trademark_family} plan will be downgraded to {dropbox_basic}, which only allows up to {free_quota} of storage."},{trademark_family:s.TRADEMARK_FAMILY,dropbox_basic:s.DROPBOX_BASIC,free_quota:r.format_bytes(e,0)}))),n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{className:"family-payer-disband-downgrade-check over-quota-acknowledgement",checked:d?"checked":"unchecked",onChange:t.handleOverQuotaAcknowledgment}),n.default.createElement("p",null,o.intl.formatMessage({id:"Uu4dKU",defaultMessage:"If you or a member of your plan are using more than {free_quota} of storage, you’ll be over-quota. That means your files will stop syncing, you won’t be able to upload any new files or folders, and you won’t be able to restore earlier versions of your files."},{free_quota:r.format_bytes(e,0)}))),a&&n.default.createElement("div",{className:"family-payer-disband-downgrade"},n.default.createElement(i.Checkbox,{checked:u?"checked":"unchecked",className:"family-payer-disband-downgrade-check","data-testid":"family-shared-folder-acknowledgement",onChange:t.handleFamilySharedFolderAcknowledgement}),n.default.createElement("p",null,o.intl.formatMessage({id:"jaE2Yv",defaultMessage:"Your Family Room folder will dissolve. All members will receive a copy of the folder in their Dropbox."}))))},t}return a.__extends(l,e),l.prototype.shouldDisableConfirmDowngradeButton=function(){return!this.state.overQuotaAcknowledged||!this.state.disbandFamilyAcknowledged||!(!this.hasFamilySharedFolder()||this.state.familySharedFolderAcknowledged)},l.prototype.render=function(){var e=d.createFamilyFeatureList(this.props.currentPlanSpace,this.props.basicDeviceLimit);return n.default.createElement("div",null,n.default.createElement(t.DowngradeFamilyManagerHeader,{handleChangeMindCTA:this.props.handleChangeMindCTA}),n.default.createElement("div",{className:"section section--features family-payer-benefits-section"},n.default.createElement("h3",{className:"type--title-4"},o.intl.formatMessage({id:"R07Z49",defaultMessage:"Without {dropbox_family}, you’ll lose access to the following:"},{dropbox_family:s.DROPBOX_FAMILY})),n.default.createElement("ul",{className:"features-list family-payer-features-list"},e.map((function(e,a){return n.default.createElement(t.DowngradeFamilyFeatureItem,{key:a,featureInfo:e})}))),n.default.createElement("div",null,n.default.createElement("p",null,o.intl.formatMessage({id:"I5xM/O",defaultMessage:"If you still want to cancel, please acknowledge the following:"})),this.renderFamilyAcknowledgements())),n.default.createElement(t.DowngradeFamilyManagerFooter,{shouldDisableConfirmDowngradeButton:this.shouldDisableConfirmDowngradeButton(),handleContactSupportCTA:this.props.handleContactSupportCTA,handleChangeMindCTA:this.props.handleChangeMindCTA}))},l.displayName="DowngradeFamilyManagerData",l})((n=a.__importDefault(n)).default.Component);t.DowngradeFamilyManagerDataView=g,t.DowngradeFamilyFeatureItem=function(e){var t=e.featureInfo,a=t.header,i=t.description;return n.default.createElement("li",{className:"features-list__item family-payer-features-list-item"},n.default.createElement(c.UIIcon,{src:u.CloseLine}),n.default.createElement("div",{className:"family-payer-downgrade-feature-description"},a,n.default.createElement("div",{className:"features-list__copy"},i)))},t.DowngradeFamilyManagerFooter=function(e){var t=e.handleContactSupportCTA,a=e.handleChangeMindCTA,i=e.shouldDisableConfirmDowngradeButton,l=[d.downgradePageButtonsMap[d.DowngradeButtonTypes.ContactSupport],d.downgradePageButtonsMap[d.DowngradeButtonTypes.StayWithFamily]];return n.default.createElement("section",{className:"section section--buttons family-payer-section-buttons"},n.default.createElement("div",{className:"section-content"},n.default.createElement("div",{className:"buttons"},l.map((function(e){return n.default.createElement("div",{key:e.type,className:"buttons__item"},n.default.createElement("h3",{className:"type--copy-large"},e.header),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:e,onClickCTA:(i=e.type,i===d.DowngradeButtonTypes.StayWithFamily?a:t)}));var i})),n.default.createElement("div",{className:"buttons__item downgrade-button"},n.default.createElement("h3",{className:"type--copy-large"},o.intl.formatMessage({id:"FkaCY0",defaultMessage:"I’m sure"})),n.default.createElement(p.DropboxForm,{action:"/downgrade/process",method:"post"},n.default.createElement(d.DowngradeConfirmationButton,{shouldDisableButton:i}))))))},t.DowngradeFamilyManagerHeader=function(e){return n.default.createElement("header",{className:"section section--hero family-payer-header-section"},n.default.createElement("div",{className:"section-content"},n.default.createElement("h1",{className:"type--title-2 type--first type--center"},o.intl.formatMessage({id:"TejRDA",defaultMessage:"Are you sure you want to cancel {dropbox_family}?"},{dropbox_family:s.DROPBOX_FAMILY})),n.default.createElement("h2",{className:"type--copy-standard"},o.intl.formatMessage({id:"Gj7aSc",defaultMessage:"You and your family members will lose access to the plan’s storage and features, <span>and your accounts will be downgraded to {dropbox_basic}.</span>"},{dropbox_basic:s.DROPBOX_BASIC,span:function(e){return n.default.createElement("span",{className:"quota-drop"},e)}})),n.default.createElement(d.DowngradePageButton,{isPrimaryButton:!0,buttonInfo:d.downgradePageButtonsMap[d.DowngradeButtonTypes.ChangedMind],onClickCTA:e.handleChangeMindCTA})))},t.DowngradeFamilyManagerData=l.requireCssWithComponent(g,["/static/css/pro/pages/downgrade-vfle_vhUD.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_billing_modal_loader",["require","exports","tslib","classnames","react","spectrum/button","modules/core/notify","modules/core/i18n","modules/clean/analytics","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/css","modules/clean/react/modal","dig-components/modal","dig-components/typography","modules/clean/static_urls","modules/clean/react/payments/unified_module/unified_payment_form_async","modules/clean/subscription/tools/amp_logger"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IndividualUpdateBillingModalLoader=void 0,n=a.__importDefault(n),i=a.__importDefault(i),d=a.__importStar(d),u=a.__importStar(u);var h=(function(e){function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={submitting:!1,open:!0},t.onAccept=function(){var e,a;t.unifiedPaymentFormAsync&&t.unifiedPaymentFormAsync.onAccept(),s.UserActivityLogger.log("web","update_billing_modal_started",{isNptBillingModal:null===(e=t.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(a=t.state.loadedProps)||void 0===a?void 0:a.trialProjectType})},t.onDismiss=function(){var e,n;s.UserActivityLogger.log("web","update_billing_modal_cancelled",{isNptBillingModal:null===(e=t.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal,project:null===(n=t.state.loadedProps)||void 0===n?void 0:n.trialProjectType}),t.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))},t.saveUnifiedPaymentFormAsync=function(e){t.unifiedPaymentFormAsync=e},t.setSubmittingStatus=function(e){t.setState((function(t){return a.__assign(a.__assign({},t),{submitting:e})}))},t.onSuccess=function(){t.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})})),t.modalLogger.logModalSuccess()},t.onError=function(){t.modalLogger.logModalError("modal_submit")},t}return a.__extends(c,e),c.showInstance=function(){u.Modal.showInstance(i.default.createElement(t.IndividualUpdateBillingModalLoader,null))},c.prototype.componentDidMount=function(){var e=this;this.modalLogger=_.getSubscriptionAMPLogger({ns:"personal",modal:_.ModalTypes.UPDATE_BILLING_MODAL});var t=Date.now();d.WebRequest({url:"/account/unified_payment_view",success:function(n){var i,o,l=JSON.parse(n);e.setState((function(e){return a.__assign(a.__assign({},e),{loadedProps:{viewModel:l,showNptBillingModal:l.paymentExperiments.showNptBillingModal,trialProjectType:l.paymentExperiments.trialProjectType}})})),s.UserActivityLogger.log("web","update_billing_modal_success",{isNptBillingModal:null===(i=e.state.loadedProps)||void 0===i?void 0:i.showNptBillingModal,project:null===(o=e.state.loadedProps)||void 0===o?void 0:o.trialProjectType});var r=Date.now()-t;e.modalLogger.logModalTTI(r)},error:function(t){l.Notify.error(r.intl.formatMessage({id:"EZm8Rx",defaultMessage:"Failed to load modal."})),s.UserActivityLogger.log("web","update_billing_modal_failure",{request_id:t.getResponseHeader("x-dropbox-request-id"),status:t.status}),e.modalLogger.logModalError("modal_init"),e.setState((function(e){return a.__assign(a.__assign({},e),{open:!1})}))}})},Object.defineProperty(c.prototype,"modalTitle",{get:function(){var e,t=r.intl.formatMessage({id:"OyZpYC",defaultMessage:"Update billing information"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=r.intl.formatMessage({id:"yacDmF",defaultMessage:"Step 1/2: add your billing info"})),t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"primaryButtonText",{get:function(){var e,t=r.intl.formatMessage({id:"vBFpIq",defaultMessage:"Save changes"});return(null===(e=this.state.loadedProps)||void 0===e?void 0:e.showNptBillingModal)&&(t=r.intl.formatMessage({id:"1ZUfS7",defaultMessage:"Next"})),t},enumerable:!1,configurable:!0}),c.prototype.renderButtons=function(){var e=this.state,t=e.loadedProps,a=e.submitting;return i.default.createElement(p.Modal.Footer,{hasTopBorder:!0,className:"db-modal-buttons"},i.default.createElement(o.Button,{className:"cancel-button",variant:"secondary",onClick:this.onDismiss},r.intl.formatMessage({id:"whhn4M",defaultMessage:"Cancel"})),i.default.createElement(o.Button,{className:"js-save-button",disabled:!t||a,variant:"primary",onClick:this.onAccept},this.primaryButtonText))},c.prototype.renderContent=function(){var e=this.state.loadedProps;return e?i.default.createElement(f.UnifiedPaymentFormAsync,{isSubmittingStatus:this.setSubmittingStatus,onSuccess:this.onSuccess,ref:this.saveUnifiedPaymentFormAsync,isTeam:!1,preloadedViewModel:e.viewModel,onError:this.onError}):i.default.createElement("div",{className:"loading-spinner"},i.default.createElement("img",{src:g.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:r.intl.formatMessage({id:"oXILe3",defaultMessage:"Loading"})}))},c.prototype.render=function(){var e=n.default("update-billing-modal");return i.default.createElement(p.Modal,{open:this.state.open,isCentered:!0,withCloseButton:r.intl.formatMessage({id:"Pxv2Bf",defaultMessage:"Close"}),overlayClassName:e,onRequestClose:this.onDismiss,shouldCloseOnOverlayClick:!1,onAfterClose:u.Modal.close,modalBaseIndex:1050},i.default.createElement(p.Modal.Header,{hasBottomSpacing:"title-standard"},i.default.createElement(m.Title,{isBold:!1,size:"small"},this.modalTitle)),i.default.createElement(p.Modal.Body,{hasVerticalSpacing:!0},this.renderContent()),this.renderButtons())},c})(i.default.Component);t.IndividualUpdateBillingModalLoader=c.requireCssWithComponent(h,["/static/css/pro/components/update_billing_modal_individual-vfljJUHvA.css"])})),define("modules/clean/react/payments/update_individual_billing/update_individual_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/modal","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/clean/react/snackbar","modules/clean/top_notif","modules/core/i18n","modules/core/notify"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_){"use strict";function h(e){return function(e){return function(a){if("SubmitFormSuccess"!==a.type)return e(a);var n=e(a),i=void 0!==a.additionalData&&a.additionalData.showRebillUpsell;return l.ProEventsLogger.log("update_billing_open_save_changes_success"),g.TopNotificationBar.hideById("rebill-bar"),i?(_.Notify.clear(),m.Snackbar.complete(f.intl.formatMessage({id:"jMyZGp",defaultMessage:"Payment method successfully updated."})),r.DBModalStack.trigger(t.BILLING_INFO_UPDATED,{showChangePlanConfirm:!0})):(_.Notify.success(f.intl.formatMessage({id:"p28rXC",defaultMessage:"We’ve successfully updated your account’s billing information."})),s.Modal.close(),r.DBModalStack.trigger(t.BILLING_INFO_UPDATED,null)),n}}}function y(e,t,a){var n=e.vat,i=e.cpf,o=e.countryCode,l=e.userInfo,r=u.createPaymentFormData(e,t,a),s=r.city,d=r.address,c=r.phone,m=r.name,g=r.paymentMethod,f=r.countryCode,_=r.zipCode,h=r.vat,y=r.cpf,v=r.nonce,b=r.payPalNonce,P=r.adyenEncryptedCard,S=r.encryptedCardForNetworkToken,M=r.applePayToken,C=r.bin,E=r.browserInfo,T=r.threeDsData,w=r.accountHolderName,A=r.iban,I=r.mandateSigned,x=r.termsAndService,L=r.idealBankId,N=r.idealBankName;return{city:s,address:d,phone:c,name:m,paymentMethod:g,countryCode:f,zipCode:_,vat:n?p.FormValueFactory.createVat(n,o):h,cpf:i?p.FormValueFactory.createCpf(i):y,cpfName:p.FormValueFactory.createCpfNamePrefill("","",l.displayName),nonce:v,payPalNonce:b,adyenEncryptedCard:P,encryptedCardForNetworkToken:S,applePayToken:M,bin:C,browserInfo:E,threeDsData:T,accountHolderName:w,iban:A,mandateSigned:I,termsAndService:x,idealBankId:L,idealBankName:N}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=t.BILLING_INFO_UPDATED=void 0,n=a.__importStar(n),i=a.__importDefault(i),t.BILLING_INFO_UPDATED="billing_info_modal:updated",t.submitFormSuccessMiddleware=h,t.createBillingStore=function(e,t){var a=(function(e){var t=(function(e){var t=u.createPaymentPageState(e).paymentFormSpec;return{countryToCurrencyMap:e.countryToCurrencyMap,submitSuccess:!1,submitState:null,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){var t=u.createPaymentPricingState(e),a=t.countryCode,n=t.countryCodeLoading,i=t.hasCurrencyChanged,o=t.hasTaxChangedWithinCountry,l=t.loadingPrices,r=t.requestToken,s=t.recentLoadEvent;return{countryCode:a,countryCodeLoading:n,hasCurrencyChanged:i,hasTaxChangedWithinCountry:o,loadingPrices:l,requestToken:r,recentLoadEvent:s}})(e);return{pricingState:a,pageState:t,formData:y(e,t,a)}})(e),l=n.applyMiddleware(i.default,c.submitFormErrorMiddleware,h,new d.PaymentsUXLogger(e.requestId).reduxMiddleware);return o.createStore(t,a,l)},t.createFormData=y})),define("modules/clean/subscription/tools/amp_logger",["require","exports","apex-metrics/index","modules/clean/metrics/index"],(function(e,t,a,n){"use strict";var i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.findInitLoggingErrorType=t.logTabError=t.getSubscriptionAMPLogger=t.SubscriptionAMPLogger=t.ModalTypes=void 0,(function(e){e.PERSONAL="personal_plan_management",e.TEAM="team_plan_management"})(i||(i={})),(function(e){e.SUCCESS="modal_success",e.ERROR="modal_error",e.TTI="modal_tti"})(o||(o={})),(function(e){e.CHANGE_LICENSES_MODAL="change_licenses_modal",e.CHANGE_PLAN_MODAL="change_plan_modal",e.CHANGE_PLAN_DUAL_MODAL="change_plan_dual_modal",e.CHANGE_SCHEDULE_MODAL="change_schedule_modal",e.CANCEL_CHANGES_MODAL="cancel_changes_modal",e.CANCEL_SURVEY_MODAL="cancel_survey_modal",e.CANCEL_SUBS_WARNING_MODAL="cancel_subs_warning_modal",e.UPDATE_BILLING_MODAL="update_billing_modal",e.EDIT_INVOICE_MODAL="edit_invoice_modal"})(t.ModalTypes||(t.ModalTypes={}));var l=(function(){function e(e){this.namespace="team"===e.ns?i.TEAM:i.PERSONAL,this.modal=e.modal,this.productPlanType=e.productPlanType||"unknown"}return e.prototype.logModalTTI=function(e){n.getMetricsReporter().createStats({ns:this.namespace,name:o.TTI},{modal:this.modal,productType:this.productPlanType}).recordDuration(e,a.TimeUnit.MILLISECONDS)},e.prototype.logModalSuccess=function(){this.logModalEvent(o.SUCCESS)},e.prototype.logModalError=function(e){this.logModalEvent(o.ERROR,{errorType:e})},e.prototype.setProductPlanType=function(e){e&&(this.productPlanType=e)},e.prototype.logModalEvent=function(e,t){void 0===t&&(t={});var a={modal:this.modal,productType:this.productPlanType};t.errorType&&(a.errorType=t.errorType),n.getMetricsReporter().createStats({ns:this.namespace,name:e},a).record(1)},e})();t.SubscriptionAMPLogger=l,t.getSubscriptionAMPLogger=function(e){return new l(e)},t.logTabError=function(e,t,a){void 0===a&&(a="unknown");var o={tab:e,productType:a,errorType:t};n.getMetricsReporter().createStats({ns:i.PERSONAL,name:"account_tab_error"},o).record(1)},t.findInitLoggingErrorType=function(e){return e.responseText&&e.responseText.indexOf("err:")>-1?"noncritical_error":"modal_init"}})),define("modules/clean/teams/admin/lib/billing_history",["require","exports","modules/clean/teams/admin/types/billing_history"],(function(e,t,a){"use strict";function n(e){var t=e.description;return!!t&&(-1!==t.indexOf("Google")||-1!==t.indexOf("Apple")&&-1===t.indexOf("ApplePay"))}Object.defineProperty(t,"__esModule",{value:!0}),t.getHistoryData=t.SelectedYearTypes=void 0,t.SelectedYearTypes={ALL_TIME:"all-time",YEAR_TO_DATE:"year-to-date"},t.getHistoryData=function(e,i){void 0===i&&(i=t.SelectedYearTypes.ALL_TIME);var o=(function(e){for(var t=[],i=0;i<e.length;i++){var o=e[i];if(i<e.length-1){var l=e[i+1],r=n(l)||n(o);if(o.type===a.BillingRowType.Payment&&l.type===a.BillingRowType.Invoice&&(l.billed===o.paid||l.billed==="("+o.paid+")"||r)&&l.date===o.date){var s={id:i,invoice:l,payment:o,isMobile:r};t.push(s),i++;continue}}o.type===a.BillingRowType.Payment?t.push({id:i,payment:o}):t.push({id:i,invoice:o})}return t})(e),l=(new Date).getFullYear().toString();return i===t.SelectedYearTypes.ALL_TIME||(o=i===t.SelectedYearTypes.YEAR_TO_DATE?o.filter((function(e){return e.payment?-1!==e.payment.date.indexOf(l):!!e.invoice&&-1!==e.invoice.date.indexOf(l)})):o.filter((function(e){return e.payment?-1!==e.payment.date.indexOf(i):!!e.invoice&&-1!==e.invoice.date.indexOf(i)}))),o=o.filter((function(e){return e.invoice&&null!==e.invoice.description||e.payment&&null!==e.payment.description}))}})),define("modules/clean/teams/admin/types/billing_history",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingRowType=void 0,(function(e){e[e.Invoice=0]="Invoice",e[e.Payment=1]="Payment",e[e.Legacy=2]="Legacy"})(t.BillingRowType||(t.BillingRowType={}))})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list",["require","exports","tslib","react","modules/clean/react/css"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedList=void 0;var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.default.createElement("div",{className:"admin-priced-list"},n.default.createElement("div",null,this.props.children))},t})((n=a.__importDefault(n)).default.Component);t.AdminPricedList=i.requireCssWithComponent(o,["/static/css/teams/admin/widgets/admin_priced_list/admin_priced_list-vflwUDnKP.css"])})),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item",["require","exports","tslib","react","classnames","modules/core/i18n","modules/clean/react/badge","modules/clean/account_page/widgets/plan/views/loading_view"],(function(e,t,a,n,i,o,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPricedListItem=void 0,n=a.__importDefault(n),i=a.__importDefault(i);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(){},t}return a.__extends(t,e),t.prototype.renderTitleWarningText=function(){var e=this.props.titleWarningText;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_warning"}," ",e)},t.prototype.renderTitleSecondaryText=function(){var e=this.props.titleSecondaryText;if(e)return n.default.createElement("span",{className:"admin-priced-list-item__content_title_secondary"}," ",e)},t.prototype.renderRecommendedSign=function(){var e=this.props,t=e.titleSecondaryText,a=e.titleWarningText,i=e.recommended;if(!t&&!a&&i)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_recommended"},o.intl.formatMessage({id:"430h7a",defaultMessage:"RECOMMENDED"}))},t.prototype.renderEffectiveDate=function(){var e=this.props,t=e.price,a=e.priceString,i=e.effectiveDate;if(!t&&!a)return n.default.createElement("div",{className:"admin-priced-list-item__content_title_effective_date"},i)},t.prototype.getClickHandler=function(){if(!this.props.disableItem)return this.props.onClick},t.prototype.render=function(){var e,t,o,s=this.props,d=s.description,c=s.price,u=s.title,p=s.unit,m=s.detailsLink,g=s.disableItem,f=s.effectiveDate,_=s.loadingPrice,h=this.props.className?this.props.className:"";_||(this.props.priceString?(t=this.props.priceString,o=p):c?(t=c.toString(),o=p):(t=f?"":"-",o=""));var y=i.default(((e={"admin-priced-list-item":!0,active:!0===this.props.isSelected})[h]=!0,e.disabled=g,e));return n.default.createElement("div",{className:y,onClick:this.getClickHandler()},n.default.createElement("div",{className:"admin-priced-list-item__content"},n.default.createElement("div",{className:"admin-priced-list-item__content_title"},n.default.createElement("input",{type:"radio",checked:this.props.isSelected,onChange:this.onChange,disabled:this.props.disableItem}),n.default.createElement("h1",{className:"admin-priced-list-item__content_title_text"},u,this.props.badge&&n.default.createElement(l.Badge,a.__assign({},this.props.badge)),this.renderTitleWarningText(),this.renderTitleSecondaryText()),this.renderRecommendedSign(),this.renderEffectiveDate()),n.default.createElement("div",{className:"admin-priced-list-item__content_description u-font-meta"},d,m)),_?n.default.createElement(r.LoadingView,null):t&&n.default.createElement("div",{className:"admin-priced-list-item__pricing"},n.default.createElement("div",{className:"admin-priced-list-item__pricing_price"},t),n.default.createElement("div",{className:"admin-priced-list-item__pricing_unit"},o)))},t})(n.default.Component);t.AdminPricedListItem=s})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_row",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/analytics","modules/clean/react/tooltip","modules/clean/react/sprite","dig-components/buttons"],(function(e,t,a,n,i,o,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTableRow=void 0;var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onEdit=function(){var e=t.props,a=e.row,n=e.isTeam;a.invoice&&o.EditInvoiceAddressModalLoader.showInstance(a.invoice,n)},t.logReceiptLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_receipt_link_click")},t.logInvoiceLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_invoice_link_click")},t}return a.__extends(t,e),t.prototype.renderDate=function(){var e=this.props.row,t=e.invoice,a=e.payment;return t&&t.date?t.date:a&&a.date?a.date:null},t.prototype.renderDescription=function(){var e=this.props.row,t=e.invoice,a=e.payment,o=e.isMobile,l=null,r=null;return t&&t.description?l=t.description:a&&a.description&&(l=a.description),o&&t&&t.description&&a&&a.description&&(l=a.description+" | "+t.description),(t&&t.isVoided||a&&a.isVoided)&&(r=n.default.createElement("span",null," (",i.intl.formatMessage({id:"Raqf73",defaultMessage:"Voided"}),")")),n.default.createElement("div",null,n.default.createElement("p",{className:"description-line"},n.default.createElement("span",null,l),r))},t.prototype.renderLinks=function(){var e=[];if(!0===this.props.renderPublicLinks)e=this.renderInvoiceAndReceiptLink(this.props.publicInvoiceLink,this.props.publicReceiptLink);else{var t=this.props,a=t.row,o=t.showEditInvoiceModal,l=t.canEditBilling,r=a.invoice,s=a.payment,c="",u="";r&&r.link&&(c=r.link),!a.isMobile&&s&&s.link&&(u=s.link),e=this.renderInvoiceAndReceiptLink(c,u),o&&r&&!r.isOpen&&r.isEditable&&l&&e.push(n.default.createElement(d.Button,{variant:"transparent",key:"edit-link",className:"button-as-link",onClick:this.onEdit},i.intl.formatMessage({id:"UwFkjc",defaultMessage:"Edit"}))),e.length||(r&&r.infoTooltip?e.push(this.renderInfoTooltip(r)):s&&s.infoTooltip&&e.push(this.renderInfoTooltip(s)))}return e.length?n.default.createElement("span",null,e):null},t.prototype.renderInvoiceAndReceiptLink=function(e,t){var a=[];return e&&a.push(n.default.createElement("a",{key:"invoice-link",className:"account-page__link",href:e,target:"_blank",rel:"noopener noreferrer",onClick:this.logInvoiceLinkClick},i.intl.formatMessage({id:"+fOIGM",defaultMessage:"Invoice"}))),t&&a.push(n.default.createElement("a",{key:"payment-link",className:"account-page__link",href:t,target:"_blank",rel:"noopener noreferrer",onClick:this.logReceiptLinkClick},i.intl.formatMessage({id:"9s47b8",defaultMessage:"Receipt"}))),a},t.prototype.renderInfoTooltip=function(e){return n.default.createElement(r.Tooltip,{position:r.TooltipPosition.TOP,tooltip_contents:e.infoTooltip},n.default.createElement(s.Sprite,{group:"teams",name:"info_active",alt:"",className:"info-sprite"}))},t.prototype.renderPrice=function(){var e=this.props.row,t=e.invoice,a=e.payment;if(e.isMobile)return null;var i=null;return t&&a?i=t.isVoided||a.isVoided?n.default.createElement("span",{className:"row-content__price--line-through"},t.billed):t.billed:a?i=a.paid:t&&(i=t.billed),i},t.prototype.render=function(){var e=this.props.row;return e.invoice||e.payment?n.default.createElement("tr",{className:"row-content","data-variant":!0},n.default.createElement("td",{className:"row-content__date"},this.renderDate()),n.default.createElement("td",{className:"row-content__description"},this.renderDescription()),n.default.createElement("td",{className:"row-content__links"},this.renderLinks()),n.default.createElement("td",{className:"row-content__price"},this.renderPrice())):null},t.defaultProps={canEditBilling:!0},t})((n=a.__importDefault(n)).default.Component);t.BillingHistoryTableRow=c})),define("modules/clean/teams/admin/widgets/billing_history/billing_history_table",["require","exports","tslib","react","styled-components","modules/core/i18n","modules/clean/teams/admin/widgets/billing_history/billing_history_row","modules/clean/account_page/widgets/billing/billing_history/types","dig-components/menu","dig-components/buttons"],(function(e,t,a,n,i,o,l,r,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingHistoryTable=void 0,n=a.__importDefault(n);var c,u=(i=a.__importDefault(i)).default.div(c||(c=a.__makeTemplateObject(["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n            &:not(:first-child):before {\n              content: none;\n            }\n          }\n        }\n      }\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n        .description-line {\n          margin: 0;\n        }\n      }\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n\n      .account-page__link {\n        color: inherit;\n        padding-bottom: var(--spacing__unit--0_5);\n        border-bottom: 1px solid var(--color__standard__border);\n        font-weight: var(--type__body__standard--fontweight_strong);\n        &:hover {\n          border-bottom: 1px solid var(--color__standard__text);\n        }\n      }\n    }\n  }\n"],["\n  .billing-table-container {\n    border-radius: 0;\n    border: 1px solid var(--color__faint__border);\n    .billing-history-table {\n      width: 100%;\n      border-collapse: collapse;\n\n      .row-header {\n        background-color: var(--color__faint__background);\n        padding: var(--spacing__unit--2) 0;\n        color: var(--color__faint__text);\n        font-size: var(--type__body__standard--fontsize);\n        height: auto;\n        font-weight: normal;\n      }\n\n      .caret {\n        vertical-align: middle;\n      }\n\n      .date-header-cell {\n        font-weight: normal;\n        text-align: left;\n        color: var(--color__faint__text);\n      }\n\n      .date-row {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .desc-row {\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .price-row {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        font-weight: normal;\n        text-align: left;\n        font-size: var(--type__body__small--fontsize);\n        color: var(--color__faint__text);\n      }\n\n      .row-content {\n        height: 56px;\n        border-top: 1px solid var(--color__faint__border);\n        color: var(--color__standard__text);\n        &__links {\n          white-space: nowrap;\n          padding: var(--spacing__base_unit);\n          text-align: right;\n          a,\n          button {\n            &:not(:first-child) {\n              margin-left: var(--spacing__base_unit);\n            }\n            &:not(:first-child):before {\n              content: none;\n            }\n          }\n        }\n      }\n      .row-content__date {\n        padding-left: var(--spacing__unit--2);\n        padding-right: var(--spacing__unit--3);\n        width: 80px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .row-content__description {\n        color: var(--color__standard__text);\n        .description-line {\n          margin: 0;\n        }\n      }\n      .row-content__price {\n        padding-left: var(--spacing__unit--3);\n        padding-right: var(--spacing__unit--2);\n        width: 100px;\n        text-align: left;\n        color: var(--color__standard__text);\n      }\n\n      .billing-history-row {\n        border-top: 1px solid var(--color__faint__border);\n      }\n\n      .billing-history-col {\n        text-align: center;\n        height: ver(--spacing__unit--5);\n      }\n\n      .account-page__link {\n        color: inherit;\n        padding-bottom: var(--spacing__unit--0_5);\n        border-bottom: 1px solid var(--color__standard__border);\n        font-weight: var(--type__body__standard--fontweight_strong);\n        &:hover {\n          border-bottom: 1px solid var(--color__standard__text);\n        }\n      }\n    }\n  }\n"]))),p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.buildFooterIfNecessary=function(){if(null!==this.props.footer)return n.default.createElement("tfoot",{className:"row-footer"},this.props.footer)},t.prototype.buildHeaderDate=function(){var e=this;return n.default.createElement("th",{className:"row-header date-row"},n.default.createElement(s.Menu.Wrapper,{onSelection:this.props.onSelection},(function(t){var i=t.getContentProps,l=t.getTriggerProps;return n.default.createElement(n.default.Fragment,null,n.default.createElement(d.Button,a.__assign({className:"date-header-cell"},l(),{variant:"transparent",withDropdownIcon:!0,hasNoUnderline:!0}),o.intl.formatMessage({id:"65pLwc",defaultMessage:"Date"})),n.default.createElement(s.Menu.Content,a.__assign({},i()),n.default.createElement(s.Menu.Segment,{withLabel:o.intl.formatMessage({id:"HXV3TA",defaultMessage:"Order"})},n.default.createElement(s.Menu.SelectItem,{value:r.BillingHistoryOrder.ASCENDING,selected:r.BillingHistoryOrder.ASCENDING===e.props.order},o.intl.formatMessage({id:"KyJseU",defaultMessage:"Ascending"})),n.default.createElement(s.Menu.SelectItem,{value:r.BillingHistoryOrder.DESCENDING,selected:r.BillingHistoryOrder.DESCENDING===e.props.order},o.intl.formatMessage({id:"Njd630",defaultMessage:"Descending"}))),n.default.createElement(s.Menu.Segment,{withLabel:o.intl.formatMessage({id:"2X0e4z",defaultMessage:"Show"})},n.default.createElement(s.Menu.SelectItem,{value:"all_time",selected:"all_time"===e.props.filter},o.intl.formatMessage({id:"261J2J",defaultMessage:"All time"})),n.default.createElement(s.Menu.SelectItem,{value:"year_to_date",selected:"year_to_date"===e.props.filter},o.intl.formatMessage({id:"EqTfoU",defaultMessage:"Year-to-date"})),e.renderMenuItems())))})))},t.prototype.renderMenuItems=function(){var e=[],t=this.props,a=t.filters,i=t.filter;return a&&a.forEach((function(t){e.push(n.default.createElement(s.Menu.SelectItem,{key:t,value:t,selected:t===i},t))})),e},t.prototype.render=function(){var e,t=this.props,a=t.amountLabel,i=t.canEditBilling,r=t.displayNoTransactionsOnEmptyRecords,s=t.showEditInvoiceModal,d=t.logAccountBillingTabEvents,c=t.isTeam,p=t.renderPublicLinks,m=t.publicInvoiceLink,g=t.publicReceiptLink,f=this.props.billingHistoryRecords,_=a||o.intl.formatMessage({id:"PoJI4y",defaultMessage:"Price"});if(r&&0===f.length){var h=this.props.noTransactionLabel?this.props.noTransactionLabel:o.intl.formatMessage({id:"SNLY2j",defaultMessage:"No transactions"});e=n.default.createElement("tr",{className:"row-content"},n.default.createElement("td",{className:"row-content__date"}),n.default.createElement("td",{className:"row-content__description"},h),n.default.createElement("td",{className:"row-content__links"}),n.default.createElement("td",{className:"row-content__price"}))}return n.default.createElement(u,null,n.default.createElement("div",{className:"billing-table-container"},n.default.createElement("table",{className:"billing-history-table",cellSpacing:"0"},n.default.createElement("thead",null,n.default.createElement("tr",null,this.buildHeaderDate(),n.default.createElement("th",{className:"row-header desc-row u-font-meta",colSpan:2},o.intl.formatMessage({id:"VfjryA",defaultMessage:"Description"})),n.default.createElement("th",{className:"row-header price-row u-font-meta"},_))),this.buildFooterIfNecessary(),n.default.createElement("tbody",null,e,f.map((function(e,t){return n.default.createElement(l.BillingHistoryTableRow,{canEditBilling:i,isTeam:c,key:e.id,logAccountBillingTabEvents:d,renderPublicLinks:p,publicInvoiceLink:m,publicReceiptLink:g,row:e,showEditInvoiceModal:s})}))))))},t.defaultProps={onSelection:function(){}},t})(n.default.Component);t.BillingHistoryTable=p})),define("modules/clean/teams/admin/widgets/billing_notifications/cancellable_item",["require","exports","tslib","react","modules/core/i18n","classnames","dig-components/buttons"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CancellableItemView=void 0,n=a.__importDefault(n),o=a.__importDefault(o);var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t,a=this.props,i=a.title,r=a.description,s=a.handleAction,d=a.useCTA,c=a.CTAText,u=this.props.className?this.props.className:"",p=o.default(((e={"cancellable-item__button":!0,"link-button":!0})[u]=!0,e));return d&&(t=n.default.createElement(l.Button,{variant:"transparent",className:p,onClick:s},c)),n.default.createElement("div",{className:"cancellable-item"},n.default.createElement("span",{className:"cancellable-item__title"},i)," ",n.default.createElement("span",{className:"cancellable-item__desc"},r),t)},t.defaultProps={CTAText:i.intl.formatMessage({id:"7kgsyk",defaultMessage:"Cancel change"}),useCTA:!1},t})(n.default.Component);t.CancellableItemView=r})),define("modules/clean/react/growth/trials/trials_experience_tracker",["require","exports","modules/clean/analytics"],(function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrialsExperienceTracker=void 0,t.TrialsExperienceTracker={track_cancel_trial:function(e){a.ProEventsLogger.log("trial_canceled",{project:e})}}})),define("modules/clean/react/growth/trials/requests",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/i18n","modules/clean/react/growth/logging_util","modules/clean/react/growth/trials/util","modules/core/notify","modules/clean/react/growth/trials/types","modules/clean/react/snackbar","modules/clean/react/growth/trials/trials_experience_tracker","modules/clean/api_v2/user_client"],(function(e,t,a,n,i,o,l,r,s,d,c,u){"use strict";function p(e,t,n,i,l,r,s,d,c){return a.__awaiter(this,void 0,void 0,(function(){var p,f,_,h;return a.__generator(this,(function(a){switch(a.label){case 0:return a.trys.push([0,5,,6]),p=new u.UserApiV2Client,f=null,n!==o.RequestType.START_TRIAL?[3,2]:[4,p.ns("trials").rpc("start",i,{subjectUserId:l})];case 1:return f=a.sent(),[3,4];case 2:return n!==o.RequestType.CANCEL_TRIAL?[3,4]:[4,p.ns("trials").rpc("cancel",i,{subjectUserId:l})];case 3:f=a.sent(),a.label=4;case 4:return f&&"ok"===f.status?g(e,t,n,r):m(e,t,n,void 0,d,c),[3,6];case 5:return _=a.sent(),h=s?s(_):void 0,m(e,t,n,h,d,c),[3,6];case 6:return[2]}}))}))}function m(e,t,a,n,l,s){var c=n||i.intl.formatMessage({id:"bLA3rA",defaultMessage:"There was a problem completing this request."});o.logAjaxError(e,t,a,{errorMessage:c}),r.Notify.error(c),s&&d.Snackbar.close(s),l&&l()}function g(e,t,a,n,i){o.logAjaxSuccess(e,t,a),n&&(i?n(i):n())}function f(e,t,a,n,l,r){var s="cancel-trial-notification";d.Snackbar.sync(i.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,s);return p(e,t,o.RequestType.CANCEL_TRIAL,{trial_sku_code:a,trial_project_type:e},n,(function(){d.Snackbar.complete(i.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),s),l&&l()}),(function(e){if(e.error&&"not_in_trial"===e.error[".tag"])return i.intl.formatMessage({id:"Ui1I/f",defaultMessage:"You’ve already canceled your trial."})}),r,s)}function _(e,t,a,l){var r="cancel-trial-notification";d.Snackbar.sync(i.intl.formatMessage({id:"jXr05+",defaultMessage:"Canceling trial..."}),!1,r);var s=o.RequestType.CANCEL_TRIAL,u=function(){d.Snackbar.complete(i.intl.formatMessage({id:"RBkBP9",defaultMessage:"You’ve successfully canceled your trial."}),r),c.TrialsExperienceTracker.track_cancel_trial(e),a&&a()};n.WebRequest({url:"/downgrade/process",success:function(){return g(e,t,s,u)},error:function(a,n,i){return m(e,t,s,i,l,r)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.enableAutoConvert=t.getPriceConversionsForSchedule=t.transitionPlan=t.cancelTransitionTrial=t.cancelPlatformTrial=t.cancelTrial=t.startTrial=void 0,n=a.__importStar(n),t.startTrial=function(e,t,a,n,i,l,r){return p(e,t,o.RequestType.START_TRIAL,{trial_sku_code:a,trial_duration:n,trial_project_type:e},i,l,void 0,r)},t.cancelTrial=function(e,t,a,n,i,o,l){return n===s.TrialSource.TRANSITIONS_TRIAL?_(e,t,o,l):n===s.TrialSource.PLATFORM_TRIAL?f(e,t,a,i,o,l):null},t.cancelPlatformTrial=f,t.cancelTransitionTrial=_,t.transitionPlan=function(e,t,a,i,r,s){var d=o.RequestType.TRANSITION_PLAN,c=l.getTransitionChangeType(e);c?n.WebRequest({type:"POST",url:"/account/perform_personal_transition",data:{transition_change_type:c},subject_user:t,success:function(){return g(a,i,d,r)},error:function(e,t,n){return m(a,i,d,n,s)}}):m(a,i,d)},t.getPriceConversionsForSchedule=function(e,t,n,i,l,r){return a.__awaiter(this,void 0,void 0,(function(){var s,d;return a.__generator(this,(function(a){switch(a.label){case 0:s=o.RequestType.GET_PRICE_CONVERSIONS_FOR_SCHEDULE,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(new u.UserApiV2Client).ns("trials").rpc("get_price_conversions_for_schedule",i,{subjectUserId:e})];case 2:return(d=a.sent())?g(t,n,s,l,d):m(t,n,s,void 0,r),[3,4];case 3:return a.sent(),m(t,n,s,void 0,r),[3,4];case 4:return[2]}}))}))},t.enableAutoConvert=function(e,t,n,i,l,r){return a.__awaiter(this,void 0,void 0,(function(){var s,d;return a.__generator(this,(function(a){switch(a.label){case 0:s=o.RequestType.ENABLE_AUTO_CONVERT,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(new u.UserApiV2Client).ns("trials").rpc("enable_auto_convert",i,{subjectUserId:e})];case 2:return(d=a.sent())&&"ok"===d.status?g(t,n,s,l,d):m(t,n,s,void 0,r),[3,4];case 3:return a.sent(),m(t,n,s,void 0,r),[3,4];case 4:return[2]}}))}))}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_submit_action",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/unified_module/unified_data_export"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submitUnifiedForm=void 0,n=a.__importStar(n),t.submitUnifiedForm=function(e,t,a,l){return void 0===l&&(l={}),function(r,s){var d,c=s(),u=c.formData.countryCode.formattedValue,p=c.pageState.paymentFormSpec,m=c.formData.paymentMethod.formattedValue,g=o.getPaymentFieldNamesToSubmit(u,p,m);l.payment_method=c.formData.paymentMethod.formattedValue,l.request_id=c.pageState.requestId,l.submit_seq=c.pageState.submitSeq,d=c.pageState.paymentFormSpec.isTeam()?m===n.PaymentMethod.CreditCard?"/team/payments/ajax_update_billing_credit_card":m===n.PaymentMethod.DirectDeposit?"/team/payments/ajax_update_billing_direct_debit":"/team/payments/ajax_update_billing_paypal":m===n.PaymentMethod.CreditCard?"/update_credit_card_billing_info_ajax":m===n.PaymentMethod.DirectDeposit?"/update_direct_debit_billing_info_ajax":m===n.PaymentMethod.Ideal?"/update_ideal_billing_info_ajax":"/paypal_billing_info",r(i.submitForm(d,g,e,l,void 0,t,a))}}})),define("modules/clean/react/payments/unified_module/unified_actions/unified_store",["require","exports","tslib","redux","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_actions","modules/clean/react/payments/buy/actions/page_actions","modules/clean/react/payments/unified_module/unified_actions/unified_submit_action","modules/clean/react/payments/checkout/components/payment_method_form/apple_pay"],(function(e,t,a,n,i,o,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindUnifiedBillingActions=void 0,n=a.__importStar(n),i=a.__importStar(i),o=a.__importStar(o),l=a.__importStar(l),r=a.__importStar(r),t.bindUnifiedBillingActions=function(e){return n.bindActionCreators({applePayAction:s.applePayAction,updateHistory:l.updateHistory,showFormFieldErrors:i.showFormFieldErrors,submitBillingForm:r.submitUnifiedForm,updatePaymentMethod:i.updatePaymentMethod,updateCountryCode:o.updateBillingCountryCode,updateZipCode:i.updateZipCode,updateVat:i.updateVat,updateCpf:i.updateCpf,updateCpfName:i.updateCpfName,updateNonce:i.updateNonce,updatePayPalNonce:i.updatePayPalNonce,updateAdyenEncryptedCard:i.updateAdyenEncryptedCard,updateEncryptedCardForNetworkToken:i.updateEncryptedCardForNetworkToken,updateApplePayToken:i.updateApplePayToken,updateBrowserInfo:i.updateBrowserInfo,updateThreeDsData:i.updateThreeDsData,triggerThreeDsChallenge:i.triggerThreeDsChallenge,triggerThreeDsFingerprint:i.triggerThreeDsFingerprint,updateBIN:i.updateBIN,updateAccountHolderName:i.updateAccountHolderName,updateIBAN:i.updateIBAN,updateMandateSigned:i.updateMandateSigned,updateIdealBank:i.updateIdealBank,blurCCField:i.blurCCField,blurZipCode:i.blurZipCode,blurVat:i.blurVat,blurCpf:i.blurCpf,blurAccountHolderName:i.blurAccountHolderName,blurIBAN:i.blurIBAN},e.dispatch)}})),define("modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field",["require","exports","tslib","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedCPFField=void 0;var r=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCpfChange=function(e){t.props.actions.updateCpf(e.value)},t.onCpfNameChange=function(e){t.props.actions.updateCpfName(e.value)},t}return a.__extends(t,e),t.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!o.FormValueHelper.isValid(e)&&e.showError?l.intl.formatMessage({id:"MQDRWx",defaultMessage:"Please enter a valid CPF number."}):""},t.prototype.render=function(){var e=this.props,t=e.paymentSpec,a=e.formData,o=null;return t.should_require_cpf(a.countryCode.formattedValue,a.paymentMethod.formattedValue)&&(o=n.default.createElement("div",{className:"grid__item"},n.default.createElement(i.UnifiedTextInputField,{autoSetupForm:a.cpf,name:"cpf",labelText:l.intl.formatMessage({id:"Z1BdZ2",defaultMessage:"CPF/CNPJ"}),errorText:this.cpfErrorString(),onChange:this.onCpfChange}),n.default.createElement(i.UnifiedTextInputField,{labelDivClassName:"billing-cpf grid__item",name:"cpf_name",labelText:l.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"}),value:a.cpfName.rawValue,onChange:this.onCpfNameChange}))),o},t})((n=a.__importDefault(n)).default.Component);t.UnifiedCPFField=r})),define("modules/clean/react/payments/unified_module/unified_fields/unified_vat_field",["require","exports","tslib","classnames","react","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/common/form_value_helpers","modules/core/i18n","modules/clean/payments/validation"],(function(e,t,a,n,i,o,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedVatField=void 0,n=a.__importDefault(n);var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onVatChange=function(e){this.props.actions.updateVat(e.value)},t.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!l.FormValueHelper.isValid(e)&&e.showError?r.intl.formatMessage({id:"iRjYtd",defaultMessage:"Please enter a valid VAT number (ex: {examples})."},{examples:s.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},t.prototype.render=function(){var e=this.props,t=e.paymentSpec,a=e.formData,l=null;if(t.should_show_vat_for_country(a.countryCode.formattedValue)){var d=s.getVatPrefix(a.countryCode.formattedValue),c=n.default({"billing-vat":!0,grid__item:!0});l=i.default.createElement(o.UnifiedTextInputField,{labelDivClassName:c,autoSetupForm:a.vat,name:"vat",labelText:r.intl.formatMessage({id:"eZAuK1",defaultMessage:"VAT number (optional)"}),errorText:this.vatErrorString(),placeholder:d,onChange:this.onVatChange.bind(this)})}return l},t})((i=a.__importDefault(i)).default.Component);t.UnifiedVatField=d})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input",["require","exports","tslib","classnames","dompurify","react"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedGenericInput=void 0,n=a.__importDefault(n),i=a.__importStar(i);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=n.default({"input__label--errormodal":Boolean(this.props.errorText)},this.props.className,"label-input","input__label"),t=o.default.createElement("label",{className:"label "+(this.props.labelClass?this.props.labelClass:""),htmlFor:this.props.htmlFor},this.props.labelText),a=null;this.props.labelAfterElement&&(a=t,t=null);var l=null;l=this.props.rightLabelElement?o.default.createElement("div",{className:"grid__item grid--x-bookend"},t,o.default.createElement("div",null,this.props.rightLabelElement)):t;var r=null;this.props.errorText?r=this.props.errorText:this.props.errorHTML&&(r=o.default.createElement("span",{dangerouslySetInnerHTML:{__html:i.sanitize(this.props.errorHTML)}}));var s=o.default.createElement("label",{className:"error-message",htmlFor:this.props.htmlFor},r);return o.default.createElement("div",{className:e},l,this.props.children,a,s)},t})((o=a.__importDefault(o)).default.Component);t.UnifiedGenericInput=l})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field",["require","exports","tslib","react","react-dom","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedLabeledSelectInput=void 0,n=a.__importDefault(n),i=a.__importStar(i);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(i.findDOMNode(this.input))},t.prototype.onClick=function(e){this.props.onClick&&this.props.onClick(i.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=i.findDOMNode(this.input),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,i=t.className,l=t.labelClass,r=t.labelText,s=t.rightLabelElement,d=t.errorText,c=t.errorHTML,u=t.autoComplete;return n.default.createElement(o.UnifiedGenericInput,{className:i,errorHTML:c,errorText:d,labelClass:l,htmlFor:a,labelText:r,rightLabelElement:s},n.default.createElement("select",{autoComplete:u,className:"option-selector",id:a,name:a,onChange:this.onChange.bind(this),onClick:this.onClick.bind(this),value:this.props.value,ref:function(t){e.input=t}},this.props.children))},t})(n.default.Component);t.UnifiedLabeledSelectInput=l})),define("modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field",["require","exports","tslib","classnames","react","react-dom","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_generic_input"],(function(e,t,a,n,i,o,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedTextInputField=void 0,n=a.__importDefault(n),i=a.__importDefault(i),o=a.__importStar(o);var s=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBlur=function(e){t.props.onBlur&&t.props.onBlur(o.findDOMNode(t.refToInput))},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(o.findDOMNode(t.refToInput))},t.onChange=function(e){t.props.onChange&&t.props.onChange(o.findDOMNode(t.refToInput))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.onChange){var e=o.findDOMNode(this.refToInput),t=e.value;t&&t!==this.props.value&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.labelDivClassName,o=t.disabled,s=t.errorText,d=t.errorHTML,c=t.labelClass,u=t.labelText,p=t.maxLength,m=t.name,g=t.placeholder,f=t.value,_=t.autoComplete,h=t.autoSetupForm,y=this.props.type||"text",v=null;if(h){var b=h.errorState&&h.showError;f=f||h.rawValue,d=d||h.serverError,d=b?d:void 0,s=b?s:void 0;var P="billing-"+m+"-input",S=""!==h.formattedValue&&l.FormValueHelper.isValid(h)?"billing-"+m+"-input--valid":"";v=n.default({baseInputClass:P,invalidClass:S});var M="billing-"+m;a=n.default(a,M,{grid__item:!0})}var C=n.default({input__text:!0,"input__text--errormodal":Boolean(s)||Boolean(d)},this.props.inputClassName,v);return i.default.createElement(r.UnifiedGenericInput,{className:a,errorHTML:d,errorText:s,htmlFor:m,labelClass:c,labelText:u},i.default.createElement("input",{autoComplete:_,className:C,type:y,name:m,id:m,ref:function(t){e.refToInput=t},value:null===f?"":f,disabled:o,onBlur:this.onBlur,onChange:this.onChange,onFocus:this.onFocus,maxLength:p,placeholder:g}))},t})(i.default.Component);t.UnifiedTextInputField=s})),define("modules/clean/react/payments/unified_module/unified_address_form",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/common/constants","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_text_input_field","modules/clean/react/payments/unified_module/unified_fields/unified_fields_base/unified_select_input_field"],(function(e,t,a,n,i,o,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedAddressForms=void 0;var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCountryCodeChange=function(e){t.props.actions.updateCountryCode(e.value)},t.onZipCodeBlur=function(e){t.props.actions.blurZipCode(e.value)},t.onZipCodeChange=function(e){t.props.actions.updateZipCode(e.value)},t.zipCodeErrorString=function(){var e=t.props.formData.zipCode;return!o.FormValueHelper.isValid(e)&&e.showError?l.ZipCodeErrorMessage:""},t}return a.__extends(t,e),t.prototype.renderCountrySelector=function(e){var t=this,a="grid__item--2-3";!0===e&&(a="grid__item");var o=this.props.countryList.map((function(e){var a=e[0],i=e[1];return n.default.createElement("option",{key:"location-"+a,value:a,"aria-selected":a===t.props.formData.countryCode.formattedValue},i)}));return n.default.createElement(s.UnifiedLabeledSelectInput,{autoComplete:"country",className:a,labelText:i.intl.formatMessage({id:"1SPrvR",defaultMessage:"Country"}),name:"country_code",onChange:this.onCountryCodeChange,value:this.props.formData.countryCode.rawValue},o)},t.prototype.renderZipCodeInput=function(){var e=i.intl.formatMessage({id:"5kJrVX",defaultMessage:"Postal Code"}),t="US"===this.props.formData.countryCode.formattedValue?i.intl.formatMessage({id:"ciLB6A",defaultMessage:"Billing ZIP"}):e,a=!this.props.paymentSpec.allow_zip_code_for_country(this.props.formData.countryCode.formattedValue);return n.default.createElement(r.UnifiedTextInputField,{autoComplete:"postal-code",labelDivClassName:"billing-zip payment-info__zip grid__item grid__item--7-24",disabled:a,errorText:this.zipCodeErrorString(),errorHTML:this.props.formData.zipCode.serverError,labelText:t,name:"zip",onChange:this.onZipCodeChange,value:this.props.formData.zipCode.rawValue,onBlur:this.onZipCodeBlur})},t.prototype.render=function(){return n.default.createElement(n.default.Fragment,null,this.renderCountrySelector(!1),this.renderZipCodeInput())},t})((n=a.__importDefault(n)).default.Component);t.UnifiedAddressForms=d})),define("modules/clean/react/payments/unified_module/unified_payment_form_async",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/payments/unified_module/unified_payment_form","modules/clean/react/payments/unified_module/unified_actions/unified_store","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_team_billing/update_team_store_creator","modules/clean/react/payments/update_team_billing/reducers","modules/clean/payments/payment_form/payment_form_spec","modules/clean/deprecated_ajax/ajax_jquery","modules/core/notify","modules/clean/static_urls","modules/clean/react/payments/update_individual_billing/update_individual_store_creator","modules/clean/analytics"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentFormAsync=void 0,n=a.__importDefault(n),u=a.__importStar(u);var _=(function(e){function t(t){var a=e.call(this,t)||this;return a.calledOnSuccess=!1,a.calledOnError=!1,a.loaded=!1,a.handleLoadSuccess=function(e){if(e.isError)a.setState({}),a.handleLoadFailure();else{var t={countryList:e.countryList,iframeUrl:e.iframeUrl,vat:e.vat,userInfo:e.userInfo,countryToCurrencyMap:e.countryToCurrencyMap,countryCode:e.countryCode,serializedPaymentFormSpec:e.serializedPaymentFormSpec,requestId:e.requestId,submitSeq:0};a.loaded=!0,a.iFrameUrl=e.iframeUrl,a.countryList=e.countryList,a.paymentExperiments=e.paymentExperiments,a.paymentOptionalSettings=e.paymentOptionalSettings,a.props.isTeam?a.store=s.createBillingStore(t,d.BillingReducer):a.store=g.createBillingStore(t,d.BillingReducer),a.setState(a.store.getState()),a.store.subscribe((function(){var e=a.store.getState();if(!e.pageState.submitSuccess)if(a.props.isSubmittingStatus){var t=a.props.isSubmittingStatus;a.setState((function(a){return t(e.pageState.submitting),e}))}else a.setState((function(t){return e}));e.pageState.submitSuccess&&!a.calledOnSuccess&&(a.props.onSuccess(),a.calledOnSuccess=!0),"error"===e.pageState.submitState&&a.props.onError&&!a.calledOnError&&(a.props.onError(),a.calledOnError=!0)}))}},a.handleLoadFailure=function(){p.Notify.error(i.intl.formatMessage({id:"gaNMlz",defaultMessage:"Failed to load payment form."}))},a.saveUnifiedPaymentMethodForm=function(e){a.unifiedPaymentForm=e},a.prepareForSubmission=function(){return f.UserActivityLogger.log("web","update_billing_modal_try_submit",{payment_method:c.PaymentMethod[a.state.formData.paymentMethod.rawValue],country_code:a.state.formData.countryCode.rawValue,zip_code:a.state.formData.zipCode.rawValue,isNptBillingModal:a.paymentExperiments.showNptBillingModal,project:a.paymentExperiments.trialProjectType}),a.unifiedPaymentForm.prepareForSubmission()},a.onAccept=function(e){void 0===e&&(e=r.SubmitFormTriggerType.ButtonClick),a.actions.submitBillingForm(a.prepareForSubmission,a.unifiedPaymentForm.getCreditCardFrame().handle3DsMessage,e,a.generateAdditionalInfo())},a.iFrameUrl="",a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.preloadedViewModel?this.handleLoadSuccess(this.props.preloadedViewModel):u.WebRequest({url:"/account/unified_payment_view",data:{isTeam:this.props.isTeam},success:function(t){var a=JSON.parse(t);e.handleLoadSuccess(a)},error:function(){e.handleLoadFailure()}})},Object.defineProperty(t.prototype,"actions",{get:function(){return l.bindUnifiedBillingActions(this.store)},enumerable:!1,configurable:!0}),t.prototype.generateAdditionalInfo=function(){var e={};return this.paymentOptionalSettings.showRebillUpsell&&(e.showRebillUpsell=this.paymentOptionalSettings.showRebillUpsell),this.paymentOptionalSettings.isScheduledDowngradeToBasic,e},t.prototype.renderLoading=function(){return n.default.createElement("div",{className:"loading-spinner"},n.default.createElement("img",{src:m.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:i.intl.formatMessage({id:"jybGUg",defaultMessage:"Loading"})}))},t.prototype.render=function(){return this.loaded?n.default.createElement("div",{className:"payment-info-section"},n.default.createElement("div",{className:"payment-method-section grid__container"},n.default.createElement(o.UnifiedPaymentForm,{ref:this.saveUnifiedPaymentMethodForm,paymentSpec:this.state.pageState.paymentFormSpec,iframeUrl:this.iFrameUrl,countryList:this.countryList,formData:this.state.formData,actions:this.actions,submitForm:this.onAccept,payment_experiments:this.paymentExperiments,payment_optional_settings:this.paymentOptionalSettings}))):this.renderLoading()},t})(n.default.Component);t.UnifiedPaymentFormAsync=_})),define("modules/clean/react/payments/unified_module/unified_payment_form",["require","exports","tslib","classnames","modules/clean/analytics","react","modules/core/i18n","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector","modules/clean/react/payments/unified_module/unified_fields/unified_cpf_field","modules/clean/react/payments/unified_module/unified_fields/unified_vat_field","modules/clean/react/payments/unified_module/unified_address_form","modules/clean/react/payments/unified_module/unified_data_export","modules/clean/react/payments/buy/components/payments/ideal_form","dig-components/typography"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedPaymentForm=void 0,n=a.__importDefault(n);var h=(function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.prototype.getPaymentData=function(){return g.getDataIfValid(this.props.formData,this.props.paymentSpec,this.prepareForSubmission(),this.props.payment_experiments)},t.prototype.componentDidMount=function(){var e=this.props.formData.countryCode.formattedValue;i.TeamsWebActionsLogger.log("uj-billing-country",{country:e}),"BR"===e&&i.TeamsWebActionsLogger.log("uj-cpf-viewed-field"),this.props.actions.updateHistory()},t.prototype.prepareForSubmission=function(){return this.props.formData.paymentMethod.formattedValue===d.PaymentMethod.CreditCard?this.creditCardFrame.tokenize():Promise.resolve(!0)},t.prototype.getCreditCardFrame=function(){return this.creditCardFrame},t.prototype.renderLocationFields=function(){var e,t,a=this.props,n=a.paymentSpec,i=a.formData,r=null,s=l.intl.formatMessage({id:"8vkOAo",defaultMessage:"Please note: changing your billing location could impact your applicable tax rate."});return n.should_show_vat_for_country(i.countryCode.formattedValue)&&(s=l.intl.formatMessage({id:"RCr4JC",defaultMessage:"Please note: changing your billing location or VAT number could impact your applicable tax rate."})),this.props.payment_experiments.showNptBillingModal&&(s=l.intl.formatMessage({id:"C8NyKM",defaultMessage:"You won't be charged until you confirm your purchase on the next screen."})),this.props.paymentSpec.isTeam()||(r=o.default.createElement("div",{className:(null===(e=this.props.payment_optional_settings)||void 0===e?void 0:e.isScheduledDowngradeToBasic)?"disclaimer-message-full-width":"disclaimer-message"},s,(null===(t=this.props.payment_optional_settings)||void 0===t?void 0:t.isScheduledDowngradeToBasic)&&o.default.createElement("span",null," ",l.intl.formatMessage({id:"GweSkC",defaultMessage:"Updating your billing information will cancel your scheduled plan downgrade. If you still wish to downgrade, you will need to schedule it again."})))),o.default.createElement("div",{className:"location-info-fields grid__item grid--x-bookend"},o.default.createElement(m.UnifiedAddressForms,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,countryList:this.props.countryList}),o.default.createElement(p.UnifiedVatField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),o.default.createElement(u.UnifiedCPFField,{paymentSpec:this.props.paymentSpec,formData:this.props.formData,actions:this.props.actions,payment_experiments:this.props.payment_experiments}),o.default.createElement(_.Text,{size:"small",color:"faint",variant:"paragraph"},r))},t.prototype.render=function(){var e=this,t=this.props,a=t.paymentSpec,i=t.actions,l=t.formData,u=this.renderLocationFields(),p=u;l.paymentMethod.formattedValue===d.PaymentMethod.DirectDeposit?p=o.default.createElement(s.DirectDebitForm,{locationFields:u,formData:l,actions:i}):l.paymentMethod.formattedValue===d.PaymentMethod.Ideal&&(p=o.default.createElement(f.IdealForm,{locationFields:u,formData:l,actions:i,idealBanks:a.idealBanks()}));var m=n.default({grid__item:!0,"payment-form":!0,"payment-form--responsive":!0});return o.default.createElement("div",{className:m},o.default.createElement(c.PaymentMethodSelector,{isTeam:!1,paymentSpec:a,paymentMethod:l.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:l.countryCode.rawValue,zipCode:l.zipCode.rawValue}),o.default.createElement(r.CreditCardFrame,{getHeightFromIframe:!0,iframeUrl:this.props.iframeUrl,isResponsive:!0,hidden:l.paymentMethod.formattedValue!==d.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){e.creditCardFrame=t},nonce:l.nonce,bin:l.bin,submitForm:this.props.submitForm}),p)},t})((o=a.__importDefault(o)).default.Component);t.UnifiedPaymentForm=h})),define("modules/clean/react/payments/unified_module/unified_data_export",["require","exports","tslib","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/business/state/business_state","modules/clean/react/payments/common/form_value_helpers"],(function(e,t,a,n,i,o){"use strict";function l(e,t,a){var i=["countryCode"];return t.allow_zip_code_for_country(e)&&i.push("zipCode"),t.should_show_vat_for_country(e)&&i.push("vat"),t.should_require_cpf(e,a)&&(i.push("cpf"),i.push("cpfName")),a===n.PaymentMethod.CreditCard?(i.push("nonce"),i.push("adyenEncryptedCard"),i.push("encryptedCardForNetworkToken"),i.push("bin"),i.push("browserInfo"),i.push("threeDsData")):a===n.PaymentMethod.DirectDeposit?i.push("accountHolderName","iban","mandateSigned"):a===n.PaymentMethod.Ideal?i.push("idealBankId","idealBankName"):a===n.PaymentMethod.ApplePay&&i.push("applePayToken"),i}function r(e,t){return t[e]}Object.defineProperty(t,"__esModule",{value:!0}),t.getPaymentFieldNamesToSubmit=t.getDataIfValid=void 0,n=a.__importStar(n),t.getDataIfValid=function(e,t,a,n){var s=l(e.countryCode.formattedValue,t,e.paymentMethod.formattedValue);return(function(e,t){for(var a=0,n=e;a<n.length;a++){var i=r(n[a],t);if(!o.FormValueHelper.isValid(i))return!1}return!0})(s,e)?a.then((function(){return(function(e,t){for(var a={},n=0,o=e;n<o.length;n++){var l=o[n];a[i.fieldsToServerProps[l]]=r(l,t).formattedValue}return a})(s,e)})):Promise.resolve(null)},t.getPaymentFieldNamesToSubmit=l})),define("modules/clean/react/payments/checkout/components/inputs/radio_input",["require","exports","tslib","react","react-dom"],(function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RadioInput=void 0,n=a.__importDefault(n),i=a.__importStar(i);var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(i.findDOMNode(this.input))},t.prototype.componentDidMount=function(){if(this.props.onChange){var e=i.findDOMNode(this.input),t=e.checked;t&&t!==this.props.checked&&this.props.onChange(e)}},t.prototype.render=function(){var e=this,t=this.props,a=t.name,i=t.id,o=t.className,l=t.checked,r=t.value,s=t.disabled;return n.default.createElement("input",{type:"radio",className:o,name:a,id:i,value:r,checked:l,onChange:this.onChange.bind(this),disabled:s,ref:function(t){e.input=t}})},t})(n.default.Component);t.RadioInput=o})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option",["require","exports","tslib","react","modules/core/i18n","classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/inputs/radio_input","modules/clean/react/payments/pro/components/inputs/inputs"],(function(e,t,a,n,i,o,l,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodOption=void 0,n=a.__importDefault(n),o=a.__importDefault(o);var d=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onSelected(this.props.paymentMethod)},t.prototype.render=function(){var e,t=this.props,a=t.icons,d=t.labelText,c=t.paymentMethod,u=[],p=["payment-method-option","payment-info__option"];if(this.props.isTeam?(p.push("grid__item"),p.push("grid__item--medium--shrink"),p.push("grid--y-middle"),p.push("grid__container--p-micro")):this.props.numberOfPaymentMethods&&this.props.numberOfPaymentMethods>2?p.push("grid__item--medium--1-4"):p.push("grid__item--medium--1-2"),d&&(e="payment-method-label#debit",u.push(n.default.createElement("span",{key:e,className:"debit"},this.props.labelText))),a){if(c===l.PaymentMethod.CreditCard){var m=a.join(", ").replace("_","-"),g=i.intl.formatMessage({id:"IBCGt3",defaultMessage:"Credit card. We accept {payment_methods}"},{payment_methods:m});e="payment-method-label#creditcard",u.push(n.default.createElement("span",{key:e,className:"ax-visually-hidden"},g))}else if(c===l.PaymentMethod.TokenConnect){g=i.intl.formatMessage({id:"7u/Z5D",defaultMessage:"Credit card"},{payment_methods:["mastercard"]});e="payment-method-label#tokenconnect",u.push(n.default.createElement("span",{key:e,className:"ax-visually-hidden"},g))}else c===l.PaymentMethod.PayPal&&(e="payment-method-label#paypal",u.push(n.default.createElement("span",{key:e,className:"ax-visually-hidden"},i.intl.formatMessage({id:"RxvBVG",defaultMessage:"Paypal"}))));for(var f=0,_=a;f<_.length;f++){var h=_[f];e="payment-method-icon#"+h,u.push(n.default.createElement("span",{key:e,className:h}))}}return this.props.isTeam?n.default.createElement("div",{className:o.default(p)},n.default.createElement(r.RadioInput,{name:"payment_method",id:"payment_method_"+c,value:c.toString(),checked:this.props.selected,onChange:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:"payment_method_"+c,className:"payment-method-label"},u)):n.default.createElement("div",{className:o.default(p)},n.default.createElement(s.LabeledRadioInput,{id:"payment_method_"+c,name:"payment_method",className:"payment-info__payment",value:c.toString(),checked:this.props.selected,onClick:this.onChange.bind(this)}),n.default.createElement("label",{htmlFor:"payment_method_"+c,className:"payment-info__method-label",onClick:this.onChange.bind(this)},u))},t})(n.default.Component);t.PaymentMethodOption=d})),define("modules/clean/react/payments/checkout/components/payment_method_form/payment_method_selector",["require","exports","tslib","react","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/checkout/components/payment_method_form/payment_method_option","modules/core/i18n"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PaymentMethodSelector=void 0;var r=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return a.__extends(t,e),t.prototype.getLabelForMethodId=function(e){return e===i.PaymentMethod.TokenConnect?n.default.createElement(o.PaymentMethodOption,{key:"payment-method#"+e,paymentMethod:i.PaymentMethod.TokenConnect,selected:this.props.paymentMethod===i.PaymentMethod.TokenConnect,onSelected:this.onPaymentMethodSelected,icons:this.props.paymentSpec.supported_credit_cards_for_country(""),isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===i.PaymentMethod.CreditCard?n.default.createElement(o.PaymentMethodOption,{key:"payment-method#"+e,paymentMethod:i.PaymentMethod.CreditCard,selected:this.props.paymentMethod===i.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected,icons:this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode),isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===i.PaymentMethod.PayPal?n.default.createElement(o.PaymentMethodOption,{key:"payment-method#"+e,paymentMethod:i.PaymentMethod.PayPal,selected:this.props.paymentMethod===i.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],isTeam:this.props.isTeam,numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===i.PaymentMethod.DirectDeposit?n.default.createElement(o.PaymentMethodOption,{key:"payment-method#"+e,isTeam:this.props.isTeam,labelText:l.intl.formatMessage({id:"H1vHwe",defaultMessage:"Direct Debit"}),numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,onSelected:this.onPaymentMethodSelected,paymentMethod:i.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===i.PaymentMethod.DirectDeposit}):e===i.PaymentMethod.Ideal?n.default.createElement(o.PaymentMethodOption,{key:"payment-method#"+e,isTeam:this.props.isTeam,paymentMethod:i.PaymentMethod.Ideal,selected:this.props.paymentMethod===i.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length,labelText:l.intl.formatMessage({id:"DgNBM/",defaultMessage:"iDEAL"})}):null},t.prototype.render=function(){var e=this,t=this.props,a=t.countryCode,i=t.paymentSpec.available_payment_methods_for_country(a).map((function(t){return e.getLabelForMethodId(t)}));return n.default.createElement("div",{className:"payment-method-selector payment-info__selector grid__item"},i)},t})((n=a.__importDefault(n)).default.Component);t.PaymentMethodSelector=r})),define("modules/clean/react/payments/update_team_billing/reducers",["require","exports","tslib","modules/clean/react/payments/common/form/reducers/reducers","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/pricing/reducers/reducers"],(function(e,t,a,n,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingReducer=void 0,t.BillingReducer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return function(a,n){return t(e(a,n),n)}}))}.apply(void 0,a.__spreadArrays([function(e,t){return"SubmitFormSuccess"!==t.type?e:a.__assign(a.__assign({},e),{pageState:a.__assign(a.__assign({},e.pageState),{submitSuccess:!0})})},n.FormReducer],i.PaymentMethodReducers,o.TransitionManagementReducers))})),define("modules/clean/react/payments/update_team_billing/update_team_actions",["require","exports","tslib","modules/core/i18n","modules/core/notify","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions"],(function(e,t,a,n,i,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateBillingCountryCode=t.submitTeamBillingForm=void 0,o=a.__importStar(o),t.submitTeamBillingForm=function(e,t,a){return function(n,i){var r,s=i(),d=s.formData.countryCode.formattedValue,c=s.pageState.paymentFormSpec,u=["countryCode"];c.allow_zip_code_for_country(d)&&u.push("zipCode"),c.should_show_vat_for_country(d)&&u.push("vat"),c.should_require_cpf(d,s.formData.paymentMethod.formattedValue)&&u.push("cpf"),s.formData.paymentMethod.formattedValue===o.PaymentMethod.CreditCard?(u.push("nonce"),u.push("adyenEncryptedCard"),u.push("encryptedCardForNetworkToken"),u.push("bin"),u.push("browserInfo"),u.push("threeDsData"),r="/team/payments/ajax_update_billing_credit_card"):s.formData.paymentMethod.formattedValue===o.PaymentMethod.DirectDeposit?(u.push("accountHolderName","iban","mandateSigned"),r="/team/payments/ajax_update_billing_direct_debit"):r="/team/payments/ajax_update_billing_paypal",n(l.submitForm(r,u,e,{payment_method:s.formData.paymentMethod.formattedValue,request_id:s.pageState.requestId,submit_seq:s.pageState.submitSeq},void 0,t,a))}},t.updateBillingCountryCode=function(e){return function(t,a){var o=a(),r=o.pageState.countryToCurrencyMap;!(e in r)&&o.formData.countryCode.formattedValue in r?i.Notify.error(n.intl.formatMessage({id:"K81Lqx",defaultMessage:"You can’t change to a country with a different currency. For help, contact support."}),3):t(l.updateCountryCode(e))}}})),define("modules/clean/react/payments/update_team_billing/update_team_store_creator",["require","exports","tslib","redux","redux-thunk","modules/clean/react/payments/common/middleware/payments_ux_logger","modules/clean/redux/unsupported","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/modal","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/core/i18n","modules/core/notify","modules/clean/react/payments/update_individual_billing/update_individual_store_creator"],(function(e,t,a,n,i,o,l,r,s,d,c,u,p,m,g,f){"use strict";function _(e){return function(e){return function(t){if("SubmitFormSuccess"!==t.type)return e(t);var a=e(t);return g.Notify.success(m.intl.formatMessage({id:"w5p44x",defaultMessage:"We’ve successfully updated your team’s billing information."})),r.TeamsWebActionsLogger.log("update_billing_open_save_changes_success"),d.Modal.close(),s.DBModalStack.trigger(f.BILLING_INFO_UPDATED,null),a}}}function h(e,t,a){var n=e.vat,i=e.countryCode,o=e.userInfo,l=u.createPaymentFormData(e,t,a),r=l.paymentMethod,s=l.countryCode,d=l.zipCode,c=l.vat,m=l.cpf,g=l.nonce,f=l.payPalNonce,_=l.adyenEncryptedCard,h=l.encryptedCardForNetworkToken,y=l.applePayToken,v=l.bin,b=l.browserInfo,P=l.threeDsData,S=l.accountHolderName,M=l.iban,C=l.mandateSigned,E=l.termsAndService,T=l.idealBankId,w=l.idealBankName;return{city:l.city,phone:l.phone,name:l.name,address:l.address,paymentMethod:r,countryCode:s,zipCode:d,vat:n?p.FormValueFactory.createVat(n,i):c,cpf:m,cpfName:p.FormValueFactory.createCpfNamePrefill("","",o.displayName),nonce:g,payPalNonce:f,bin:v,browserInfo:b,threeDsData:P,adyenEncryptedCard:_,encryptedCardForNetworkToken:h,applePayToken:y,accountHolderName:S,iban:M,mandateSigned:C,termsAndService:E,idealBankId:T,idealBankName:w}}Object.defineProperty(t,"__esModule",{value:!0}),t.createFormData=t.createBillingStore=t.submitFormSuccessMiddleware=void 0,n=a.__importStar(n),i=a.__importDefault(i),t.submitFormSuccessMiddleware=_,t.createBillingStore=function(e,t){var a=(function(e){var t=(function(e){var t=u.createPaymentPageState(e).paymentFormSpec;return{countryToCurrencyMap:e.countryToCurrencyMap,submitState:null,submitSuccess:!1,submitting:!1,submitSeq:0,paypalEmail:"",requestId:e.requestId,paymentFormSpec:t}})(e),a=(function(e){var t=u.createPaymentPricingState(e),a=t.countryCode,n=t.countryCodeLoading,i=t.hasCurrencyChanged,o=t.hasTaxChangedWithinCountry,l=t.loadingPrices,r=t.recentLoadEvent,s=t.requestToken;return{countryCode:a,countryCodeLoading:n,hasCurrencyChanged:i,hasTaxChangedWithinCountry:o,loadingPrices:l,recentLoadEvent:r,requestToken:s}})(e);return{pricingState:a,pageState:t,formData:h(e,t,a)}})(e),r=n.applyMiddleware(i.default,c.submitFormErrorMiddleware,_,new o.PaymentsUXLogger(e.requestId).reduxMiddleware);return l.createStore(t,a,r)},t.createFormData=h}));
//# sourceMappingURL=pkg-account_subscription_core.min.js-vfli8UqjD.map